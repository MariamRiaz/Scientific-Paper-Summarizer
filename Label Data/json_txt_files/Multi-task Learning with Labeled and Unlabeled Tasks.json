{"sections": [{"heading": "1. Introduction", "text": "In the multi-task learning setting (Caruana, 1997) a learner is given a collection of prediction tasks that all need to be solved. The hope is that the overall prediction quality can be improved by processing the tasks jointly and sharing information between them. Indeed, theoretical as well as experimental studies have shown that information transfer can reduce the amount of annotated examples per task needed to achieve good performance under various assumptions on how the learning tasks are related.\nAll existing multi-task learning approaches have in common, however, that they need at least some labeled training data for every task of interest. In this paper, we study a new and more challenging setting, in which for a subset of the tasks (typically the large majority) only unlabeled data\n1IST Austria. Correspondence to: Anastasia Pentina <apentina@ist.ac.at>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nis available. In practice, it is highly desirable to be able to handle this situation for problems with a very large number of tasks, such as sentiment analysis for market studies: for different products different attributes matter and, thus, each product should be have its own predictor and forms its own learning task. At the same time annotating data for each such task is prohibitive, especially when new products are constantly added to the market. Another example are prediction problems, for which the fixed cost of obtaining any labels for a task can be high, even when the variable cost per label are reasonable. This is a well-known issue when using crowd sourcing for data annotation: recruiting and training annotators first imposes a large overhead, and only afterwards many labels can be obtained within a short time and at a low cost.\nA distinctive feature of the setting we study is that it requires two types of information transfer: between the labeled tasks and from labeled to unlabeled ones. While the first type is common in multi-task learning, none of the existing multi-task methods is able to handle the second type. In contrast, information transfer from labeled to unlabeled tasks is commonly studied in domain adaptation research, where, however, transfer of the first type is typically not considered. Thus, the setting of multi-task learning with labeled and unlabeled tasks can be seen as a blend of traditional multi-task learning and domain adaptation.\nIn this work we focus on a transfer method that learns a predictor for every task of interest by minimizing a taskspecific convex combination of training errors on the labeled tasks (Ben-David et al., 2007; Mansour et al., 2009). We choose this method because it allows us to capture both types of information transfer \u2013 between the labeled tasks and from labeled to unlabeled ones \u2013 in a unified fashion. Clearly, the success of this approach depends on the choice of the weights in the convex combinations. Moreover, one can expect it also to depend on the subset of labeled tasks as well, because some subsets of tasks might be more informative and representative than the others. This suggests that it will be beneficial if the labeled subset is not arbitrary but if it can be chosen in a data-dependent way. We refer to this learning scenario, where initially every task is represented only by a set of unlabeled examples and the learner can choose for which tasks to request some labels, as active task selection.\nOur main result is a generalization bound that quantifies both of the aforementioned effects: it relates the total multitask error to quantities that depend on the subset of labeled tasks and on the task-specific weights used for information transfer. Using the computable quantities in the bound as an objective function and minimizing it numerically, we obtain a principled algorithm for selecting which tasks to have labeled (in the active task selection scenario) and for choosing task-specific weights and predictors for all tasks, labeled as well as unlabeled. We highlight the practical usefulness of the derived method by experiments on synthetic and real data.\nThe success of any information transfer approach, regardless whether it is applied in the multi-task or the domain adaptation scenario, depends on the relatedness between tasks of interest. Indeed, one cannot expect to benefit from information transfer between the labeled tasks or to be able to obtain solutions of reasonable quality for the unlabeled ones if the given tasks are completely unrelated. An advantage of the method we propose is that from the associated generalization bound we can read off explicitly under which conditions the algorithm can be expected to succeed. In particular, it suggests that the proposed method is likely to succeed if the given set of tasks satisfies the following assumption of task smoothness: if two tasks are similar in their marginal distributions, then their optimal prediction functions are also likely to be similar. A more formal definition will be given in Section 3. The task smoothness assumption resembles the classical smoothness assumption of semi-supervised learning (Chapelle et al., 2006). It can be expected to hold in many real-world settings with a large number of tasks, for example in the aforementioned case of sentiment analysis: if two products are described using similar words, these words would likely have similar connotation for both products. Note, also, that a similar assumption appears implicitly in (Blanchard et al., 2011)."}, {"heading": "1.1. Related Work", "text": "Most existing multi-task learning methods work in the fully supervised setting and aim at improving the overall prediction quality by sharing information between the tasks. For this they employ different types of transfer: instance-transfer methods re-use training samples from different tasks (Crammer & Mansour, 2012), parametertransfer methods assume that the predictors for all tasks are similar to each other in some norm and exploit this fact through specific regularizers (Evgeniou & Pontil, 2004), representation-transfer approaches assume that the predictors for all tasks share a common (low-dimensional) representation that can be learned from the data (Argyriou et al., 2007; 2008). Follow-up works extended and generalized these concepts, e.g. by learning the relatedness of tasks (Saha et al., 2011; Kang et al., 2011) or sharing only\nbetween subgroups of tasks (Xue et al., 2007; Kumar & Daume\u0301 III, 2012; Barzilai & Crammer, 2015). However, all of the above methods require at least some labeled data for each task.\nTo our knowledge, the only existing multi-task method that can be applied in the considered setting where for some tasks only unlabeled data is available is (Khosla et al., 2012). Motivated by the problem of dataset bias, this method relies on the assumption that different tasks are minor modifications (i.e. biased versions) of the same, true prediction problem. Similarly to (Evgeniou & Pontil, 2004), it uses specific regularizers and trains predictors for all tasks jointly as small perturbations of a common predictor, which corresponds to the hypothetical unbiased task and can potentially be applied to unseen problems. Thus, applied in the considered setting, this method provides one predictor for all unlabeled tasks and treats the labeled ones as slight variations of them.\nInformation transfer from labeled to unlabeled tasks is the question typically studied in domain adaptation research. In fact, if the set of labeled tasks is fixed, any domain adaptation technique might be used to obtain solutions for unlabeled tasks, in particular those based on source reweighting (Shimodaira, 2000), representation learning (Pan et al., 2011; Glorot et al., 2011), or semisupervised transfer (Xing et al., 2007). However, by design all domain adaptation methods aim at finding the best predictor on a single target task given a fixed set of source tasks. Therefore none of them can readily be applied in the active task selection setting, where the learner needs to select the labeled tasks that would lead to good performance across all tasks.\nA second related setting is zero-shot learning (Larochelle et al., 2008; Lampert et al., 2013; Palatucci et al., 2009), where contextual, usually semantic, information is used to solve a learning task for which no training data is available. The situation we are interested in is more specific than this, though, as we assume that unlabeled data of the tasks is available, not context in an arbitrary form. As we will show, this allows us to derive formal performance guarantees that zero-shot learning methods typically lack.\nThe active task selection scenario is directly related to the question of identifying a representative set of source tasks in domain adaptation, a question that has previously been raised in the context of sentiment analysis (Blitzer et al., 2007). It also shares some features with active learning, where the learner is given a set of unlabeled samples and can choose a subset to obtain labels for. A fundamental difference is, however, that in active learning the learner needs to find a single prediction function for all labeled and unlabeled data while in the multi-task setting each task, including unlabeled ones, potentially requires its own predictor.\nIn the multi-task or zero-shot setting, active learning has so far not found widespread use. Exemplary works in this direction are (Reichart et al., 2008; Saha et al., 2010; Gavves et al., 2015), which, however, use active learning on the level of training examples, not tasks. The idea of choosing tasks was used in active curriculum selection (Ruvolo & Eaton, 2013; Pentina et al., 2015), where the learner can influence the order in which tasks are processed. However these methods nevertheless require annotated examples for all tasks of interest."}, {"heading": "2. MTL with Labeled and Unlabeled Tasks", "text": "In the multi-task setting the learner observes a collection of prediction tasks and its goal is to learn all of them. Formally, we assume that there is a set of T tasks {\u3008D1, f1\u3009, . . . , \u3008DT , fT \u3009}, where each task t is defined by a marginal distributionDt over the input space X and a deterministic labeling function ft : X \u2192 Y . The goal of the learner is to find T predictors h1, . . . , hT in a hypothesis set H \u2282 {h : X \u2192 Y} that would minimize the average expected risk:\ner(h1, . . . , hT ) = 1\nT T\u2211 t=1 ert(ht), (1)\nwhere ert(ht) = E x\u223cDt `(ht(x), ft(x)).\nIn this work we concentrate on the case of binary classification tasks, Y = {\u22121, 1}, and 0/1-loss, `(y1, y2) = 0 if y1 = y2, and `(y1, y2) = 1 otherwise.\nIn the fully-supervised setting the learner is given a training set of annotated examples for every task of interest. In contrast, we consider the scenario where every task t is represented by a set St = {xt1, . . . , xtn} of n unlabeled examples sampled i.i.d. according to the marginal distribution Dt. For a subset of k tasks {i1, . . . , ik}, which are either predefined or, in the active scenario, can be selected based on the unlabeled data, the learner is given labels for a random subset Sij \u2282 Sij of m points.\nTo obtain a predictor for any task, labeled or unlabeled, we consider a method that minimizes a convex combination of training errors of the labeled tasks. This choice allows us to capture, in a unified fashion, both types of information transfer \u2013 between the labeled tasks and from labeled to unlabeled ones. Formally, for a set of tasks I = {i1, . . . , ik} \u2282 {1, . . . , T} we define:\n\u039bI = { \u03b1 \u2208 [0, 1]T :\nT\u2211 i=1 \u03b1i = 1; supp\u03b1 \u2286 I\n} (2)\nfor supp\u03b1 = {i \u2208 {1, . . . , T} : \u03b1i 6= 0}. Given a weight vector \u03b1 \u2208 \u039bI , the \u03b1-weighted empirical error of a hypoth-\nesis h \u2208 H is defined as follows: e\u0302r\u03b1(h) = \u2211 i\u2208I \u03b1ie\u0302ri(h), (3)\nwhere e\u0302ri(h) = 1\nm \u2211 (x,y)\u2208Si `(h(x), y). (4)\nIn order to obtain a solution for any task t the learner minimizes e\u0302r\u03b1t(h) for some \u03b1t \u2208 \u039bI , where I is the set of labeled tasks, potentially in combination with some regularization.\nThe success of this approach depends on the subset I of tasks that are labeled and on the weights \u03b11, . . . , \u03b1T . The following theorem quantifies both of these effects and will later be used to chose \u03b11, . . . , \u03b1T and potentially I in a principled way. Theorem 1. Let d be the VC dimension of the hypothesis set H, k be the number of labeled tasks, S1, . . . , ST be"}, {"heading": "T sets of size n each, where Si", "text": "i.i.d.\u223c Di, and S1, . . . , ST be their random subsets of size m each, for which labels would be provided if the corresponding task is selected as labeled. Then for any \u03b4 > 0 with probability at least 1 \u2212 \u03b4 over S1, . . . , ST and S1, . . . , ST uniformly for all choices of labeled tasks I = {i1, . . . , ik} and weights \u03b11, . . . , \u03b1T \u2208 \u039bI , provided that they are fully determined by the unlabeled data only, and for all possible choices of h1, . . . , hT \u2208 H the following inequality holds:\n1\nT T\u2211 t=1 ert(ht)\u2264 1 T T\u2211 t=1 e\u0302r\u03b1t(ht)+ 1 T T\u2211 t=1 \u2211 i\u2208I \u03b1ti disc(St, Si)\n+ A\nT \u2016\u03b1\u20162,1 +\nB T \u2016\u03b1\u20161,2 +C+D+ 1 T T\u2211 t=1 \u2211 i\u2208I \u03b1ti\u03bbti, (5)\nwhere\ndisc(St, Si) = max h,h\u2032\u2208H\n|e\u0302rSt(h, h\u2032)\u2212 e\u0302rSi(h, h\u2032)|\nwith e\u0302rSi(h, h \u2032) = 1n \u2211n j=1 `(h(x i j), h\n\u2032(xij)) is the empirical discrepancy between unlabeled samples St and Si, and\n\u03bbij = min h\u2208H (eri(h) + erj(h))\n\u2016\u03b1\u20162,1 = T\u2211 t=1 \u221a\u2211 i\u2208I (\u03b1ti) 2, \u2016\u03b1\u20161,2 = \u221a\u221a\u221a\u221a\u2211 i\u2208I ( T\u2211 t=1 \u03b1ti )2 ,\nA =\n\u221a 2d log(ekm/d)\nm , B =\n\u221a log(4/\u03b4)\n2m\nC =\n\u221a 8(log T + d log(enT/d))\nn +\n\u221a 2\nn log\n4 \u03b4 ,\nD = 2\n\u221a 2d log(2n) + 2 log(T ) + log(4/\u03b4)\nn .\nProof Sketch (the full proof can be found in the supplemental material). By Theorem 2 in (Ben-David et al., 2010), for any two tasks t and i the following inequality holds for every h \u2208 H:\nert(h) \u2264 eri(h) + disc(Dt, Di) + \u03bbti. (6)\nThus, we obtain the following bound on the average expected error over all tasks in terms of the error on the labeled tasks:\n1\nT T\u2211 t=1 ert(ht)\u2264 1 T T\u2211 t=1 er\u03b1t(ht) (7)\n+ 1\nT T\u2211 t=1 \u2211 i\u2208I \u03b1ti disc(Dt, Di) + 1 T T\u2211 t=1 \u2211 i\u2208I \u03b1ti\u03bbti,\nwith er\u03b1t(ht) = \u2211 i\u2208I \u03b1ti E x\u223cDi `(ht(x), fi(x)), and (8)\nerDi(h, h \u2032) = E x\u223cDi `(h(x), h\u2032(x)), and (9)\ndisc(Dt, Di)= max h,h\u2032\u2208H\n| erDt(h, h\u2032)\u2212erDi(h, h\u2032)| (10)\nis the discrepancy between two distributions (Kifer et al., 2004; Mansour et al., 2009; Ben-David et al., 2010). In order to prove the statement of the theorem we need to relate the \u03b1-weighted expected errors and discrepancies between the marginal distributions in (7) to their empirical estimates.\nThe proof consists of three steps. First, we show that, conditioned on the unlabeled data, 1T \u2211T t=1 e\u0303r\u03b1t can be upper\nbounded in terms of 1T \u2211T t=1 e\u0302r\u03b1t , where:\ne\u0303r\u03b1(h) = \u2211 i\u2208I \u03b1ie\u0303ri(h) = \u2211 i\u2208I \u03b1i n n\u2211 j=1 `(h(xij), fi(x i j)).\nThis quantity can be interpreted as a training error if the learner would receive the labels for all the samples for the chosen tasks I . Note that in case of m = n this step is not needed and we can avoid the corresponding complexity terms. In the second step we relate the average \u03b1-weighted expected errors to 1T \u2211T t=1 e\u0303r\u03b1t . In the third step we conclude the proof by bounding the pairwise discrepancies in terms of their empirical estimates.\nStep 1. Fix the unlabeled sets S1, . . . , ST . They fully determine the choice of labeled tasks I and the weights \u03b11, . . . , \u03b1T . Therefore, conditioned on the unlabeled data, these quantities can be considered constant and the bound has to hold uniformly only with respect to h1, . . . , hT .\nIn order to simplify the notation we assume that I = {1, . . . , k} and define:\n\u03a6(S1, . . . , Sk) = sup h1,...,hT\n1\nT T\u2211 t=1 e\u0303r\u03b1t(ht)\u2212 e\u0302r\u03b1t(ht).\n(11)\nNote that one could analyze this quantity using standard techniques from Rademacher analysis, if the labeled examples were sampled from the unlabeled sets i.i.d., i.e. with replacement. However, since we assume that for every i Si is a subset of Si, i.e. the labeled examples are sampled randomly without replacement, there are dependencies between the labeled examples. Therefore we utilize techniques from the literature on transductive learning (ElYaniv & Pechyony, 2007) instead. We first apply Doob\u2019s construction to \u03a6 in order to obtain a martingale sequence and then use McDiarmid\u2019s inequality for martingales (McDiarmid, 1989). As a result we obtain that with probability at least 1\u2212 \u03b4/4 over sampling labeled examples:\n\u03a6 \u2264 E S1,...,Sk\n\u03a6 + 1\nT \u221a\u221a\u221a\u221a k\u2211 i=1 ( T\u2211 t=1 \u03b1ti )2\u221a log(4/\u03b4) 2m . (12)\nNow we need to upper bound E\u03a6. Using results from (Tolstikhin et al., 2014) and (Hoeffding, 1963) we observe that:\nE S1,...,Sk \u03a6(S1, . . . , Sk) \u2264 E S\u03031,...,S\u0303k \u03a6(S\u03031, . . . , S\u0303k), (13)\nwhere S\u0303i is a set of m points sampled from Si i.i.d. with replacement (in contrast to sampling without replacement corresponding to Si). This means that we can upper bound the expectation of \u03a6 over samples with dependencies by the expectation over independent samples. By doing so, applying the symmetrization trick, and introducing Rademacher random variables, we obtain that:\nE S1,...,Sk \u03a6 \u2264 1 T T\u2211 t=1 \u221a\u221a\u221a\u221a k\u2211 i=1 (\u03b1ti) 2 \u00b7 \u221a 2d log(ekm/d) m . (14)\nA combination of (12) and (14) shows that (conditioned on the unlabeled data) with probability at least 1 \u2212 \u03b4/4 over sampling labeled examples uniformly for all choices of h1, . . . , hT the following holds:\n1\nT T\u2211 t=1 e\u0303r\u03b1t(ht) \u2264 1 T T\u2211 t=1 e\u0302r\u03b1t(ht)+1 A T \u2016\u03b1\u20162,1 + B T \u2016\u03b1\u20161,2.\n(15) Step 2. Now we relate 1T \u2211T t=1 e\u0303r\u03b1t to 1 T \u2211T t=1 er\u03b1t .\nThe choice of the tasks to label, I , the corresponding weights, \u03b1, and the predictors, h, all depend on the unlabeled data. Therefore, we aim for a bound that is uniform in all three parameters. We define:\n\u03a8(S1, . . . , ST ) =\nsup I sup \u03b11,...,\u03b1T\u2208\u039bI sup h1,...,hT\n1\nT T\u2211 t=1 T\u2211 i=1 \u03b1ti(eri(ht)\u2212 e\u0303ri(ht)).\nThe main instrument that we use here is a refined version of McDiarmid\u2019s inequality, which is due to (Maurer, 2006). It allows us to use the standard Rademacher analysis, while taking into account the internal structure of the weights \u03b11, . . . , \u03b1T . As a result we obtain that with probability at least 1 \u2212 \u03b4/4 simultaneously for all choices of tasks to be labeled, I , weights \u03b11, . . . , \u03b1T \u2208 \u039bI and hypotheses h1, . . . , hT :\n1\nT T\u2211 t=1 er\u03b1t(ht) \u2264 1 T T\u2211 t=1 e\u0303r\u03b1t(ht) + C. (16)\nStep 3. To conclude the proof we bound the pairwise discrepancies in terms of their finite sample estimates. According to Lemma 1 in (Ben-David et al., 2010) for any pair of tasks i, j and any \u03b4 > 0 with probability at least 1\u2212 \u03b4:\ndisc(Di, Dj) \u2264 disc(Si, Sj)+2 \u221a 2d log(2n) + log(2/\u03b4)\nn .\nWe apply this result to every pair of tasks and combine the results using the uniform bound argument. This yields the remaining two terms on the right hand side: the weighted average of the sample-based discrepancies and the constant D. By combining the result with (15) and (16) we obtain the statement of the theorem."}, {"heading": "3. Explanation and Interpretation", "text": "The left-hand side of inequality (5) is the average expected error over all T tasks, the quantity of interest that the learner would like to minimize but cannot directly compute. It is upper-bounded by the sum of two complexity terms and five task-dependent terms: weighted training errors on the labeled tasks, weighted averages of the distances to the labeled tasks in terms of the empirical discrepancies, two mixed norms of the weights \u03b1 and a weighted average of \u03bb-s. The complexity terms C and D behave as O( \u221a d log(nT )/n) and converge to zero when the number of unlabeled examples per task, n, tends to infinity. In contrast, AT \u2016\u03b1\u20162,1 + B T \u2016\u03b1\u20161,2 in the worst case of\n\u2016\u03b1\u20162,1 = \u2016\u03b1\u20161,2 = T behaves as O( \u221a d log(km)/m) and converges to zero when the number of labeled examples per labeled task, m, tends to infinity. In order for these terms to be balanced, i.e. for the uncertainty coming from the estimation of discrepancy to not dominate the uncertainty from the estimation of the \u03b1-weighted risks, the number of unlabeled examples per task n should be significantly (for k T ) larger than m. However, this is not a strong limitation under the common assumption that obtaining enough unlabeled examples is significantly cheaper than annotated ones.\nThe remaining terms on the right-hand side of (5) depend on the set of labeled tasks I , the tasks-specific weights \u03b1-s and hypotheses h-s. Thus, by minimizing them with respect to these quantities one can expect to obtain values for them that are beneficial for solving all tasks of interest based on the given data. For the theorem to hold, the set of labeled tasks and the weights may not depend on the labels. The part of the bound that can be estimated based on the unlabeled data only, and therefore to select I (in the active scenario) and \u03b11, . . . , \u03b1T is:\n1\nT T\u2211 t=1 \u2211 i\u2208I \u03b1ti disc(St, Si) + A T \u2016\u03b1\u20162,1 + B T \u2016\u03b1\u20161,2. (17)\nThe first term in (17) is the average weighted distance from every task to the labeled ones, as measured by the discrepancy between the corresponding unlabeled training samples. This term suggests that for every task t the largest weight, i.e. the highest impact in terms of information transfer, should be put on a labeled task i that has a similar marginal distribution. Note that the employed \u201dsimilarity\u201d, which is captured by the discrepancy, directly depends on the considered hypothesis class and loss function and, thus, is tailored to a particular setting of interest. At the same time, the mixed-norm terms \u2016\u03b1\u20161,2 and \u2016\u03b1\u20162,1 prevent the learner from putting all weight on the single closest labeled task and can be seen as some form of regularization. In particular, they encourage information transfer also between the labeled tasks, since minimizing just the first term in (17) for every labeled tasks i \u2208 I would result in all weight to be put on task i itself and nothing on other tasks, because by definition disc(Si, Si) = 0.\nThe first mixed-norm term, \u2016\u03b1\u20162,1 influences every \u03b1t independently and encourages the learner to use data from multiple labeled tasks for adaptation. Thus, it captures the intuition that sharing from multiple labeled tasks should improve the performance. In contrast, \u2016\u03b1\u20161,2 connects the weights for all tasks. This term suggests to label tasks that all would be equally useful, thus preventing spending resources on tasks that would be informative for only a few of the remaining ones. Also, it prevents the learner from having super-influential labeled tasks that share with too many others. Such cases would be very unstable in the worst case scenario: mistakes on such tasks would propagate and have a major effect on the overall performance.\nThe effect of the mixed-norm terms can also be seen through the lens of the convergence rates. Indeed, as already mentioned above, in the case of every \u03b1t having only one non-zero component, \u2016\u03b1\u20162,1 and \u2016\u03b1\u20161,2 are equal to T and thus the convergence rate1 is O\u0303( \u221a 1/m). However, in the opposite extreme, if every \u03b1t weights all the labeled tasks equally, i.e. \u03b1ti = 1/k for all t \u2208 {1, . . . , T} and\n1O\u0303(\u00b7) is an analog of O(\u00b7) that hides logarithmic factors\ni \u2208 I , then \u2016\u03b1\u20162,1 = \u2016\u03b1\u20161,2 = T\u221ak and the convergence rate improves to O\u0303( \u221a 1/km), which is the best one can expect from having a total of km labeled examples.\nThe only term on the right-hand side of (5) that depends on the hypotheses h1, . . . , hT and can be used to make a favorable choice is the weighted training error on the labeled tasks. Thus, the generalization bound of Theorem 1 suggest the following algorithm (Figure 1):\nAlgorithm 1. 1. estimate pairwise discrepancies between the tasks\nbased on the unlabeled data 2. choose the tasks I to be labeled (in the active case)\nand the weights \u03b11, . . . , \u03b1T by minimizing (17) 3. receive labels for the labeled tasks I 4. for every task t train a classifier by minimizing (3)\nusing the obtained weights \u03b1t.\nNote, that this procedure is justified by Theorem 1: all choices are done in agreement with the conditions of the theorem and, because the inequality (5) holds uniformly for all eligible choices of labeled tasks, weights and predictors, the guarantees also hold for the resulting solution.\nAlgorithm 1 is guaranteed to perform well, if the solution it finds leads to a low value of the right-hand side of (5). By construction, it minimizes all data-dependent terms in (5), except for one quantity that cannot be estimated from the available data:\n1\nT T\u2211 t=1 \u2211 i\u2208I \u03b1ti\u03bbti. (18)\nWhile discrepancy captures the similarity between marginal distributions, the \u03bb-terms reflect the similarity between labeling functions: for every pair of task, t, and labeled task, i \u2208 I , the corresponding value \u03bbti is small if there exists a hypothesis that performs well on both tasks. Thus, Algorithm 1 can be expected to perform well, if for any two given tasks t and i that are close to each other in terms of discrepancy (and thus in the minimization of (17) the corresponding \u03b1ti is large), there exists a hypothesis\nthat performs well on both of them (i.e. the corresponding \u03bbti is small). We refer to this property of the set of learning tasks as task smoothness.\nTraining predictors for every task of interest using data from all labeled tasks improves the statistical guarantees of the learner. However, it results in empirical risk minimization on up to km samples for T different weighted combinations. Since we are most interested in the situation when T is large, one might be interested in way to reduce the amount of necessary computation. One way to do so is to drop the mixed-norm terms from the objective function (17), in which case it reduces to\n1\nT T\u2211 t=1 \u2211 i\u2208I \u03b1ti disc(St, Si). (19)\nThis expression is linear in \u03b1 and thus minimizing it for a fixed set I will lead to assigning each task to a single labeled task that is closest to it in terms of empirical discrepancy. Each labeled task will be assigned to itself. Consequently, the learner must train only k predictors, one for each labeled task, using only its m samples. The expression (19) can be seen as the k-medoids clustering objective with tasks corresponding to points in the space with (semi)metric defined by empirical discrepancy and labeled tasks correspond to the centers of the clusters. Thus, this method reduces to k-medoids clustering, resembling the suggestion of Blitzer et al. (2007). Note that, nevertheless, the conditions of Theorem 1 are fulfilled, and thus its guarantees will hold for the obtained solution. The guarantees will be more pessimistic, however, than those from Algorithm 1, as the minimization ignores parts of the bound (5) and will not use the potentially beneficial transfer between labeled tasks."}, {"heading": "4. Experiments", "text": "To illustrate that the proposed algorithm can also be practically useful, we performed experiments on synthetic and real data. In both cases we choose H to be the set of all linear predictors with a bias term on X = Rd.\nSynthetic data. We generate T = 1000 binary classifica-\ntion tasks in R2. For each task t its marginal distribution Dt is a unit-variance Gaussian with mean \u00b5t chosen uniformly at random from the set [\u22125, 5]\u00d7 [\u22125, 5]. The label +1 is assigned to all points that have angle between 0 and \u03c0 with \u00b5t (computed counter-clockwise), the other points are labeled \u22121. We use n = 1000 unlabeled and m = 100 labeled examples per task.\nReal Data. We curate a Multitask dataset of product reviews2 from the corpus of Amazon product data3 (McAuley et al., 2015a;b). We select the products for which there are at least 300 positive reviews (with scores 4 or 5) and at least 300 negative reviews (with scores 1 or 2). Each of the resulting 957 products we treat as a binary classification task of predicting whether a review is positive or negative. For every review we extract features by first pre-processing (removing all non-alphabetical characters, transforming the rest into lower case and removing stop words) and then applying the sentence embedding procedure of (Arora et al., 2017) using 25-dimensional GloVe word embedding (Pennington et al., 2014). We use n = 500 unlabeled samples per task and label a subset of m = 400 examples for each of the selected tasks. The remaining data is used for testing.\nMethods. We evaluate the proposed method in the case when the set of labeled tasks is predefined (referred to as DA) by setting the set I to be a random subset of tasks and minimizing (17) only with respect to \u03b1-s and in the active task selection scenario where (17) is minimized\n2 http://cvml.ist.ac.at/productreviews/ 3 http://jmcauley.ucsd.edu/data/amazon/\nwith respect to both I and \u03b1-s (referred to as Active DA). We compare these methods to a multi-task method based on (Khosla et al., 2012), also with random labeled tasks (the same ones as for DA). Specifically, we solve:\nmin w,v,b\nC ( \u2016w\u20162+ 1\nk \u2211 t\u2208I \u2016vt\u20162 ) + 1\u2212\u03b3 km \u2211 t\u2208I,(x,y)\u2208St (wTx+b\u2212y)2\n+ \u03b3\nkm \u2211 t\u2208I \u2211 (x,y)\u2208St ((wT + vTt )x+ (b+ bt)\u2212 y)2 (20)\nfor \u03b3 \u2208 {0, 0.1, . . . , 1} and use (w, b) for making predictions on all unlabeled tasks and (w + vt, b + bt) for each labeled task t \u2208 I . For every number of labeled tasks we report the result for \u03b3 that has the best test performance averaged over 10 repeats (denoted by Multi-task), as an upper performance bound on what could be achieved by model selection.\nWe also evaluate the discussed simplification of the proposed methods that consists of minimizing (19). We refer to these as DA-SS (for random predefined labeled tasks) and as Active DA-SS (in the active task selection scenario). The SS stands for single source, as in this setting, each task is solved based on information from only one labeled tasks.\nTo provide further context for the results we also report the results of learning independent ridge regressions with access to labels for all tasks (denoted by Fully Labeled). However, this baseline has access to many more annotated examples in total than all other methods. In order to quantify this effect we also consider the setting when the learner\nhas access to labels for all tasks, but fewer of them: namely, when the number of labeled tasks is k, the number of labels per task is mk/T , i.e. the total amount of labeled examples is mk, the same as for all other methods. In this case we evaluate two methods. The first one learns ridge regressions for every task independently and thus can be seen as a reference point for the methods that do not involve information transfer between the labeled tasks, i.e. DA-SS and Active DA-SS. The second reference method is based on (Evgeniou & Pontil, 2004) and consists of minimizing (20) with \u03b3 set to 1 and processing all tasks as labeled. This approach transfers information between all the tasks and therefore we refer to it when evaluating the methods that involve information transfer between the labeled tasks, i.e. DA, Active DA and Multi-task.\nImplementation. We estimate the empirical discrepancies between pairs of tasks by finding a hypothesis in H that minimizes the squared loss for the binary classification problem of separating the two sets of instances, as in (BenDavid et al., 2010). To minimize (17) for a given set of labeled tasks we use gradient descent. It is also used as a subroutine when minimizing (17) with respect to both I and \u03b1-s, for which we employ the GraSP algorithm (Bahmani et al., 2013). Active DA-SS involves the minimization of the k-medoid risk (19), which we perform using a local search as in (Park & Jun, 2009). For both methods for the active task selection scenario we used the heuristic from k-means++ (Arthur & Vassilvitskii, 2007) for initialization. To obtain classifiers for the individual tasks in all scenarios we use least-squares ridge regression. Regularization constants for all methods we selected from the set {0}\u222a{10\u221217, 10\u221216 . . . 108} by 5\u00d75-fold cross validation.\nResults. The results are shown in Figure 4. First, one can see that the proposed domain adaptation-inspired method DA outperforms the multi-task method (20). This could be due to higher flexibility of DA compared to Multi-task as the latter provides only one predictor for all unlabeled tasks. Indeed, the difference is most apparent in the experiment with synthetic data, where by design there is no single predictor that could perform well on a large fraction of tasks. Results on the product reviews indicate that DA\u2019s flexibility of learning a specific predictor for every task can be advantageous in more realistic scenarios as well.\nSecond, on both datasets both methods for active task selection, i.e. Active DA and Active DA-SS, outperform the corresponding passive methods, i.e. DA and DA-SS, systematically across various fractions of the labeled tasks. In particular, both active task selection methods require substantially fewer tasks labeled to achieve the same accuracy as their analogs with randomly chosen tasks. This confirms the intuition that selecting which tasks to label in a datadependent way is beneficial and demonstrates that Theo-\nrem 1 is capable of capturing this effect.\nAnother interesting observation that can be made from the results in Figure 4 is that both active and passive domain adaptation-inspired methods clearly outperform the corresponding partially labeled baselines, especially for small fractions of labeled tasks. This indicates that having more labels for fewer tasks rather than only few labels for all tasks could be beneficial not only in terms of annotation costs, but also in terms of prediction accuracy.\nAs the number of labeled tasks gets larger, e.g. half of all tasks, the performance of the active task selection learner becomes almost identical to the performance of the Fully Labeled method, even improving over it in the case of multi-source transfer on synthetic data. This confirms the intuition that in the case of many related tasks even a fraction of the tasks can contain enough information for solving all tasks."}, {"heading": "5. Conclusion", "text": "In this work we introduced and studied a variant of multitask learning in which annotated data is available only for some of the tasks. This setting combines aspects of traditional multi-task learning, namely the transfer of information between labeled tasks, with aspects typical for domain adaptation problems, namely transferring information from labeled tasks to solve tasks for which only unlabeled data is available. The success of the learner in this setting depends on the effectiveness of information transfer and informativeness of the set of labeled tasks. We analyzed two scenarios: a passive one, in which the set of labeled tasks is predefined, and the active task selection scenario, in which the learner decides for which tasks to query labels.\nOur main technical contribution is a generalization bound that quantifies the informativeness of the set of labeled tasks and the effectiveness of information transfer. We demonstrated how the bound can be used to make the choice of labeled tasks (in the active scenario) and to transfer information between the tasks in a principled way. We also showed how the terms in the bound have intuitive interpretations and provide guidance under which assumption of tasks relatedness the induced algorithm is expected to work well. Our empirical evaluation demonstrated that the proposed methods work also well in practice.\nFor future work we plan to further exploit the idea of active learning in the multi-task setting. In particular, we are interested in identifying whether by allowing the learner to make its decision on which tasks to label in an iterative way, rather than forcing it to choose all the tasks at the same time, one could obtain better learning guarantees as well as more effective learning methods."}, {"heading": "Acknowledgments", "text": "We thank Alexander Zimin and Marius Kloft for useful discussions. This work was in parts funded by the European Research Council under the European Union\u2019s Seventh Framework Programme (FP7/2007-2013)/ERC grant agreement no 308036."}], "year": 2017, "references": [{"title": "Multi-task feature learning", "authors": ["Argyriou", "Andreas", "Evgeniou", "Theodoros", "Pontil", "Massimiliano"], "venue": "In Conference on Neural Information Processing Systems (NIPS),", "year": 2007}, {"title": "Convex multi-task feature learning", "authors": ["Argyriou", "Andreas", "Evgeniou", "Theodoros", "Pontil", "Massimiliano"], "venue": "Machine Learning,", "year": 2008}, {"title": "A simple but tough-to-beat baseline for sentence embeddings", "authors": ["Arora", "Sanjeev", "Liang", "Yingyu", "Ma", "Tengyu"], "venue": "In International Conference on Learning Representations (ICLR),", "year": 2017}, {"title": "k-means++: the advantages of careful seeding", "authors": ["Arthur", "David", "Vassilvitskii", "Sergei"], "venue": "In Symposium on Discrete Algorithms (SODA),", "year": 2007}, {"title": "Greedy sparsity-constrained optimization", "authors": ["Bahmani", "Sohail", "Raj", "Bhiksha", "Boufounos", "Petros T"], "venue": "Journal of Machine Learning Research (JMLR),", "year": 2013}, {"title": "Convex multi-task learning by clustering", "authors": ["Barzilai", "Aviad", "Crammer", "Koby"], "venue": "In Conference on Uncertainty in Artificial Intelligence (AISTATS),", "year": 2015}, {"title": "Analysis of representations for domain adaptation", "authors": ["Ben-David", "Shai", "Blitzer", "John", "Crammer", "Koby", "Pereira", "Fernando"], "venue": "In Conference on Neural Information Processing Systems (NIPS),", "year": 2007}, {"title": "A theory of learning from different domains", "authors": ["Ben-David", "Shai", "Blitzer", "John", "Crammer", "Koby", "Kulesza", "Alex", "Pereira", "Fernando", "Vaughan", "Jennifer Wortman"], "venue": "Machine Learning,", "year": 2010}, {"title": "Generalizing from several related classification tasks to a new unlabeled sample", "authors": ["Blanchard", "Gilles", "Lee", "Gyemin", "Scott", "Clayton"], "venue": "In Conference on Neural Information Processing Systems (NIPS),", "year": 2011}, {"title": "Biographies, Bollywood, boomboxes and blenders: Domain adaptation for sentiment classification", "authors": ["Blitzer", "John", "Dredze", "Mark", "Pereira", "Fernando"], "venue": "In Annual Meeting of the Association for Computational Linguistics (ACL),", "year": 2007}, {"title": "Multitask learning", "authors": ["Caruana", "Rich"], "venue": "Machine Learning,", "year": 1997}, {"title": "Semi-supervised learning", "authors": ["Chapelle", "Olivier", "Sch\u00f6lkopf", "Bernhard", "Zien", "Alexander"], "year": 2006}, {"title": "Learning multiple tasks using shared hypotheses", "authors": ["Crammer", "Koby", "Mansour", "Yishay"], "venue": "In Conference on Neural Information Processing Systems (NIPS),", "year": 2012}, {"title": "Transductive Rademacher complexity and its applications", "authors": ["El-Yaniv", "Ran", "Pechyony", "Dmitry"], "venue": "In Workshop on Computational Learning Theory (COLT),", "year": 2007}, {"title": "Regularized multi-task learning", "authors": ["Evgeniou", "Theodoros", "Pontil", "Massimiliano"], "venue": "In Conference on Knowledge Discovery and Data Mining (KDD),", "year": 2004}, {"title": "Active transfer learning with zero-shot priors: Reusing past datasets for future tasks", "authors": ["Gavves", "Efstratios", "Mensink", "Thomas", "Tommasi", "Tatiana", "Snoek", "Cees", "Tuytelaars", "Tinne"], "venue": "In International Conference on Computer Vision (ICCV),", "year": 2015}, {"title": "Domain adaptation for large-scale sentiment classification: A deep learning approach", "authors": ["Glorot", "Xavier", "Bordes", "Antoine", "Bengio", "Yoshua"], "venue": "In International Conference on Machine Learing (ICML),", "year": 2011}, {"title": "Probability inequalities for sums of bounded random variables", "authors": ["Hoeffding", "Wassily"], "venue": "Journal of the American Statistical Association,", "year": 1963}, {"title": "Learning with whom to share in multi-task feature learning", "authors": ["Kang", "Zhuoliang", "Grauman", "Kristen", "Sha", "Fei"], "venue": "In International Conference on Machine Learing (ICML),", "year": 2011}, {"title": "Undoing the damage of dataset bias", "authors": ["Khosla", "Aditya", "Zhou", "Tinghui", "Malisiewicz", "Tomasz", "Efros", "Alexei", "Torralba", "Antonio"], "venue": "In European Conference on Computer Vision (ECCV),", "year": 2012}, {"title": "Detecting change in data streams", "authors": ["Kifer", "Daniel", "Ben-David", "Shai", "Gehrke", "Johannes"], "venue": "In VLDB,", "year": 2004}, {"title": "Learning task grouping and overlap in multi-task learning", "authors": ["Kumar", "Abhishek", "Daum\u00e9 III", "Hal"], "venue": "In International Conference on Machine Learing (ICML),", "year": 2012}, {"title": "Attribute-based classification for zero-shot visual object categorization", "authors": ["Lampert", "Christoph H", "Nickisch", "Hannes", "Harmeling", "Stefan"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence (T-PAMI),", "year": 2013}, {"title": "Zero-data learning of new tasks", "authors": ["Larochelle", "Hugo", "Erhan", "Dumitru", "Bengio", "Yoshua"], "venue": "In Conference on Artificial Intelligence (AAAI),", "year": 2008}, {"title": "Domain adaptation: Learning bounds and algorithms", "authors": ["Mansour", "Yishay", "Mohri", "Mehryar", "Rostamizadeh", "Afshin"], "venue": "In Workshop on Computational Learning Theory (COLT),", "year": 2009}, {"title": "Concentration inequalities for functions of independent variables", "authors": ["Maurer", "Andreas"], "venue": "Random Structures and Algorithms,", "year": 2006}, {"title": "Inferring networks of substitutable and complementary products", "authors": ["J.J. McAuley", "R. Pandey", "J. Leskovec"], "venue": "In Conference on Knowledge Discovery and Data Mining (KDD),", "year": 2015}, {"title": "Image-based recommendations on styles and substitutes", "authors": ["J.J. McAuley", "C. Targett", "Q. Shi", "A. van den Hengel"], "venue": "In International Conference on Research and Development in Information Retrieval (SIGIR),", "year": 2015}, {"title": "On the method of bounded differences", "authors": ["McDiarmid", "Colin"], "venue": "In Surveys in Combinatorics,", "year": 1989}, {"title": "Zero-shot learning with semantic output codes", "authors": ["Palatucci", "Mark", "Pomerleau", "Dean", "Hinton", "Geoffrey E", "Mitchell", "Tom M"], "venue": "In Conference on Neural Information Processing Systems (NIPS),", "year": 2009}, {"title": "Domain adaptation via transfer component analysis", "authors": ["Pan", "Sinno Jialin", "Tsang", "Ivor W", "Kwok", "James T", "Yang", "Qiang"], "venue": "IEEE Transactions on Neural Networks (T-NN),", "year": 2011}, {"title": "A simple and fast algorithm for k-medoids clustering", "authors": ["Park", "Hae-Sang", "Jun", "Chi-Hyuck"], "venue": "Expert Systems with Applications,", "year": 2009}, {"title": "Glove: Global vectors for word representation", "authors": ["Pennington", "Jeffrey", "Socher", "Richard", "Manning", "Christopher D"], "venue": "In Conference on Empirical Methods on Natural Language Processing (EMNLP),", "year": 2014}, {"title": "Curriculum learning of multiple tasks", "authors": ["Pentina", "Anastasia", "Sharmanska", "Viktoriia", "Lampert", "Christoph H"], "venue": "In Conference on Computer Vision and Pattern Recognition (CVPR),", "year": 2015}, {"title": "Multi-task active learning for linguistic annotations", "authors": ["Reichart", "Roi", "Tomanek", "Katrin", "Hahn", "Udo", "Rappoport", "Ari"], "venue": "In Annual Meeting of the Association for Computational Linguistics (ACL),", "year": 2008}, {"title": "Active task selection for lifelong machine learning", "authors": ["Ruvolo", "Paul", "Eaton", "Eric"], "venue": "In Conference on Artificial Intelligence (AAAI),", "year": 2013}, {"title": "Active online multitask learning", "authors": ["Saha", "Avishek", "Rai", "Piyush", "Daum\u00e9 III", "Hal", "Venkatasubramanian", "Suresh"], "venue": "In ICML Workshop on Budget Learning,", "year": 2010}, {"title": "Online learning of multiple tasks and their relationships", "authors": ["Saha", "Avishek", "Rai", "Piyush", "Daum\u00e9 III", "Hal", "Venkatasubramanian", "Suresh"], "venue": "In Conference on Uncertainty in Artificial Intelligence (AISTATS),", "year": 2011}, {"title": "Improving predictive inference under covariate shift by weighting the log-likelihood function", "authors": ["Shimodaira", "Hidetoshi"], "venue": "Journal of Statistical Planning and Inference,", "year": 2000}, {"title": "Localized complexities for transductive learning", "authors": ["I. Tolstikhin", "G. Blanchard", "M. Kloft"], "venue": "In Workshop on Computational Learning Theory (COLT),", "year": 2014}, {"title": "Bridged refinement for transfer learning", "authors": ["Xing", "Dikan", "Dai", "Wenyuan", "Xue", "Gui-Rong", "Yu", "Yong"], "venue": "In European Conference on Principles and Practice of Knowledge Discovery in Databases (PKDD),", "year": 2007}, {"title": "Multi-task learning for classification with Dirichlet process priors", "authors": ["Xue", "Ya", "Liao", "Xuejun", "Carin", "Lawrence", "Krishnapuram", "Balaji"], "venue": "Journal of Machine Learning Research (JMLR),", "year": 2007}], "id": "SP:6e1b2e05fe043046ccda1d5065e113f035c3c98b", "authors": [{"name": "Anastasia Pentina", "affiliations": []}, {"name": "Christoph H. Lampert", "affiliations": []}], "abstractText": "In multi-task learning, a learner is given a collection of prediction tasks and needs to solve all of them. In contrast to previous work, which required that annotated training data is available for all tasks, we consider a new setting, in which for some tasks, potentially most of them, only unlabeled training data is provided. Consequently, to solve all tasks, information must be transferred between tasks with labels and tasks without labels. Focusing on an instance-based transfer method we analyze two variants of this setting: when the set of labeled tasks is fixed, and when it can be actively selected by the learner. We state and prove a generalization bound that covers both scenarios and derive from it an algorithm for making the choice of labeled tasks (in the active case) and for transferring information between the tasks in a principled way. We also illustrate the effectiveness of the algorithm by experiments on synthetic and real data.", "title": "Multi-task Learning with Labeled and Unlabeled Tasks"}