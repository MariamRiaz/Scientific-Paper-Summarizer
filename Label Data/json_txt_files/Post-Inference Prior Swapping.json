{"sections": [{"heading": "1. Introduction", "text": "There are many cases in Bayesian modeling where a certain choice of prior distribution allows for computationally simple or tractable inference. For example,\n\u2022 Conjugate priors yield posteriors with a known parametric form and therefore allow for non-iterative, exact inference (Diaconis et al., 1979).\n\u2022 Certain priors yield models with tractable conditional or marginal distributions, which allows efficient approximate inference algorithms to be applied (e.g. Gibbs sampling (Smith & Roberts, 1993), sampling\n1Carnegie Mellon University, Machine Learning Department, Pittsburgh, USA 2CMU School of Computer Science. Correspondence to: Willie Neiswanger <willie@cs.cmu.edu>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nin collapsed models (Teh et al., 2006), or mean-field variational methods (Wang & Blei, 2013)).\n\u2022 Simple parametric priors allow for computationally cheap density queries, maximization, and sampling, which can reduce costs in iterative inference algorithms (e.g. Metropolis-Hastings (Metropolis et al., 1953), gradient-based MCMC (Neal, 2011), or sequential Monte Carlo (Doucet et al., 2000)).\nFor these reasons, one might hope to infer a result under a convenient-but-unrealistic prior, and afterwards, attempt to correct the result. More generally, given an inference result (under a convenient prior or otherwise), one might wish to incorporate updated prior information, or see a result under different prior assumptions, without having to re-run a costly inference algorithm.\nThis leads to the main question of this paper: for a given model, is it possible to use any convenient false prior to infer a false posterior, and afterwards, given any target prior of interest, efficiently and accurately infer the associated target posterior?\nOne potential strategy involves sampling from the false posterior and reweighting these samples via importance sampling (IS). However, depending on the chosen target prior\u2014both its parametric form and similarity to the false prior\u2014the resulting inference can be inaccurate due to high or infinite variance IS estimates (demonstrated in Sec. 2.1).\nWe instead aim to devise a method that yields accurate inferences for arbitrary target priors. Furthermore, like IS, we want to make use of the pre-inferred false posterior, without simply running standard inference algorithms on the target posterior. Note that most standard inference algorithms are iterative and data-dependent: parameter updates at each iteration involve data, and the computational cost or quality of each update depends on the amount of data used. Hence, running inference algorithms directly on the target posterior can be costly (especially given a large amount of data or many target priors of interest) and defeats the purpose of using a convenient false prior.\nIn this paper, we propose prior swapping, an iterative, dataindependent method for generating accurate posterior samples under arbitrary target priors. Prior swapping uses the pre-inferred false posterior to perform efficient updates that\ndo not depend on the data, and thus proceeds very quickly. We therefore advocate breaking difficult inference problems into two easier steps: first, do inference using the most computationally convenient prior for a given model, and then, for all future priors of interest, use prior swapping.\nIn the following sections, we demonstrate the pitfalls of using IS, describe the proposed prior swapping methods for different types of false posterior inference results (e.g. exact or approximate density functions, or samples) and give theoretical guarantees for these methods. Finally, we show empirical results on heavy-tailed and sparsity priors in Bayesian generalized linear models, and relational priors over components in mixture and topic models."}, {"heading": "2. Methodology", "text": "Suppose we have a dataset of n vectors xn = {x1, . . . , xn}, xi \u2208 Rp, and we have chosen a family of models with the likelihood function L(\u03b8|xn) = p(xn|\u03b8), parameterized by \u03b8 \u2208 Rd. Suppose we have a prior distribution over the space of model parameters \u03b8, with probability density function (PDF) \u03c0(\u03b8). The likelihood and prior define a joint model with PDF p(\u03b8, xn) = \u03c0(\u03b8)L(\u03b8|xn). In Bayesian inference, we are interested in computing the posterior (conditional) distribution of this joint model, with PDF\np(\u03b8|xn) = \u03c0(\u03b8)L(\u03b8|x n)\u222b\n\u03c0(\u03b8)L(\u03b8|xn) d\u03b8 . (1)\nSuppose we\u2019ve chosen a different prior distribution \u03c0f (\u03b8), which we refer to as a false prior (while we refer to \u03c0(\u03b8) as the target prior). We can now define a new posterior\npf (\u03b8|xn) = \u03c0f (\u03b8)L(\u03b8|xn)\u222b \u03c0f (\u03b8)L(\u03b8)|xn) d\u03b8\n(2)\nwhich we refer to as a false posterior.\nWe are interested in the following task: given a false posterior inference result (i.e. samples from pf (\u03b8|xn), or some exact or approximate PDF), choose an arbitrary target prior \u03c0(\u03b8) and efficiently sample from the associated target posterior p(\u03b8|xn)\u2014or, more generally, compute an expectation \u00b5h = Ep [h(\u03b8)] for some test function h(\u03b8) with respect to the target posterior."}, {"heading": "2.1. Importance Sampling and Prior Sensitivity", "text": "We begin by describing an initial strategy, and existing work in a related task known as prior sensitivity analysis.\nSuppose we have T false posterior samples {\u03b8\u0303t}Tt=1 \u223c pf (\u03b8|xn). In importance sampling (IS), samples from an importance distribution are used to estimate the expectation of a test function with respect to a target distribution. A straightforward idea is to use the false posterior as an\nimportance distribution, and compute the IS estimate\n\u00b5\u0302ISh = T\u2211 t=1 w(\u03b8\u0303t)h(\u03b8\u0303t) (3)\nwhere the weight function w(\u03b8) \u221d p(\u03b8|x n) pf (\u03b8|xn) \u221d \u03c0(\u03b8) \u03c0f (\u03b8)\n, and the T weights are normalized to sum to one.\nIS-based methods have been developed for the task of prior sensitivity analysis (PSA). In PSA, the goal is to determine how the posterior varies over a sequence of priors (e.g. over a parameterized family of priors \u03c0(\u03b8; \u03b3i), i = 0, 1, . . .). Existing work has proposed inferring a single posterior under prior \u03c0(\u03b8; \u03b30), and then using IS methods to infer further posteriors in the sequence (Besag et al., 1995; Hastings, 1970; Bornn et al., 2010).\nThis strategy is effective when subsequent priors are similar enough, but breaks down when two priors are sufficiently dissimilar, or are from ill-matched parametric families, which we illustrate in an example below.\nNote that, in general for IS, as T \u2192 \u221e, \u00b5\u0302ISh \u2192 \u00b5h almost surely. However, IS estimates can still fail in practice if \u00b5\u0302ISh has high or infinite variance. If so, the variance of the weights w(\u03b8\u0303t) will be large (a problem often referred to as weight degeneracy), which can lead to inaccurate estimates. In our case, the variance of \u00b5\u0302ISh is only finite if\nEpf [ h(\u03b8)2 \u03c0(\u03b8)2\n\u03c0f (\u03b8)2\n] \u221d Ep [ h(\u03b8)2 \u03c0(\u03b8)\n\u03c0f (\u03b8)\n] <\u221e. (4)\nFor a broad class of h, this is satisfied if there existsM \u2208 R such that \u03c0(\u03b8)\u03c0f (\u03b8) < M, \u2200\u03b8 (Geweke, 1989). Given some preinferred pf (\u03b8|xn) with false prior \u03c0f (\u03b8), the accuracy of IS thus depends on the target prior of interest. For example, if \u03c0(\u03b8) has heavier tails than \u03c0f (\u03b8), the variance of \u00b5\u0302ISh will be infinite for many h. Intuitively, we expect the variance to be higher for \u03c0 that are more dissimilar to \u03c0f .\nWe show a concrete example of this in Fig. 1. Consider a normal model for data xn \u223c N (\u03b8, 1), with a standard normal false prior \u03c0f (\u03b8) = N (\u03b8|0, 1). This yields a closedform false posterior (due to the conjugate \u03c0f ), which is also normal. Suppose we\u2019d like to estimate the posterior expectation under a Laplace target prior, with mean 10 and variance 1, for test function h(\u03b8) = \u03b8 (i.e. an estimate of the target posterior mean). We draw T false posterior samples {\u03b8\u0303t}Tt=1 \u223c pf (\u03b8|xn), compute weights w(\u03b8\u0303t) and IS estimate \u00b5\u0302ISh , and compare it with the true expectation \u00b5h.\nWe see in Fig. 1 that |\u00b5h \u2212 \u00b5\u0302ISh | slows significantly as T increases, and maintains a high error even as T is made very large. We can analyze this issue theoretically. Suppose we want |\u00b5h \u2212 \u00b5\u0302ISh | < \u03b4. Since we know pf (\u03b8|xn) is normal, we can compute a lower bound on the number of false posterior samples T that would be needed for\nthe expected estimate to be within \u03b4 of \u00b5h. Namely, if pf (\u03b8|xn) = N (\u03b8|m, s2), in order for |\u00b5h \u2212 Epf [\u00b5\u0302ISh ]| < \u03b4, we\u2019d need\nT \u2265 exp { 1\n2s2 (|\u00b5h \u2212m| \u2212 \u03b4)2\n} .\nIn the example in Fig. 1, we have m = 1, s2 = 0.25, and \u00b5h = 7.9892. Hence, for |\u00b5h \u2212 Epf [\u00b5\u0302ISh ]| < 1, we\u2019d need T > 1031 samples (see appendix for full details of this analysis). Note that this bound actually has nothing to do with the parametric form of \u03c0(\u03b8)\u2014it is based solely on the normal false posterior, and its distance to the target posterior mean \u00b5h. However, even if this distance was small, the importance estimate would still have infinite variance due to the Laplace target prior. Further, note that the situation can significantly worsen in higher dimensions, or if the false posterior has a lower variance."}, {"heading": "2.2. Prior Swapping", "text": "We\u2019d like a method that will work well even when false and target priors \u03c0f (\u03b8) and \u03c0(\u03b8) are significantly different, or are from different parametric families, with performance that does not worsen (in accuracy nor computational complexity) as the priors are made more dissimilar.\nRedoing inference for each new target posterior can be very costly, especially when the data size n is large, because the per-iteration cost of most standard inference algorithms scales with n, and many iterations may be needed for accurate inference. This includes both MCMC and sequential monte carlo (SMC) algorithms (i.e. repeated-ISmethods that infer a sequence of distributions). In SMC, the per-iteration cost still scales with n, and the variance estimates can still be infinite if subsequent distributions are ill-matched.\nInstead, we aim to leverage the inferred false posterior to more-efficiently compute any future target posterior. We begin by defining a prior swap density ps(\u03b8). Suppose for now that a false posterior inference algorithm has returned a density function p\u0303f (\u03b8) (we will give more details on p\u0303f\nlater; assume for now that it is either equal to pf (\u03b8|xn) or approximates it). We then define the prior swap density as\nps(\u03b8) \u221d p\u0303f (\u03b8)\u03c0(\u03b8)\n\u03c0f (\u03b8) . (5)\nNote that if p\u0303f (\u03b8) = pf (\u03b8|xn), then ps(\u03b8) = p(\u03b8|xn). However, depending on how we represent p\u0303f (\u03b8), ps(\u03b8) can have a much simpler analytic representation than p(\u03b8|xn), which is typically defined via a likelihood function (i.e. a function of the data) and causes inference algorithms to have costs that scale with the data size n. Specifically, we will only use low-complexity p\u0303f (\u03b8) that can be evaluated in constant time with respect to the data size n.\nOur general strategy is to use ps(\u03b8) as a surrogate for p(\u03b8|xn) in standard MCMC or optimization procedures, to yield data-independent algorithms with constant cost per iteration. Intuitively, the likelihood information is captured by the false posterior\u2014we make use of this instead of the likelihood function, which is costly to evaluate.\nMore concretely, at each iteration in standard inference algorithms, we must evaluate a data-dependent function associated with the posterior density. For example, we evaluate a function proportional to p(\u03b8|xn) in Metropolis-Hastings (MH) (Metropolis et al., 1953), and \u2207\u03b8 log p(\u03b8|xn) in gradient-based MCMC methods (such as Langevin dynamics (LD) (Rossky et al., 1978) and Hamiltonian Monte Carlo (HMC) (Neal, 2011)) and in optimization procedures that yield a MAP point estimate. In prior swapping, we instead evaluate ps(\u03b8) in MH, or \u2207\u03b8 log ps(\u03b8) in LD, HMC, or gradient optimization to a MAP estimate (see appendix for algorithm pseudocode). Here, each iteration only requires evaluating a few simple analytic expressions, and thus has O(1) complexity with respect to data size.\nWe demonstrate prior swapping on our previous example (using a normal false prior and Laplace target prior) in Fig. 2, where we have a closed-form (normal PDF) p\u0303f (\u03b8). To do prior swapping, we run a Metropolis-Hastings algorithm on the target density ps(\u03b8). Note that drawing each\nsample in this Markov chain does not involve the data xn, and can be done in constant time with respect to n (which we can see by viewing the wall time for different T ). In Fig. 2, we draw T samples {\u03b8t}Tt=1 \u223c ps(\u03b8), compute a sample estimate \u00b5\u0302PSh = 1 T \u2211T t=1 \u03b8t, and compare it with the true value \u00b5h. We see that \u00b5\u0302PSh converges to \u00b5h after a relatively small number of samples T."}, {"heading": "2.3. Prior Swapping with False Posterior Samples", "text": "The previous method is only applicable if our false posterior inference result is a PDF p\u0303f (\u03b8) (such as in closed-form inference or variational approximations). Here, we develop prior swapping methods for the setting where we only have access to samples {\u03b8\u0303t} Tf t=1 \u223c pf (\u03b8|xn). We propose the following procedure:\n1. Use {\u03b8\u0303t} Tf t=1 to form an estimate p\u0303f (\u03b8) \u2248 pf (\u03b8|xn). 2. Sample from ps(\u03b8) \u221d \u03c0(\u03b8)p\u0303f (\u03b8)\u03c0f (\u03b8) with prior swapping, as before.\nNote that, in general, ps(\u03b8) only approximates p(\u03b8|xn). As a final step, after sampling from ps(\u03b8), we can:\n3. Apply a correction to samples from ps(\u03b8).\nWe will describe two methods for applying a correction to ps samples\u2014one involving importance sampling, and one involving semiparametric density estimation. Additionally, we will discuss forms for p\u0303f (\u03b8), guarantees about these forms, and how to optimize the choice of p\u0303f (\u03b8). In particular, we will argue why (in constrast to the initial IS strategy) these methods do not fail when p(\u03b8|xn) and pf (\u03b8|xn) are very dissimilar or have ill-matching parametric forms.\nPrior swap importance sampling. Our first proposal for applying a correction to prior swap samples involves IS: after estimating some p\u0303f (\u03b8), and sampling {\u03b8t}Tt=1 \u223c ps(\u03b8), we can treat {\u03b8t}Tt=1 as importance samples, and compute the IS estimate\n\u00b5\u0302PSish = T\u2211 t=1 w(\u03b8t)h(\u03b8t) (6)\nwhere the weight function is now\nw(\u03b8) \u221d p(\u03b8|x n) ps(\u03b8) \u221d pf (\u03b8|x n) p\u0303f (\u03b8) (7)\nand the weights are normalized so that \u2211T t=1 w(\u03b8t) = 1.\nThe key difference between this and the previous IS strategy is the weight function. Recall that, previously, an accurate estimate depended on the similarity between \u03c0(\u03b8) and \u03c0f (\u03b8); both the distance to and parametric form of \u03c0(\u03b8) could produce high or infinite variance estimates. This was an issue because we wanted the procedure to work well for any \u03c0(\u03b8). Now, however, the performance depends on the similarity between p\u0303f (\u03b8) and pf (\u03b8|xn)\u2014and by using the false posterior samples, we can estimate a p\u0303f (\u03b8) that well approximates pf (\u03b8|xn). Additionally, we can prove that certain choices of p\u0303f (\u03b8) guarantee a finite variance IS estimate. Note that the variance of \u00b5\u0302PSish is only finite if\nEpf [ h(\u03b8)2 pf (\u03b8|xn)2\np\u0303f (\u03b8)2\n] \u221d Ep [ h(\u03b8)2\npf (\u03b8|xn) p\u0303f (\u03b8)\n] <\u221e.\nTo bound this, it is sufficient to show that there exists M \u2208 R such that pf (\u03b8|x\nn) p\u0303f (\u03b8)\n< M for all \u03b8 (assuming a test function h(\u03b8) with finite variance) (Geweke, 1989). To satisfy this condition, we will propose a certain parametric family p\u0303\u03b1f (\u03b8). Note that, to maintain a prior swapping procedure with O(1) cost, we want a p\u0303\u03b1f (\u03b8) that can be evaluated in constant time. In general, a p\u0303\u03b1f (\u03b8) with fewer terms will yield a faster procedure. With these in mind, we propose the following family of densities.\nDefinition. For a parameter \u03b1 = (\u03b11, . . . , \u03b1k), \u03b1j \u2208 Rp, k > 0, let density p\u0303\u03b1f (\u03b8) satisfy\np\u0303\u03b1f (\u03b8) \u221d \u03c0f (\u03b8) k\u220f j=1 p(\u03b1j |\u03b8)n/k (8)\nwhere p(\u03b1j |\u03b8) denotes the model conditional PDF.\nThe number of terms in p\u0303\u03b1f (\u03b8) (and cost to evaluate) is determined by the parameter k. Note that this family is\ninspired by the true form of the false posterior pf (\u03b8|xn). However, p\u0303\u03b1f (\u03b8) has constant-time evaluation, and we can estimate its parameter \u03b1 using samples {\u03b8\u0303t} Tf t=1 \u223c pf (\u03b8|xn). Furthermore, we have the following guarantees. Theorem 2.1. For any \u03b1 = (\u03b11, . . . , \u03b1k) \u2282 Rp and k > 0 let p\u0303\u03b1f (\u03b8) be defined as in Eq. (8). Then, there existsM > 0 such that pf (\u03b8|x n)\np\u0303\u03b1f (\u03b8) < M , for all \u03b8 \u2208 Rd.\nCorollary 2.1.1. For {\u03b8t}Tt=1 \u223c p\u03b1s (\u03b8) \u221d p\u0303\u03b1f (\u03b8)\u03c0(\u03b8) \u03c0f (\u03b8) , w(\u03b8t) = pf (\u03b8t|xn) p\u0303\u03b1f (\u03b8t) (\u2211T r=1 pf (\u03b8r|xn) p\u0303\u03b1f (\u03b8r) )\u22121 , and test function that satisfies Varp [h(\u03b8)] < \u221e, the variance of IS estimate \u00b5\u0302PSish = \u2211T t=1 h(\u03b8t)w(\u03b8t) is finite.\nProofs for these theorems are given in the appendix.\nNote that we do not know the normalization constant for p\u0303\u03b1f (\u03b8). This is not an issue for its use in prior swapping, since we only need access to a function proportional to p\u03b1s (\u03b8) \u221d p\u0303\u03b1f (\u03b8)\u03c0(\u03b8)\u03c0f (\u03b8)\u22121 in most MCMC algorithms. However, we still need to estimate \u03b1, which is an issue because the unknown normalization constant is a function of \u03b1. Fortunately, we can use the method of score matching (Hyva\u0308rinen, 2005) to estimate \u03b1 given a density such as p\u0303\u03b1f (\u03b8) with unknown normalization constant.\nOnce we have found an optimal parameter \u03b1\u2217, we draw samples from p\u03b1 \u2217 s (\u03b8) \u221d p\u0303\u03b1 \u2217 f (\u03b8)\u03c0(\u03b8)\u03c0f (\u03b8) \u22121, compute weights for these samples (Eq. (7)), and compute the IS estimate \u00b5\u0302PSish . We give pseudocode for the full prior swap importance sampling procedure in Alg. 1.\nAlgorithm 1: Prior Swap Importance Sampling\nInput: False posterior samples {\u03b8\u0303t} Tf t=1 \u223c pf (\u03b8|xn).\nOutput: IS estimate \u00b5\u0302PSish . 1 Score matching: estimate \u03b1\u2217 using {\u03b8\u0303t} Tf t=1. 2 Prior swapping: sample {\u03b8t}Tt=1 \u223c p\u03b1 \u2217 s (\u03b8) \u221d p\u0303\u03b1 \u2217 f (\u03b8)\u03c0(\u03b8) \u03c0f (\u03b8) .\n3 Importance sampling: compute \u00b5\u0302PSish = \u2211T t=1 h(\u03b8t)w(\u03b8t).\nSemiparametric prior swapping. In the previous method, we chose a parametric form for p\u0303\u03b1f (\u03b8); in general, even the optimal \u03b1 will yield an inexact approximation to pf (\u03b8|xn). Here, we aim to incorporate methods that return an increasingly exact estimate p\u0303f (\u03b8) when given more false posterior samples {\u03b8\u0303t} Tf t=1.\nOne idea is to use a nonparametric kernel density estimate p\u0303npf (\u03b8) and plug this into p np s (\u03b8) \u221d p\u0303 np f (\u03b8)\u03c0(\u03b8)\u03c0f (\u03b8)\n\u22121. However, nonparametric density estimates can yield inaccurate density tails and fare badly in high dimensions. To help mitigate these problems, we turn to a semiparametric estimate, which begins with a parametric estimate, and\nadjusts it as samples are generated. In particular, we use a density estimate that can be viewed as the product of a parametric density estimate and a nonparametric correction function (Hjort & Glad, 1995). This density estimate is consistent as the number of samples Tf \u2192 \u221e. Instead of (or in addition to) correcting prior swap samples with importance sampling, we can correct them by updating the nonparametric correction function as we continue to generate false posterior samples.\nGiven Tf samples {\u03b8\u0303t} Tf t=1 \u223c pf (\u03b8|xn), we write the semiparametric false posterior estimate as\np\u0303spf (\u03b8) = 1\nTf Tf\u2211 t=1\n[ 1\nbd K\n( \u2016\u03b8 \u2212 \u03b8\u0303t\u2016\nb\n) p\u0303\u03b1f (\u03b8)\np\u0303\u03b1f (\u03b8\u0303t)\n] , (9)\nwhere K denotes a probability density kernel, with bandwidth b, where b\u2192 0 as Tf \u2192\u221e (see (Wasserman, 2006) for details on probability density kernels and bandwidth selection). The semiparametric prior swap density is then\npsps (\u03b8) \u221d p\u0303spf (\u03b8)\u03c0(\u03b8)\n\u03c0f (\u03b8) =\n1\nTf Tf\u2211 t=1\nK ( \u2016\u03b8\u2212\u03b8\u0303t\u2016\nb ) p\u0303\u03b1f (\u03b8)\u03c0(\u03b8)\np\u0303\u03b1f (\u03b8\u0303t)\u03c0f (\u03b8)b d\n\u221d [p\u03b1s (\u03b8)]  1 Tf Tf\u2211 t=1 K ( \u2016\u03b8\u2212\u03b8\u0303t\u2016 b ) p\u0303\u03b1f (\u03b8\u0303t)  . (10) Hence, the prior swap density psps (\u03b8) is proportional to the product of two densities: the parametric prior swap density p\u03b1s (\u03b8), and a correction density. To estimate expectations with respect to psps (\u03b8), we can follow Alg. 1 as before, but replace the weight function in the final IS estimate with\nw(\u03b8) \u221d p sp s (\u03b8) p\u03b1s (\u03b8) \u221d 1 Tf Tf\u2211 t=1\nK ( \u2016\u03b8\u2212\u03b8\u0303t\u2016\nb ) p\u0303\u03b1f (\u03b8\u0303t) . (11)\nOne advantage of this strategy is that computing the weights doesn\u2019t require the data\u2014it thus has constant cost with respect to data size n (though its cost does increase with the number of false posterior samples Tf ). Additionally, as in importance sampling, we can prove that this procedure yields an exact estimate of E[h(\u03b8)], asymptotically, as Tf \u2192 \u221e (and we can provide an explicit bound on the rate at which psps (\u03b8) converges to p(\u03b8|xn)). We do this by showing that psps (\u03b8) is consistent for p(\u03b8|xn). Theorem 2.2. Given false posterior samples {\u03b8\u0303t} Tf t=1 \u223c pf (\u03b8|xn) and b T\u22121/(4+d)f , the estimator psps is consistent for p(\u03b8|xn), i.e. its mean-squared error satisfies\nsup p(\u03b8|xn)\nE [\u222b\n(psps (\u03b8)\u2212 p(\u03b8|xn)) 2 d\u03b8\n] <\nc\nT 4/(4+d) f\nfor some c > 0 and 0 < b \u2264 1.\nThe proof for this theorem is given in the appendix."}, {"heading": "3. Empirical Results", "text": "We show empirical results on Bayesian generalized linear models (including linear and logistic regression) with sparsity and heavy tailed priors, and on latent factor models (including mixture models and topic models) with relational priors over factors (e.g. diversity-encouraging, agglomerate-encouraging, etc.). We aim to demonstrate empirically that prior swapping efficiently yields correct samples and, in some cases, allows us to apply certain inference algorithms to more-complex models than was previously possible. In the following experiments, we will refer to the following procedures:\n\u2022 Target posterior inference: some standard inference algorithm (e.g. MCMC) run on p(\u03b8|xn).\n\u2022 False posterior inference: some standard inference algorithm run on pf (\u03b8|xn).\n\u2022 False posterior IS: IS using samples from pf (\u03b8|xn).\n\u2022 Prior swap exact: prior swapping with closed-form p\u0303f (\u03b8) = pf (\u03b8|xn).\n\u2022 Prior swap parametric: prior swapping with parametric p\u0303\u03b1f (\u03b8) given by Eq. (8).\n\u2022 Prior swap IS: correcting samples from p\u0303\u03b1f (\u03b8) with IS.\n\u2022 Prior swap semiparametric: correcting samples from p\u0303\u03b1f (\u03b8) with the semiparametric estimate IS procedure.\nTo assess performance, we choose a test function h(\u03b8), and compute the Euclidean distance between \u00b5h = Ep[h(\u03b8)] and some estimate \u00b5\u0302h returned by a procedure. We denote this performance metric by posterior error = \u2016\u00b5h \u2212 \u00b5\u0302h\u20162. Since \u00b5h is typically not available analytically, we run a single chain of MCMC on the target posterior for one million steps, and use these samples as ground truth to compute \u00b5h. For timing plots, to assess error of a method at a given time point, we collect samples drawn before this time point, remove the first quarter as burn in, and add the time it takes to compute any of the corrections."}, {"heading": "3.1. Sparsity Inducing and Heavy Tailed Priors in Bayesian Generalized Linear Models", "text": "Sparsity-encouraging regularizers have gained a high level of popularity over the past decade due to their ability to produce models with greater interpretability and parsimony. For example, the L1 norm has been used to induce sparsity with great effect (Tibshirani, 1996), and has been shown to be equivalent to a mean-zero independent Laplace prior (Tibshirani, 1996; Seeger, 2008). In a Bayesian setting, inference given a sparsity prior can be difficult, and often requires a computationally intensive method (such as MH or\nHMC) or posterior approximations (e.g. expectation propagation (Minka, 2001)) that make factorization or parametric assumptions (Seeger, 2008; Gerwinn et al., 2010). We propose a cheap yet accurate solution: first get an inference result with a more-tractable prior (such as a normal prior), and then use prior swapping to quickly convert the result to the posterior given a sparsity prior.\nOur first set of experiments are on Bayesian linear regression models, which we can write as yi = Xi\u03b8 + , \u223c N (0, \u03c32), \u03b8 \u223c \u03c0, i = 1,...,n. For \u03c0, we compute results on Laplace, Student\u2019s t, and VerySparse (with PDF VerySparse(\u03c3) = \u220fd i=1 1 2\u03c3 exp{\u2212|\u03b8i|\n0.4/\u03c3} (Seeger, 2008)) priors. Here, a normal \u03c0f is conjugate and allows for exact false posterior inference. Our second set of experiments are on Bayesian logistic regression models, which we write as yi \u223c Bern(pi), pi = logistic(Xi\u03b8), \u03b8 \u223c \u03c0, i = 1,...,n. which we will pair with both heavy tailed priors and a hierarchical target prior \u03c0 = N (0, \u03b1\u22121I), \u03b1 \u223c Gamma(\u03b3, 1). For these experiments, we also use a normal \u03c0f . However, this false prior is no longer conjugate, and so we use MCMC to sample from pf (\u03b8|xn).\nFor linear regression, we use the YearPredictionMSD data set*, (n = 515345, d = 90), in which regression is used to predict the year associated with a a song, and for logistic regression we use the MiniBooNE particle identification data set\u2020, (n = 130065, d = 50), in which binary classification is used to distinguish particles.\nIn Fig. 3, we compare prior swapping and IS methods, in order to show that the prior swapping procedures yield accurate posterior estimates, and to compare their speeds of convergence. We plot posterior error vs. wall time for each method\u2019s estimate of the posterior mean Ep[h(\u03b8)] = Ep[\u03b8] for two sparsity target priors (Laplace and VerySparse), for both linear and logistic regression. In linear regression (only), since the normal conjugate \u03c0f allows us to compute a closed form pf (\u03b8|xn), we can run the prior swap exact method, where p\u0303f (\u03b8) = pf (\u03b8|xn). However, we can also sample from pf (\u03b8|xn) to compute p\u0303\u03b1 \u2217\nf (\u03b8), and therefore compare methods such as prior swap parametric and the two correction methods. In logistic regression, we do not have a closed form pf (\u03b8|xn); here, we only compare the methods that make use of samples from pf (\u03b8|xn). In Fig. 3, we see that the prior swapping methods (particularly prior swap IS) quickly converge to nearly zero posterior error. Additionally, in linear regression, we see that prior swap parametric, using p\u0303f (\u03b8) = p\u0303\u03b1 \u2217\nf (\u03b8), yields similar posterior error as prior swap exact, which uses p\u0303f (\u03b8) = p(\u03b8|xn).\n*https://archive.ics.uci.edu/ml/datasets/ YearPredictionMSD\n\u2020https://archive.ics.uci.edu/ml/datasets/ MiniBooNE+particle+identification\nIn Fig. 4, we show how prior swapping can be used for fast inference in Bayesian linear models with sparsity or heavy-tailed priors. We plot the time needed to first compute the false posterior (via exact inference) and then run prior swapping (via the MH procedure) on some target posterior, and compare this with the MH algorithm run directly on the target posterior. In (a) and (b) we show convergence plots and see that prior swapping performs faster inference (by a few orders of magnitude) than direct MH. In plot (b) we reduce the variance of the target prior; while this hurts the accuracy of false posterior IS, prior swapping still quickly converges to zero error. In (c) we show 1-d density marginals as we increase the prior sparsity, and in (d) we show prior swapping results for various sparsity priors.\nIn the appendix, we also include results on logistic regression with the hierarchical target prior, as well as results for synthetic data where we are able to compare timing and posterior error as we tune n and d."}, {"heading": "3.2. Priors over Factors in Latent Variable Models", "text": "Many latent variable models in machine learning\u2014such as mixture models, topic models, probabilistic matrix factorization, and others\u2014involve a set of latent factors (e.g. components or topics). Often, we\u2019d like to use priors that encourage interesting behaviors among the factors. For example, we might want dissimilar factors through a diversity-promoting prior (Kwok & Adams, 2012; Xie et al., 2016) or for the factors to show some sort of sparsity pattern (Mayrink et al., 2013; Knowles & Ghahramani, 2011). Inference in such models is often computationally expensive or designed on a case-by-case basis (Xie et al., 2016; Knowles & Ghahramani, 2011).\nHowever, when conjugate priors are placed over the factor parameters, collapsed Gibbs sampling can be applied. In this method, the factor parameters are integrated out, leaving only a subset of variables; on these, the conditional\n(a) (b)\nCollapsed Gibbs Prior Swapping\nW al\nl t im\ne (s\nec o\nn d\ns)\n0\n0.5\n1\n1.5\n2\n2.5\n3x 10 4\n1. southern 2. northern 3. region 4. western 5. eastern 6. south\nTopic 6\nTopic Model: False Posterior via Collapsed Gibbs\nC lu\nst er : G eo gr ap h y C lu st er : F am il y\n1. west 2. south 3. coast 4. north 5. east 6. western Topic 171 1. north 2. asia 3. south 4. western 5. southern 6. eastern Topic 285\n1. father 2. family 3. brother 4. born 5. son 6. children Topic 11 1. children 2. daughter 3. born 4. son 5. family 6. father Topic 243 1. born 2. died 3. father 4. years 5. family 6. lived Topic 280 1. born 2. parents 3. studied 4. moved 5. age 6. year Topic 306\n1. north 2. west 3. east 4. south 5. eastern 6. western\nTopic 353\nTopic Model: Target Posterior via Prior Swapping\n1. brother 2. sister 3. younger 4. older 5. youngest 6. sisters Topic 11 1. husband 2. marriage 3. wife 4. death 5. marry 6. children Topic 243 1. school 2. college 3. graduated 4. studies 5. university 6. fellow Topic 306Topic 280 1. important 2. stayed 3. wrote 4. travelled 5. started 6. died\n1. territory 2. region 3. regions 4. provinces 5. capital 6. territories\nTopic 6\nT er\nri to\nri es 1. bay\n2. south 3. coast 4. area 5. land 6. sea\nTopic 171\nC oa\nst\n1. america 2. europe 3. asia 4. world 5. countries 6. africa\nTopic 285\nC ou\nn tr\nie s 1. side\n2. east 3. bordered 4. west 5. middle 6. border\nTopic 353\nB or\nd er\nSi b\nli n\ngs\nM ar\nri ag\ne\nB io\ngr ap\nh y\nSc h\noo l\nPr io\nr sw\nap p\nin g\nfo r\ndi ve\nrs e\nto p\nic s.\n= D\niv er\nse (0\n.5 )\n(c)\nRelational target priors (over factors )\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n\u22123 \u22122 \u22121 0 1 2 3 4\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4 3. Chain(0.1)\n7. SparseChain(0.1) 8. Origin+Diverse(0.1)6. SparseAgglom(0.1)\nFalse-Posterior 1. Origin(0.1) 2. Agglom(0.1) 4. Diverse(0.1)\n5. SparseOrigin(0.1)Wall time (seconds)\nMixture Model: False Posterior via Collapsed Gibbs, Target Posterior via Prior Swapping\nFigure 5. Latent factor models: (a) Prior swapping results for relational target priors (defined in (b)) over components in a mixture model. (c) Prior swapping with a diversity-promoting target prior on an LDA topic model (Simple English Wikipedia corpus) to separate redundant topic clusters; the top 6 words per topic are shown. In (a, c) we show wall times for the initial inference and prior swapping.\ndistributions can be computed analytically, which allows for Gibbs sampling over these variables. Afterwards, samples of the collapsed factor parameters can be computed. Hence, we propose the following strategy: first, assign a prior for the factor parameters that allows for collapsed Gibbs sampling; afterwards, reconstruct the factor samples and apply prior swapping for more complex relational priors over the factors. We can thus perform convenient inference in the collapsed model, yet apply more-sophisticated priors to variables in the uncollapsed model.\nWe first show results on a Gaussian mixture model (GMM), written xi \u223c N (\u00b5zi ,\u03a3zi), zi \u223c Dir(\u03b1), {\u00b5m}Mm=1 \u223c \u03c0, i = 1,...,n. Using a normal \u03c0f over {\u00b5m}Mm=1 allows for collapsed Gibbs sampling. We also show results on a topic model (latent Dirichlet allocation (LDA) (Blei et al., 2003)) for text data (for the form of this model, see (Blei et al., 2003; Wang & Blei, 2011)). Here, using a Dirichlet \u03c0f over topics allows for collapsed Gibbs sampling. For mixture models, we generate synthetic data from the above model (n=10,000, d=2, M=9), and for topic models, we use the Simple English Wikipedia\u2021 corpus (n=27,443 documents, vocab=10,192 words), and set M=400 topics.\n\u2021https://simple.wikipedia.org/\nIn Fig. 5, we show results for mixture and topic models. In (a) we show inferred posteriors over GMM components for a number of relational target priors, which we define in (b). In (c), we apply the diversity-promoting target prior to LDA, to separate redundant topics. Here, we show two topic clusters (\u201cgeography\u201d and \u201cfamily\u201d) in pf (\u03b8|xn), which are separated into distinct, yet thematically-similar, topics after prior swapping. In (a) and (c) we also show wall times of the inference methods."}, {"heading": "4. Conclusion", "text": "Given some false posterior inference result, and an arbitrary target prior, we have studied methods to accurately compute the associated target posterior (or expectations with respect to it), and to do this efficiently by leveraging the pre-inferred result. We have argued and shown empirically that this strategy is effective even when the false and target posteriors are quite dissimilar. We believe that this strategy shows promise to allow a wider range of (and possibly less-costly) inference alorithms to be applied to certain models, and to allow updated or new prior information to be more-easily incorporated into models without re-incurring the full costs of standard inference algorithms."}], "year": 2017, "references": [{"title": "Bayesian computation and stochastic systems", "authors": ["Besag", "Julian", "Green", "Peter", "Higdon", "David", "Mengersen", "Kerrie"], "venue": "Statistical science,", "year": 1995}, {"title": "Latent dirichlet allocation", "authors": ["Blei", "David M", "Ng", "Andrew Y", "Jordan", "Michael I"], "venue": "The Journal of Machine Learning Research,", "year": 2003}, {"title": "An efficient computational approach for prior sensitivity analysis and cross-validation", "authors": ["Bornn", "Luke", "Doucet", "Arnaud", "Gottardo", "Raphael"], "venue": "Canadian Journal of Statistics,", "year": 2010}, {"title": "Conjugate priors for exponential families", "authors": ["Diaconis", "Persi", "Ylvisaker", "Donald"], "venue": "The Annals of statistics,", "year": 1979}, {"title": "On sequential monte carlo sampling methods for bayesian filtering", "authors": ["Doucet", "Arnaud", "Godsill", "Simon", "Andrieu", "Christophe"], "venue": "Statistics and computing,", "year": 2000}, {"title": "Bayesian inference for generalized linear models for spiking neurons", "authors": ["Gerwinn", "Sebastian", "Macke", "Jakob H", "Bethge", "Matthias"], "venue": "Frontiers in Computational Neuroscience,", "year": 2010}, {"title": "Bayesian inference in econometric models using monte carlo integration", "authors": ["Geweke", "John"], "venue": "Econometrica: Journal of the Econometric Society,", "year": 1989}, {"title": "Monte carlo sampling methods using markov chains and their applications", "authors": ["Hastings", "W Keith"], "year": 1970}, {"title": "Nonparametric density estimation with a parametric start", "authors": ["Hjort", "Nils Lid", "Glad", "Ingrid K"], "venue": "The Annals of Statistics,", "year": 1995}, {"title": "Estimation of non-normalized statistical models by score matching", "authors": ["Hyv\u00e4rinen", "Aapo"], "venue": "Journal of Machine Learning Research,", "year": 2005}, {"title": "Nonparametric bayesian sparse factor models with application to gene expression modeling", "authors": ["Knowles", "David", "Ghahramani", "Zoubin"], "venue": "The Annals of Applied Statistics,", "year": 2011}, {"title": "Priors for diversity in generative latent variable models", "authors": ["Kwok", "James T", "Adams", "Ryan P"], "venue": "In Advances in Neural Information Processing Systems,", "year": 2012}, {"title": "Sparse latent factor models with interactions: Analysis of gene expression data", "authors": ["Mayrink", "Vinicius Diniz", "Lucas", "Joseph Edward"], "venue": "The Annals of Applied Statistics,", "year": 2013}, {"title": "Equation of state calculations by fast computing machines", "authors": ["Metropolis", "Nicholas", "Rosenbluth", "Arianna W", "Marshall N", "Teller", "Augusta H", "Edward"], "venue": "The journal of chemical physics,", "year": 1953}, {"title": "Expectation propagation for approximate bayesian inference", "authors": ["Minka", "Thomas P"], "venue": "In Proceedings of the Seventeenth conference on Uncertainty in artificial intelligence,", "year": 2001}, {"title": "MCMC using hamiltonian dynamics", "authors": ["R. Neal"], "venue": "Handbook of Markov Chain Monte Carlo,", "year": 2011}, {"title": "Brownian dynamics as smart monte carlo simulation", "authors": ["PJ Rossky", "JD Doll", "Friedman", "HL"], "venue": "The Journal of Chemical Physics,", "year": 1978}, {"title": "Bayesian inference and optimal design for the sparse linear model", "authors": ["Seeger", "Matthias W"], "venue": "The Journal of Machine Learning Research,", "year": 2008}, {"title": "Bayesian computation via the gibbs sampler and related markov chain monte carlo methods", "authors": ["Smith", "Adrian FM", "Roberts", "Gareth O"], "venue": "Journal of the Royal Statistical Society. Series B (Methodological), pp", "year": 1993}, {"title": "A collapsed variational bayesian inference algorithm for latent dirichlet allocation", "authors": ["Teh", "Yee W", "Newman", "David", "Welling", "Max"], "venue": "In Advances in neural information processing systems,", "year": 2006}, {"title": "Regression shrinkage and selection via the lasso", "authors": ["Tibshirani", "Robert"], "venue": "Journal of the Royal Statistical Society. Series B (Methodological), pp", "year": 1996}, {"title": "Collaborative topic modeling for recommending scientific articles", "authors": ["Wang", "Chong", "Blei", "David M"], "venue": "In Proceedings of the 17th ACM SIGKDD international conference on Knowledge discovery and data mining,", "year": 2011}, {"title": "Variational inference in nonconjugate models", "authors": ["Wang", "Chong", "Blei", "David M"], "venue": "The Journal of Machine Learning Research,", "year": 2013}, {"title": "All of nonparametric statistics", "authors": ["Wasserman", "Larry"], "venue": "Springer Science & Business Media,", "year": 2006}, {"title": "Diversitypromoting bayesian learning of latent variable models", "authors": ["Xie", "Pengtao", "Zhu", "Jun", "Xing", "Eric"], "venue": "In Proceedings of the 33st International Conference on Machine Learning", "year": 2016}], "id": "SP:b0e04873c6e62ab847ccbbe693050ce3bec75601", "authors": [{"name": "Willie Neiswanger", "affiliations": []}, {"name": "Eric Xing", "affiliations": []}], "abstractText": "While Bayesian methods are praised for their ability to incorporate useful prior knowledge, in practice, convenient priors that allow for computationally cheap or tractable inference are commonly used. In this paper, we investigate the following question: for a given model, is it possible to compute an inference result with any convenient false prior, and afterwards, given any target prior of interest, quickly transform this result into the target posterior? A potential solution is to use importance sampling (IS). However, we demonstrate that IS will fail for many choices of the target prior, depending on its parametric form and similarity to the false prior. Instead, we propose prior swapping, a method that leverages the pre-inferred false posterior to efficiently generate accurate posterior samples under arbitrary target priors. Prior swapping lets us apply less-costly inference algorithms to certain models, and incorporate new or updated prior information \u201cpost-inference\u201d. We give theoretical guarantees about our method, and demonstrate it empirically on a number of models and priors.", "title": "Post-Inference Prior Swapping"}