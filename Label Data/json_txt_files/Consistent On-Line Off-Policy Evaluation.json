{"sections": [{"heading": "1. Introduction", "text": "Reinforcement Learning (RL) techniques were successfully applied in fields such as robotics, games, marketing and more (Kober et al., 2013; Al-Rawi et al., 2015; Barrett et al., 2013). We consider the problem of off-policy evaluation (OPE) \u2013 assessing the performance of a complex strategy without applying it. An OPE formulation is often considered in domains with limited sampling capability. For example, marketing and recommender systems (Theocharous and Hallak, 2013; Theocharous et al., 2015) directly relate policies to revenue. A more extreme example is drug administration, as there are only few patients in\n1The Technion, Haifa, Israel. Correspondence to: Assaf Hallak <ifogph@gmail.com>, Shie Mannor <shie@ee.technion.ac.il>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nthe testing population, and sub-optimal policies can have life threatening effects (Hochberg et al., 2016). OPE can also be useful as a module for policy optimization in a policy improvement scheme (Thomas et al., 2015a).\nIn this paper, we consider the OPE problem in an on-line setup where each new sample is immediately used to update our current value estimate of some previously unseen policy. We propose and analyze a new algorithm called COP-TD(\u03bb,\u03b2) for estimating the value of the target policy; COP-TD(\u03bb,\u03b2) has the following properties:\n1. Easy to understand and implement on-line.\n2. Allows closing the gap to consistency such that the limit point is the same that would have been obtained by on-policy learning with the target policy.\n3. Empirically comparable to state-of-the art algorithms.\nOur algorithm resembles (Sutton et al., 2015)\u2019s Emphatic TD that was extended by (Hallak et al., 2015) to the general parametric form ETD(\u03bb,\u03b2). We clarify the connection between the algorithms and compare them empirically. Finally, we introduce an additional related heuristic called Log-COP-TD(\u03bb,\u03b2) and motivate it."}, {"heading": "2. Notations and Background", "text": "We consider the standard discounted Markov Decision Process (MDP) formulation (Bertsekas and Tsitsiklis, 1996) with a single long trajectory. Let M = (S,A,P,R, \u03b6, \u03b3) be an MDP where S is the finite state space and A is the finite action space. The parameter P sets the transition probabilities Pr(s\u2032|s, a) given the previous state s \u2208 S and action a \u2208 A, where the first state is determined by the distribution \u03b6. The parameter R sets the reward distribution r(s, a) obtained by taking action a in state s and \u03b3 is the discount factor specifying the exponential reduction in reward with time. The process advances as follows:\nA state s0 is sampled according to the distribution \u03b6(s). Then, at each time step t starting from t = 0 the agent draws an action at according to the stochastic behavior policy \u00b5(a|st), a reward rt . = r(st, at) is accumulated by the agent, and the next state st+1 is sampled using the transition probability Pr(s\u2032|st, at).\nThe expected discounted accumulated reward starting from a specific state and choosing an action by some policy \u03c0 is called the value function, which is also known to satisfy the Bellman equation in a vector form:\nV \u03c0(s) = E\u03c0 [ \u221e\u2211 t=0 \u03b3trt \u2223\u2223\u2223 s0 = s] , T\u03c0V .= R\u03c0 + \u03b3P\u03c0V, where [R\u03c0]s . = E\u03c0 [r(s, \u03c0(s))] and [P\u03c0]s,s\u2032 . = E\u03c0 [Pr(s\u2032|s, \u03c0(s))] are the policy induced reward vector and transition probability matrix respectively; T\u03c0 is called the Bellman operator. The problem of estimating V \u03c0(s) from samples is called policy evaluation. If the target policy \u03c0 is different than the behavior policy \u00b5 which generated the samples, the problem is called off-policy evaluation (OPE). The TD(\u03bb) (Sutton, 1988) algorithm is a standard solution to on-line on-policy evaluation: Each time step the temporal difference error updates the current value function estimate, such that eventually the stochastic approximation process will converge to the true value function. The standard form of TD(\u03bb) is given by:\nR (n) t,st = n\u22121\u2211 i=0 \u03b3irt+i + \u03b3 nV\u0302t(st+n),\nR\u03bbt,st =(1\u2212 \u03bb) \u221e\u2211 n=0 \u03bbnR(n+1)st ,\nV\u0302t+1(st) =V\u0302t(st) + \u03b1t ( R\u03bbt,st \u2212 V\u0302t(st) ) ,\n(1)\nwhere \u03b1t is the step size. The value R (n) t,st is an estimate of the current state\u2019s V (st), looking forward n steps, and R\u03bbt,st is an exponentially weighted average of all of these estimates going forward till infinity. Notice that Equation 1 does not specify an on-line implementation since R(n)t,st depends on future observations, however there exists a compact on-line implementation using eligibility traces (Bertsekas and Tsitsiklis (1996) for on-line TD(\u03bb), and Sutton et al. (2014), Sutton et al. (2015) for off-policy TD(\u03bb)). The underlying operator of TD(\u03bb) is given by:\nT\u03bb\u03c0 V = (1\u2212 \u03bb) \u221e\u2211 n=0 \u03bbn ( n\u2211 i=0 \u03b3iP i\u03c0R\u03c0 + \u03b3 n+1Pn+1\u03c0 V ) = (1\u2212 \u03bb)(I \u2212 \u03bbT\u03c0)\u22121T\u03c0V,\nand is a \u03b3(1\u2212\u03bb)1\u2212\u03bb\u03b3 -contraction (Bertsekas, 2012).\nWe denote by d\u00b5(s) the stationary distribution over states induced by taking the policy \u00b5 and mark D\u00b5 = diag(d\u00b5). Since we are concerned with the behavior at infinite horizon, we assume \u03b6(s) = d\u00b5(s). In addition, we assume that the MDP is ergodic for the two specified policies \u00b5, \u03c0 so \u2200s \u2208 S : d\u00b5(s) > 0, d\u03c0(s) > 0 and that the OPE problem is proper \u2013 \u03c0(a|s) > 0\u21d2 \u00b5(a|s) > 0.\nWhen the state space is too large to hold V \u03c0(s), a linear function approximation scheme is used: V \u03c0(s) \u2248 \u03b8>\u03c0 \u03c6(s), where \u03b8 is the optimized weight vector and \u03c6(s) is the feature vector of state s composed of k features. We denote by \u03a0d\u03c0 the projection to the subspace spanned by the features with respect to the d\u03c0-weighted norm, and by \u03a6 \u2208 RS,k the matrix whose lines consist of the feature vectors for each state and assume its columns are linearly independent.\nTD(\u03bb) can be adjusted to find the fixed point of \u03a0d\u03c0T \u03bb \u03c0 (Sutton and Barto, 1998):\nR (n) t,st = n\u22121\u2211 i=0 \u03b3irt+i + \u03b3 n\u03b8>t \u03c6(st+n),\nR\u03bbt,st =(1\u2212 \u03bb) \u221e\u2211 n=0 \u03bbnR(n+1)st ,\n\u03b8t+1 =\u03b8t + \u03b1t ( R\u03bbt,st \u2212 \u03b8 > t \u03c6(st) ) \u03c6(st).\nFinally, we define OPE-related quantities:\n\u03c1t . = \u03c0(at|st) \u00b5(at|st) , \u0393nt . = n\u22121\u220f i=0 \u03c1t\u22121\u2212i, \u03c1d(s) . = d\u03c0(s) d\u00b5(s) ,\nwe call \u03c1d the covariate shift ratio (as denoted under different settings by (Hachiya et al., 2012)).\nWe summarize the assumptions used in the proofs:\n1. For both policies the induced Markov chain is ergodic.\n2. The first state s0 is distributed according to the stationary distribution of the behavior policy d\u00b5(s).\n3. The problem is proper: \u03c0(a|s) > 0\u21d2 \u00b5(a|s) > 0.\n4. The feature matrix \u03a6 has full rank k.\nAssumption 1 is commonly used for convergence theorems as it verifies the value function is well defined on all states regardless of the initial sampled state. Assumption 2 can be relaxed since we are concerned with the long-term properties of the algorithm past its mixing time \u2013 we require it for clarity of the proofs. Assumption 3 is required so the importance sampling ratios will be well defined. Assumption 4 guarantees the optimal \u03b8 is unique which greatly simplifies the proofs."}, {"heading": "3. Previous Work", "text": "We can roughly categorize previous OPE algorithms to two main families. Gradient based methods that perform stochastic gradient descent on error terms they want to minimize. These include GTD (Sutton et al., 2009a), GTD-2,\nTDC (Sutton et al., 2009b) and HTD (White and White, 2016). The main disadvantages of gradient based methods are (A) they usually update an additional error correcting term, which means another time-step parameter needs to be controlled; and (B) they rely on estimating non-trivial terms, an estimate that tends to converge slowly. The other family uses importance sampling (IS) methods that correct the gains between on-policy and off-policy updates using the IS-ratios \u03c1t\u2019s. Among these are full IS (Precup et al., 2001) and ETD(\u03bb,\u03b2) (Sutton et al., 2015). These methods are characterized by the bias-variance trade-off they resort to \u2013 navigating between biased convergent values (or even divergent), and very slow convergence stemming from the high variance of IS correcting factors (the \u03c1t products). There are also a few algorithms that fall between the two, for example TO-GTD (van Hasselt et al., 2014) and WISTD(\u03bb) (Mahmood and Sutton, 2015).\nA comparison of these algorithms in terms of convergence rate, synergy with function approximation and more is available in (White and White, 2016; Geist and Scherrer, 2014). We focus in this paper on the limit point of the convergence. For most of the aforementioned algorithms, the process was shown to converge almost surely to the fixed point of the projected Bellman operator \u03a0dT\u03c0 where d is some stationary distribution (usually d\u00b5), however the d in question was never1 d\u03c0 as we would have obtained from running on-policy TD with the target policy (also see (Kolter, 2011) for relevant discussion). The algorithm achieving the closest result is ETD(\u03bb,\u03b2) which replaced d with f = ( I \u2212 \u03b2P>\u03c0 )\u22121 d\u00b5, where \u03b2 trades-off some of the process\u2019 variance with the bias in the limit point. Hence, our main contribution is a consistent algorithm which can converge to the same value that would have been obtained by running an on-policy scheme with the same policy."}, {"heading": "4. Motivation", "text": "Here we provide a motivating example showing that even in simple cases with \u201cclose\u201d behavior and target policies, the two induced stationary distributions can differ greatly. Choosing a specific linear parameterization further emphasizes the difference between applying on-policy TD with the target policy, and applying inconsistent off-policy TD.\nAssume a chain MDP with numbered states 1, 2, ..|S|, where from each state s you can either move left to state s \u2212 1, or right to state s + 1. If you\u2019ve reached the beginning or the end of the chain (states 1 or |S|) then taking a step further does not affect your location. Assume the behavior policy moves left with probability 0.5 + , while the target policy moves right with probability 0.5+ . It is easy\n1Except full IS, however its variance is too high to be applicable in practice.\nto see that the stationary distributions are given by: d\u00b5(s) \u221d (\n0.5\u2212 0.5 +\n)s , d\u03c0(s) \u221d ( 0.5 +\n0.5\u2212\n)s .\nFor instance, if we have a length 100 chain with = 0.01, for the rightmost state we have d\u00b5(|S|) \u2248 8 \u00b7 10\u22124, d\u03c0(|S|) \u2248 0.04. Let\u2019s set the reward to be 1 for the right half of the chain, so the target policy is better since it spends more time in the right half. The value of the target policy in the edges of the chain for \u03b3 = 0.99 is V \u03c0(1) = 0.21, V \u03c0(100) = 99.97.\nNow what happens if we try to approximate the value function using one constant feature \u03c6(s) \u2261 1? The fixed point of \u03a0d\u00b5T\u03c0 is \u03b8 = 11.92, while the fixed point of \u03a0d\u03c0T\u03c0 is \u03b8 = 88.08 \u2013 a substantial difference. The reason for this difference lies in the emphasis each projection puts on the states: according to \u03a0d\u00b5 , the important states are in the left half of the chain \u2013 these with low value function, and therefore the value estimation of all states is low. However, according to \u03a0d\u03c0 the important states are concentrated on the right part of the chain since the target policy will visit these more often. Hence, the estimation error is emphasized on the right part of the chain and the value estimation is higher. When we wish to estimate the value of the target policy, we want to know what will happen if we deploy it instead of the behavior policy, thus taking the fixed point of \u03a0d\u03c0T\u03c0 better represents the off-policy evaluation solution.\n5. COP-TD(\u03bb, \u03b2) Most off-policy algorithms multiply the TD summand of TD(\u03bb) with some value that depends on the history and the current state. For example, full IS-TD by (Precup et al., 2001) examines the ratio between the probabilities of the trajectory under both policies:\nP\u03c0(s0, a0, s1, . . . , st, at) P\u00b5(s0, a0, s1, . . . , st, at) = t\u220f m=0 \u03c1m = \u0393 t t\u03c1t. (2)\nIn problems with a long horizon, or these that start from the stationary distribution, we suggest using the time-invariant covariate shift \u03c1d multiplied by the current \u03c1t. The intuition is the following: We would prefer using the probabilities ratio given in Equation 2, but it has very high variance, and after many time steps we might as well look at the stationary distribution ratio instead. This direction leads us to the following update equations:\n\u03b8t+1 = \u03b8t + \u03b1t\u03c1d(st)\u03c1t ( rt + \u03b8 > t (\u03b3\u03c6(st+1)\u2212 \u03c6(st)) ) \u03c6(st).\n(3) Lemma 1. If the \u03b1t satisfy \u2211\u221e t=0 \u03b1t =\u221e, \u2211\u221e t=0 \u03b1 2 t <\u221e then the process described by Eq. (3) converges almost surely to the fixed point of \u03a0\u03c0T\u03c0V = V .\nThe proof follows the ODE method (Kushner and Yin, 2003) similarly to Tsitsiklis and Van Roy (1997) (see the appendix for more details).\nSince \u03c1d(s) is generally unknown, it is estimated using an additional stochastic approximation process. In order to do so, we note the following Lemma:\nLemma 2. Let \u03c1\u0302d be an unbiased estimate of \u03c1d, and for every n = 0, 1, . . . , t define \u0393\u0303nt . = \u03c1\u0302d(st\u2212n)\u0393 n t . Then:\nE\u00b5 [ \u0393\u0303nt |st ] = \u03c1d(st).\nFor any state st there are t\u2192\u221e such quantities {\u0393\u0303nt }tn=0, where we propose to weight them similarly to TD(\u03bb):\n\u0393\u0303\u03b2t = (1\u2212 \u03b2) \u221e\u2211 n=0 \u03b2n\u0393\u0303n+1t .\nNote that \u03c1d(s), unlike V (s), is restricted to a close set since its d\u00b5-weighted linear combination is equal to 1 and all of its entries are non-negative; We denote this d\u00b5weighted simplex by \u2206d\u00b5 , and let \u03a0\u2206d\u00b5 be the (non-linear) projection to this set with respect to the Euclidean norm (\u03a0\u2206d\u00b5 can be calculated efficiently, (Chen and Ye, 2011)). Now, we can devise a TD algorithm which estimates \u03c1d and uses it to find \u03b8, which we call COP-TD(0, \u03b2) (Consistent Off-Policy TD).\nAlgorithm 1 COP-TD(0,\u03b2), Input: \u03b80, \u03c1\u0302d,0,\n1: Init: F0 = 0, n \u03b2 0 = 1, N(s) = 0 2: for t = 1, 2, ... do 3: Observe st, at, rt, st+1 4: Update normalization terms: 5: N(st) = N(st) + 1, \u2200s \u2208 S : d\u0302\u00b5(s) = N(s)t 6: n\u03b2t = \u03b2n \u03b2 t + 1 7: Update \u0393nt \u2019s weighted average: 8: Ft = \u03c1t\u22121(\u03b2Ft\u22121 + est\u22121) 9: Update & project by \u03c1d\u2019s TD error:\n10: \u03b4dt = F>t \u03c1\u0302d,t\nn\u03b2t\ufe38 \ufe37\ufe37 \ufe38 \u2192\u0393\u0303\u03b2t\n\u2212\u03c1\u0302d,t(st)\n11: \u03c1\u0302d,t+1 = \u03a0\u2206d\u0302\u00b5 ( \u03c1\u0302d,t + \u03b1 d t \u03b4 d t est ) 12: Off-policy TD(0): 13: \u03b4t = rt + \u03b8>t (\u03b3\u03c6(st+1)\u2212 \u03c6(st)) 14: \u03b8t+1 = \u03b8t + \u03b1t\u03c1\u0302d,t+1(st)\u03c1t\u03b4t\u03c6(st) 15: end for\nSimilarly to the Bellman operator for TD-learning, we define the underlying COP-operator Y and its \u03b2 extension:\nY u = D\u22121\u00b5 P > \u03c0 D\u00b5u,\nY \u03b2u = (1\u2212 \u03b2)D\u22121\u00b5 P>\u03c0 (I \u2212 \u03b2P>\u03c0 )\u22121D\u00b5u.\nThe following Lemma may give some intuition on the convergence of the \u03c1d estimation process: Lemma 3. Under the ergodicity assumption, denote the eigenvalues of P\u03c0 by 0 \u2264 \u00b7 \u00b7 \u00b7 \u2264 |\u03be2| < \u03be1 = 1. Then Y \u03b2 is a maxi 6=1\n(1\u2212\u03b2)|\u03bei| |1\u2212\u03b2\u03bei| < 1-contraction in the L2-norm on the\northogonal subspace to \u03c1d, and \u03c1d is a fixed point of Y \u03b2 .\nThe technical proof is given in the appendix. Theorem 1. If the step sizes satisfy \u2211 t \u03b1t = \u2211 t \u03b1 d t =\n\u221e, \u2211 t(\u03b1 2 t + (\u03b1 d t )\n2) < \u221e, \u03b1t \u03b1dt \u2192 0, t\u03b1dt \u2192 0, and E [ (\u03b2n\u0393nt ) 2|st ] \u2264 C for some constant C and every t and n, then after applying COP-TD(0, \u03b2), \u03c1\u0302d,t converges to \u03c1d almost surely, and \u03b8t converges to the fixed point of \u03a0\u03c0T\u03c0V .\nNotice that COP-TD(0, \u03b2) given in Alg. 1 is infeasible in problems with large state spaces since \u03c1d \u2208 R|S|. Like TD(\u03bb), we can introduce linear function approximation: represent \u03c1d(s) \u2248 \u03b8>\u03c1 \u03c6\u03c1(s) where \u03b8\u03c1 is a weight vector and \u03c6\u03c1(s) is the off-policy feature vector and adjust the algorithm accordingly. For \u03c1\u0302d to still be contained in the set \u2206d\u00b5 , we pose the requirement on the feature vectors: \u03c6\u03c1(s) \u2208 Rk+, and \u2211 s d\u00b5(s)\u03b8 > \u03c1 \u03c6\u03c1(s) = 1 ( noted as\nthe simplex projection \u03a0\u2206E\u00b5[\u03c6\u03c1(s)] ) . In practice, the latter\nrequirement can be approximated: \u2211 s d\u00b5(s)\u03b8 > \u03c1 \u03c6\u03c1(s) \u2248 1 t \u03b8 > \u03c1 \u2211 t \u03c6\u03c1(st) = 1 resulting in an extension of the previously applied d\u00b5 estimation (step 5 in COP-TD(0, \u03b2)). We provide the full details in Algorithm 2, which also incorporates non-zero \u03bb ( similarly to ETD(\u03bb,\u03b2) ) .\nAlgorithm 2 COP-TD(\u03bb,\u03b2) with Function Approximation, Input: \u03b80, \u03b8\u03c1,0\n1: Init: F0 = 0, n \u03b2 0 = 1, N\u03c6 = 0, e0 = 0 2: for t = 1, 2, ... do 3: Observe st, at, rt, st+1 4: Update normalization terms: 5: n\u03b2t = \u03b2n \u03b2 t + 1, N\u03c6 = N\u03c6 + \u03c6\u03c1(st), d\u0302\u03c6\u03c1 = N\u03c6 t 6: Update \u0393nt \u2019s weighted average: 7: Ft = \u03c1t\u22121(\u03b2Ft\u22121 + \u03c6\u03c1(st\u22121)) 8: Update & project by \u03c1d\u2019s TD error: 9: \u03b4dt = \u03b8 > \u03c1,t\u22121 ( Ft n\u03b2t \u2212 \u03c6\u03c1(st)\n) 10: \u03b8\u03c1,t+1 = \u03a0\u2206d\u0302\u03c6\u03c1 ( \u03b8\u03c1,t + \u03b1 d t \u03b4 d t \u03c6\u03c1(st)\n) 11: Off-policy TD(\u03bb): 12: Mt = \u03bb+ (1\u2212 \u03bb)\u03b8>\u03c1,t+1\u03c6\u03c1(st) 13: et = \u03c1t (\u03bb\u03b3et +Mt\u03c6(st+1)) 14: \u03b4t = rt + \u03b8>t (\u03b3\u03c6(st+1)\u2212 \u03c6(st)) 15: \u03b8t+1 = \u03b8t + \u03b1t\u03b4tet 16: end for\nTheorem 2. If the step sizes satisfy \u2211 t \u03b1t = \u2211 t \u03b1 d t =\n\u221e, \u2211 t(\u03b1 2 t + (\u03b1 d t )\n2) < \u221e, \u03b1t \u03b1dt \u2192 0, t\u03b1dt \u2192 0, and E [ (\u03b2n\u0393nt ) 2|st ] \u2264 C for some constant C and every t, n,\nthen after applying COP-TD(0, \u03b2) with function approximation satisfying \u03c6\u03c1(s) \u2208 Rk+, \u03c1\u0302d,t converges to the fixed point of \u03a0\u2206E\u00b5[\u03c6\u03c1]\u03a0\u03c6\u03c1Y\n\u03b2 denoted by \u03c1COPd almost surely, and if \u03b8t converges it is to the fixed point of \u03a0d\u00b5\u25e6\u03c1COPd T\u03c0V , where \u25e6 is a coordinate-wise product of vectors.\nThe proof is given in the appendix and also follows the ODE method. Notice that a theorem is only given for \u03bb = 0, convergence results for general \u03bb should follow the work by Yu (2015).\nA possible criticism on COP-TD(0,\u03b2) is that it is not actually consistent, since in order to be consistent the original state space has to be small, in which case every off-policy algorithm is consistent as well. Still, the dependence on another set of features allows to trade-off accuracy with computational power in estimating \u03c1d and subsequently V . Moreover, smart feature selection may further reduce this gap, and COP-TD(0, \u03b2) is still the first algorithm addressing this issue. We conclude with linking the error in \u03c1d\u2019s estimate with the difference in the resulting \u03b8, which suggests that a well estimated \u03c1d results in consistency: Corollary 1. Let 0 < < 1. If (1 \u2212 )\u03c1d \u2264 \u03c1COPd \u2264 (1 + )\u03c1d, then the fixed point of COP-TD(0,\u03b2) with function approximation \u03b8COP satisfies the following, where \u2016 \u00b7 \u2016\u221e is the L\u221e induced norm:\n\u2016\u03b8\u2217 \u2212 \u03b8COP\u2016\u221e \u2264 \u2016A\u22121\u03c0 \u03a6>\u2016\u221e ( Rmax + (1 + \u03b3)\u2016\u03a6\u2016\u221e\u2016\u03b8COP\u2016\u221e ) ,\nwhereA\u03c0 = \u03a6>D\u03c0(I\u2212\u03b3P\u03c0)\u03a6, and \u03b8\u2217 sets the fixed point of the operator \u03a0d\u03c0T\u03c0V ."}, {"heading": "5.1. Relation to ETD(\u03bb, \u03b2)", "text": "Recently, Sutton et al. (2015) had suggested an algorithm for off-policy evaluation called Emphatic TD. Their algorithm was later on extended by Hallak et al. (2015) and renamed ETD(\u03bb, \u03b2), which was shown to perform extremely well empirically by White and White (2016). ETD(0, \u03b2) can be represented as:\nFt = (1\u2212 \u03b2) \u221e\u2211 n=0 \u03b2n\u0393nt ,\n\u03b8t+1 = \u03b8t + \u03b1tFt\u03c1t ( rt + \u03b8 > t (\u03b3\u03c6(st+1)\u2212 \u03c6(st)) ) . (4)\nAs mentioned before, ETD(\u03bb, \u03b2) converges to the fixed point of \u03a0fT\u03bb\u03c0 (Yu, 2015), where f = E [Ft|st] = (I \u2212 \u03b2P\u03c0)\n\u22121d\u00b5. Error bounds can be achieved by showing that the operator \u03a0fT\u03bb\u03c0 is a contraction under certain requirements on \u03b2 and that the variance of Ft is directly related to \u03b2 as well (Hallak et al., 2015) (and thus affects the convergence rate of the process).\nWhen comparing ETD(\u03bb,\u03b2)\u2019s form to COP-TD(\u03bb,\u03b2)\u2019s, instead of spending memory and time resources on a\nstate/feature-dependent Ft, ETD(\u03bb,\u03b2) uses a one-variable approximation. The resulting Ft is in fact a one-step estimate of \u03c1d, starting from \u03c1\u0302d(s) \u2261 1 (see Equations 9, 4), up to a minor difference: F ETDt = \u03b2F COP-TD t + 1 (which following our logic adds bias to the estimate 2).\nUnlike ETD(\u03bb, \u03b2), COP-TD(\u03bb,\u03b2)\u2019s effectiveness depends on the available resources. The number of features \u03c6\u03c1(s) can be adjusted accordingly to provide the most affordable approximation. The added cost is fine-tuning another stepsize, though \u03b2\u2019s effect is less prominent."}, {"heading": "6. The Logarithm Approach for Handling Long Products", "text": "We now present a heuristic algorithm which works similarly to COP-TD(\u03bb, \u03b2). Before presenting the algorithm, we explain the motivation behind it."}, {"heading": "6.1. Statistical Interpretation of TD(\u03bb)", "text": "Konidaris et al. (2011) suggested a statistical interpretation of TD(\u03bb). They show that under several assumptions the TD(\u03bb) estimate R\u03bbst is the maximum likelihood estimator of V (st) given Rnst : (1) Each R n st is an unbiased estimator of V (st); (2) The random variables Rnst are independent and specifically uncorrelated; (3) The random variables Rnst are jointly normally distributed; and (4) The variance of each Rnst is proportional to \u03bb n.\nUnder Assumptions 1-3 the maximum likelihood estimator of V (s) given its previous estimate can be represented as a linear convex combination of Rnst with weights:\nwn =\n[ Var ( R (n) st )]\u22121 \u2211\u221e m=0 [ Var ( R (m) st\n)]\u22121 . Subsequently, in Konidaris et al. (2011) Assumption 4 was relaxed and instead a closed form approximation of the variance was proposed. In a follow-up paper by Thomas et al. (2015b), the second assumption was also removed and the weights were instead given as: wn = 1>cov(Rst )en 1>cov(Rst )1\n, where the covariance matrix can be estimated from the data, or otherwise learned through some parametric form.\nWhile both the approximated variance and learned covariance matrix solutions improve performance on several benchmarks, the first uses a rather crude approximation, and the second solution is both state-dependent and based on noisy estimates of the covariance matrix. In addition, there aren\u2019t efficient on-line implementations since all past\n2We have conducted several experiments with an altered ETD and indeed obtained better results compared with the original, these experiments are outside the scope of the paper.\nweights should be recalculated to match a new sample. Still, the suggested statistical justification is a valuable tool in assessing the similar role of \u03b2 in ETD(\u03bb, \u03b2)."}, {"heading": "6.2. Variance Weighted \u0393nt", "text": "As was shown by Konidaris et al. (2011), we can use statedependent weights instead of \u03b2 exponents to obtain better estimates. The second moments are given explicitly as\nfollows3: E [ (\u0393nt ) 2 |st ] = d>\u00b5 P\u0303 n\u22121est d\u00b5(st) , where [ P\u0303 ] s,s\u2032\n=\u2211 a\u2208A \u03c02(a|s) \u00b5(a|s) P (s \u2032|s, a).\nThese can be estimated for each state separately. Notice that the variances increase exponentially depending on the largest eigenvalue of P\u0303 (as Assumption 4 dictates), but this is merely an asymptotic behavior and may be relevant only when the weights are already negligible. Hence, implementing this solution on-line should not be a problem with the varying weights, as generally only the first few of these are non-zero. While this solution is impractical in problems with large state spaces parameterizing or approximating these variances (similarly to Thomas et al. (2015b)) could improve performance in specific applications."}, {"heading": "6.3. Log-COP-TD(\u03bb, \u03b2)", "text": "Assumption 3 in the previous section is that the sampled estimators (R(n),\u0393nt ) are normally distributed. For on policy TD(\u03bb), this assumption might seem not too harsh as the estimators R(n) represent growing sums of random variables. However, in our case the estimators \u0393nt are growing products of random variables. To correct this issue we can define new estimators using a logarithm on each \u0393\u0303nt :\nlog [\u03c1d(st)] = log\n[ E [ \u03c1\u0302d(st\u2212m)\nt\u22121\u220f k=t\u2212m\n\u03c1k \u2223\u2223 st]]\n\u2248 log [\u03c1\u0302d(st\u2212m)] + t\u22121\u2211\nk=t\u2212m\nE [log [\u03c1k] |st] .\n(5)\nThis approximation is crude \u2013 we could add terms reducing the error through Taylor expansion, but these would be complicated to deal with. Hence, we can relate to this method mainly as a well-motivated heuristic.\nNotice that this formulation resembles the standard MDP formulation, only with the corresponding \u201dreward\u201d terms log[\u03c1t] going backward instead of forward, and no discount factor. Unfortunately, without a discount factor we\n3The covariances can be expressed analytically as well, for clarity we drop this immediate result.\ncannot expect the estimated value to converge, so we propose using an artificial one \u03b3log. We can incorporate function approximation for this formulation as well. Unlike COP-TD(\u03bb, \u03b2), we can choose the features and weights as we wish with no restriction, besides the linear constraint on the resulting \u03c1d through the weight vector \u03b8\u03c1. This can be approximately enforced by normalizing \u03b8\u03c1 using X t . = 1t \u2211 t exp(\u03b8 > \u03c1,t\u03c6(st)) (which should equal 1 if we were exactly correct). We call the resulting algorithm LogCOP-TD(\u03bb,\u03b2).\nAlgorithm 3 Log-COP-TD(\u03bb,\u03b2) with Function Approximation, Input: \u03b80,\u03b8\u03c1,0\n1: Init: F0 = 0, n0(\u03b2) = 1, N(s) = 0 2: for t = 1, 2, ... do 3: Observe st, at, rt, st+1 4: Update normalization terms: 5: n\u03b2t = \u03b2n \u03b2 t + 1, N\u03c6 = \u03b3log(\u03b2N\u03c6 +\n\u03c6\u03c1(st)), X = X + exp(\u03b8 > \u03c1,t\u03c6(st))\n6: Update log(\u0393nt )\u2019s weighted average: 7: Ft = \u03b2\u03b3logFt\u22121 + n \u03b2 t log[\u03c1(st\u22121)] 8: Update & project by log(\u03c1d)\u2019s TD error: 9: \u03b4dt =\nFt n\u03b2t + \u03b8>\u03c1,t\n( N\u03c6\nn\u03b2t \u2212 \u03c6\u03c1(st) ) 10: \u03b8\u03c1,t+1 = \u03b8\u03c1,t + \u03b1dt \u03b4 d t \u03c6\u03c1(st) 11: Off-policy TD(\u03bb): 12: Mt = \u03bb+ (1\u2212 \u03bb) exp ( \u03b8>\u03c1,t+1\u03c6\u03c1(st) ) /(X/t)"}, {"heading": "13: et = \u03c1t (\u03bb\u03b3et +Mt\u03c6(st+1))", "text": ""}, {"heading": "14: \u03b4t = rt + \u03b8>t (\u03b3\u03c6(st+1)\u2212 \u03c6(st))", "text": "15: \u03b8t+1 = \u03b8t + \u03b1t\u03b4tet 16: end for"}, {"heading": "6.4. Using the Original Features", "text": "An interesting phenomenon occurs when the behavior and target policies employ a feature based Boltzmann distribution for choosing the actions: \u00b5(a|s) = exp ( \u03b8>a,\u00b5\u03c6(s) ) ,\nand \u03c0(a|s) = exp ( \u03b8>a,\u03c0\u03c6(s) ) , where a constant feature is added to remove the (possibly different) normalizing constant. Thus, log(\u03c1t) = (\u03b8a,\u03c0 \u2212 \u03b8a,\u00b5)>\u03c6(st), and LogCOP-TD(\u03bb,\u03b2) obtains a parametric form that depends on the original features instead of a different set."}, {"heading": "6.5. Approximation Hardness", "text": "As we propose to use linear function approximation for \u03c1d(s) and log (\u03c1d(s)) one cannot help but wonder how hard it is to approximate these quantities, especially compared to the value function. The comparison between V (s) and \u03c1d(s) is problematic for several reasons:\n1. The ultimate goal is estimating V \u03c0(s), approximation errors in \u03c1d(s) are second order terms.\n2. The value function V \u03c0(s) depends on the policy-\ninduced reward function and transition probability matrix, while \u03c1d(s) depends on the stationary distributions induced by both policies. Since each depends on at least one distinct factor - we can expect different setups to result in varied approximation hardness. For example, if the reward function has a poor approximation then so will V \u03c0(s), while extremely different behavior and target policies can cause \u03c1d(s) to behave erratically.\n3. Subsequently, the choice of features for approximating V \u03c0(s) and \u03c1d(s) can differ significantly depending on the problem at hand.\nIf we would still like to compare V \u03c0(s) and \u03c1d(s), we could think of extreme examples:\n\u2022 When \u03c0 = \u00b5, \u03c1d(s) \u2261 1, when R(s) \u2261 0 then V \u03c0(s) \u2261 0.\n\u2022 In the chain MDP example in Section 4 we saw that \u03c1d(s) is an exponential function of the location in the chain. Setting reward in one end to 1 will result in an exponential form for V \u03c0(s) as well. Subsequently, in the chain MDP example approximating log (\u03c1d(s)) is easier than \u03c1d(s) as we obtain a linear function of the position; This is not the general case."}, {"heading": "7. Experiments", "text": "We have performed 3 types of experiments. Our first batch of experiments (Figure 1) demonstrates the accuracy of predicting \u03c1d by both COP-TD(\u03bb, \u03b2) and Log-COP-TD(\u03bb, \u03b2). We show two types of setups in which visualization of \u03c1d is relatively clear - the chain MDP example mentioned in Section 4 and the mountain car domain (Sutton and Barto, 1998) in which the state is determined by only two continuous variables - the car\u2019s position and speed. The parameters \u03bb and \u03b2 exhibited low sensitivity in these tasks so they were simply set to 0, we show the estimated \u03c1d after 106 iterations. For the chain MDP (top two plots, notice the logarithmic scale) we first approximate \u03c1d without any function approximation (top-left) and we can see COP-TD manages to converge to the correct value while Log-COPTD is much less exact. When we use linear feature space (constant parameter and position) Log-COP-TD captures the true behavior of \u03c1d much better as expected. The two lower plots show the error (in color) in \u03c1d estimated for the mountain car with a pure exploration behavior policy vs. a target policy oriented at moving right. The z-axis is the same for both plots and it describes a much more accurate estimate of \u03c1d obtained through simulations. The features used were local state aggregation. We can see that both algorithms succeed similarly on the position-speed pairs which are sampled often due to the behavior policy and the\nmountain. When looking at more rarely observed states, the estimate becomes worse for both algorithms, though Log-COP-TD seems to be better performing on the spike at position > 0.\nNext we test the sensitivity of COP-TD(\u03bb, \u03b2) and LogCOP-TD(\u03bb,\u03b2) to the parameters \u03b2 and \u03b3log (Figure 2) on two distinct toy examples - the chain MDP introduced before but with only 30 states with the position-linear features, and a random MDP with 32 states, 2 actions and a 5-bit binary feature vector along with a free parameter (this compact representation was suggested by White and White (2016) to approximate real world problems). The policies on the chain MDP were taken as described before, and on the random MDP a state independent 0.75/0.25 probability to choose an action by the behavior/target policy. As we can see, larger values of \u03b2 cause noisier estimations in the random MDP for COP-TD(\u03bb, \u03b2), but has little effect in other venues. As for \u03b3log - we can see that if it is too large or too small the error behaves sub-optimally, as expected for the crude approximation of Equation 5. In conclusion, unlike ETD(\u03bb, \u03b2), Log/COP-TD(\u03bb, \u03b2) are much less effected by \u03b2, though \u03b3log should be tuned to improve results.\nOur final experiment (Figure 3) compares our algorithms to ETD(\u03bb, \u03b2) and GTD(\u03bb, \u03b2) over 4 setups: chain MDP with 100 states with right half rewards 1 with linear features, a 2 action random MDP with 256 states and binary features, acrobot (3 actions) and cart-pole balancing (21 actions) (Sutton and Barto, 1998) with reset at success and state aggregation to 100 states. In all problems we used the same features for \u03c1d and V \u03c0(s) estimation, \u03b3 = 0.99, constant step size 0.05 for the TD process and results were averaged over 10 trajectories, other parameters (\u03bb, \u03b2, other step sizes, \u03b3log) were swiped over to find the best ones. To\nreduce figure clutter we have not included standard deviations though the noisy averages still reflect the variance in the process. Our method of comparison on the first 2 setups estimates the value function using the suggested algorithm, and finds the d\u03c0 weighted average of the error between V and the on-policy fixed point \u03a0\u03c0TV\u03c0:\n\u2016V\u0302 \u2212\u03a0\u03c0TV\u03c0\u20162d\u03c0 = \u2211 s d\u03c0(s) [ (\u03b8\u2217 \u2212 \u03b8\u0302)>\u03c6(s) ]2 ,\nwhere \u03b8\u2217 is the optimal \u03b8 obtained by on-policy TD using the target policy. On the latter continuous state problems we applied on-line TD on a different trajectory following the target policy, used the resulting \u03b8 value as ground truth and taken the sum of squared errors with respect to it. The behavior and target policies for the chain MDP and random MDP are as specified before. For the acrobot problem the behavior policy is uniform over the 3 actions and the target policy chooses between these with probabilities ( 16 , 1 3 , 1 2 ). For the cart-pole the action space is divided to 21 actions from -1 to 1 equally, the behavior policy chooses among these uniformly while the target policy is 1.5 times more prone to choosing a positive action than a negative one.\nThe experiments show that COP-TD(\u03bb, \u03b2) and Log-COPTD(\u03bb, \u03b2) have comparable performance to ETD(\u03bb, \u03b2) where at least one is better in every setup. The advantage in the new algorithms is especially seen in the chain MDP corresponding to a large discrepancy between the stationary distribution of the behavior and target policy. GTD(\u03bb) is consistently worse on the tested setups, this might be due to the large difference between the chosen behavior and target policies which affects GTD(\u03bb) the most."}, {"heading": "8. Conclusion", "text": "Research on off-policy evaluation has flourished in the last decade. While a plethora of algorithms were suggested so far, ETD(\u03bb, \u03b2) by Hallak et al. (2015) has perhaps the simplest formulation and theoretical properties. Unfortunately, ETD(\u03bb, \u03b2) does not converge to the same point achieved by on-line TD when linear function approximation is applied.\nWe address this issue with COP-TD(\u03bb,\u03b2) and proved it can achieve consistency when used with a correct set of features, or at least allow trading-off some of the bias by adding or removing features. Despite requiring a new set of features and calibrating an additional update function, COP-TD(\u03bb,\u03b2)\u2019s performance does not depend as much on \u03b2 as ETD(\u03bb,\u03b2), and shows promising empirical results.\nWe offer a connection to the statistical interpretation of TD(\u03bb) that motivates our entire formulation. This interpretation leads to two additional approaches: (a) weight the \u0393nt using estimated variances instead of \u03b2 exponents and (b) approximating log[\u03c1d] instead of \u03c1d; both approaches deserve consideration when facing a real application."}, {"heading": "9. Acknowledgments", "text": "This Research was supported in part by the Israel Science Foundation (grant No. 920/12) and by the European Research Council under the European Union\u2019s Seventh Framework Programme (FP/2007-2013)/ ERC Grant Agreement n.306638."}], "year": 2017, "references": [{"title": "Application of reinforcement learning to routing in distributed wireless networks: a review", "authors": ["Hasan AA Al-Rawi", "Ming Ann Ng", "Kok-Lim Alvin Yau"], "venue": "Artificial Intelligence Review,", "year": 2015}, {"title": "Applying reinforcement learning towards automating resource allocation and application scalability in the cloud", "authors": ["Enda Barrett", "Enda Howley", "Jim Duggan"], "venue": "Concurrency and Computation: Practice and Experience,", "year": 2013}, {"title": "Dynamic Programming and Optimal Control, Vol II", "authors": ["D. Bertsekas"], "venue": "Athena Scientific,", "year": 2012}, {"title": "Projected equation methods for approximate solution of large linear systems", "authors": ["D. Bertsekas", "H. Yu"], "venue": "Journal of Computational and Applied Mathematics,", "year": 2009}, {"title": "Adaptive feature pursuit: Online adaptation of features in reinforcement learning. Reinforcement Learning and Approximate Dynamic Programming for Feedback Control, pages", "authors": ["Shalabh Bhatnagar", "Vivek S Borkar", "LA Prashanth"], "year": 2012}, {"title": "Feature search in the grassmanian in online reinforcement learning", "authors": ["Shalabh Bhatnagar", "Vivek S Borkar", "KJ Prabuchandran"], "venue": "IEEE Journal of Selected Topics in Signal Processing,", "year": 2013}, {"title": "Construction of approximation spaces for reinforcement learning", "authors": ["Wendelin B\u00f6hmer", "Steffen Gr\u00fcnew\u00e4lder", "Yun Shen", "Marek Musial", "Klaus Obermayer"], "venue": "Journal of Machine Learning Research,", "year": 2013}, {"title": "Least-squares temporal difference learning", "authors": ["Justin A Boyan"], "venue": "In ICML, pages", "year": 1999}, {"title": "Linear least-squares algorithms for temporal difference learning", "authors": ["Steven J Bradtke", "Andrew G Barto"], "venue": "Machine learning,", "year": 1996}, {"title": "Projection onto a simplex", "authors": ["Yunmei Chen", "Xiaojing Ye"], "venue": "arXiv preprint arXiv:1101.6081,", "year": 2011}, {"title": "Policy evaluation with temporal differences: a survey and comparison", "authors": ["Christoph Dann", "Gerhard Neumann", "Jan Peters"], "venue": "Journal of Machine Learning Research,", "year": 2014}, {"title": "Adaptive bases for reinforcement learning", "authors": ["Dotan Di Castro", "Shie Mannor"], "venue": "Machine Learning and Knowledge Discovery in Databases,", "year": 2010}, {"title": "Regularized policy iteration", "authors": ["Amir M Farahmand", "Mohammad Ghavamzadeh", "Shie Mannor", "Csaba Szepesv\u00e1ri"], "venue": "In Advances in Neural Information Processing Systems,", "year": 2009}, {"title": "Incremental truncated lstd", "authors": ["Clement Gehring", "Yangchen Pan", "Martha White"], "venue": "arXiv preprint arXiv:1511.08495,", "year": 2015}, {"title": "l1-penalized projected bellman residual", "authors": ["Matthieu Geist", "Bruno Scherrer"], "venue": "In European Workshop on Reinforcement Learning,", "year": 2011}, {"title": "Off-policy learning with eligibility traces: A survey", "authors": ["Matthieu Geist", "Bruno Scherrer"], "venue": "The Journal of Machine Learning Research,", "year": 2014}, {"title": "A dantzig selector approach to temporal difference learning", "authors": ["Matthieu Geist", "Bruno Scherrer", "Alessandro Lazaric", "Mohammad Ghavamzadeh"], "venue": "arXiv preprint arXiv:1206.6480,", "year": 2012}, {"title": "Lstd with random projections", "authors": ["Mohammad Ghavamzadeh", "Alessandro Lazaric", "Odalric Maillard", "R\u00e9mi Munos"], "venue": "In Advances in Neural Information Processing Systems,", "year": 2010}, {"title": "Basis expansion in natural actor critic methods", "authors": ["Sertan Girgin", "Philippe Preux"], "venue": "In European Workshop on Reinforcement Learning,", "year": 2008}, {"title": "Off-policy temporal difference learning with distribution adaptation in fast mixing chains", "authors": ["Arash Givchi", "Maziar Palhang"], "venue": "Soft Computing,", "year": 2017}, {"title": "Feature selection for reinforcement learning: Evaluating implicit state-reward dependency via conditional mutual information", "authors": ["Hirotaka Hachiya", "Masashi Sugiyama"], "venue": "Machine Learning and Knowledge Discovery in Databases,", "year": 2010}, {"title": "Importance-weighted least-squares probabilistic classifier for covariate shift adaptation with application to human activity", "authors": ["Hirotaka Hachiya", "Masashi Sugiyama", "Naonori Ueda"], "venue": "recognition. Neurocomputing,", "year": 2012}, {"title": "Generalized emphatic temporal difference learning: Bias-variance analysis", "authors": ["Assaf Hallak", "Aviv Tamar", "Remi Munos", "Shie Mannor"], "venue": "arXiv preprint arXiv:1509.05172,", "year": 2015}, {"title": "Regularized least squares temporal difference learning with nested l2 and l1 penalization", "authors": ["Matthew W Hoffman", "Alessandro Lazaric", "Mohammad Ghavamzadeh", "R\u00e9mi Munos"], "venue": "In European Workshop on Reinforcement Learning,", "year": 2011}, {"title": "Constructing basis functions from directed graphs for value function approximation", "authors": ["Jeff Johns", "Sridhar Mahadevan"], "venue": "In Proceedings of the 24th international conference on Machine learning,", "year": 2007}, {"title": "Linear complementarity for regularized policy evaluation and improvement", "authors": ["Jeffrey Johns", "Christopher Painter-Wakefield", "Ronald Parr"], "venue": "In Advances in neural information processing systems,", "year": 2010}, {"title": "A least-squares approach to direct importance estimation", "authors": ["Takafumi Kanamori", "Shohei Hido", "Masashi Sugiyama"], "venue": "Journal of Machine Learning Research,", "year": 2009}, {"title": "Reinforcement learning in robotics: A survey", "authors": ["Jens Kober", "J Andrew Bagnell", "Jan Peters"], "venue": "The International Journal of Robotics Research,", "year": 2013}, {"title": "The fixed points of off-policy TD", "authors": ["J Zico Kolter"], "venue": "In NIPS,", "year": 2011}, {"title": "Regularization and feature selection in least-squares temporal difference learning", "authors": ["J Zico Kolter", "Andrew Y Ng"], "venue": "In Proceedings of the 26th annual international conference on machine learning,", "year": 2009}, {"title": "Td-gamma: Re-evaluating complex backups in temporal difference learning", "authors": ["George Konidaris", "Scott Niekum", "Philip S Thomas"], "venue": "In Advances in Neural Information Processing Systems", "year": 2011}, {"title": "Automatic feature selection for model-based reinforcement learning in factored mdps", "authors": ["Mark Kroon", "Shimon Whiteson"], "venue": "In Machine Learning and Applications,", "year": 2009}, {"title": "Stochastic approximation and recursive algorithms and applications, volume 35", "authors": ["Harold Kushner", "G George Yin"], "venue": "Springer Science & Business Media,", "year": 2003}, {"title": "Regularized offpolicy td-learning", "authors": ["Bo Liu", "Sridhar Mahadevan", "Ji Liu"], "venue": "In Advances in Neural Information Processing Systems,", "year": 2012}, {"title": "Feature selection and feature learning for high-dimensional batch reinforcement learning: a survey", "authors": ["De-Rong Liu", "Hong-Liang Li", "Ding Wang"], "venue": "International Journal of Automation and Computing,", "year": 2015}, {"title": "Sparse temporal difference learning using lasso", "authors": ["Manuel Loth", "Manuel Davy", "Philippe Preux"], "venue": "In Approximate Dynamic Programming and Reinforcement Learning,", "year": 2007}, {"title": "Samuel meets amarel: Automating value function approximation using global state space analysis", "authors": ["Sridhar Mahadevan"], "venue": "In AAAI,", "year": 2005}, {"title": "Sparse q-learning with mirror descent", "authors": ["Sridhar Mahadevan", "Bo Liu"], "venue": "arXiv preprint arXiv:1210.4893,", "year": 2012}, {"title": "Proto-value functions: A laplacian framework for learning representation and control in markov decision processes", "authors": ["Sridhar Mahadevan", "Mauro Maggioni"], "venue": "Journal of Machine Learning Research,", "year": 2007}, {"title": "Off-policy learning based on weighted importance sampling with linear computational complexity", "authors": ["A Rupam Mahmood", "Richard S Sutton"], "venue": "In Conference on Uncertainty in Artificial Intelligence,", "year": 2015}, {"title": "Weighted importance sampling for off-policy learning with linear function approximation", "authors": ["A Rupam Mahmood", "Hado P van Hasselt", "Richard S Sutton"], "venue": "In Advances in Neural Information Processing Systems,", "year": 2014}, {"title": "Basis function adaptation in temporal difference reinforcement learning", "authors": ["Ishai Menache", "Shie Mannor", "Nahum Shimkin"], "venue": "Annals of Operations Research,", "year": 2005}, {"title": "Human-level control through deep reinforcement learning", "authors": ["Volodymyr Mnih", "Koray Kavukcuoglu", "David Silver", "Andrei A Rusu", "Joel Veness", "Marc G Bellemare", "Alex Graves", "Martin Riedmiller", "Andreas K Fidjeland", "Georg Ostrovski"], "venue": "Nature, 518(7540):529\u2013533,", "year": 2015}, {"title": "Greedy algorithms for sparse reinforcement learning", "authors": ["Christopher Painter-Wakefield", "Ronald Parr"], "venue": "arXiv preprint arXiv:1206.6485,", "year": 2012}, {"title": "An analysis of laplacian methods for value function approximation in mdps", "authors": ["Marek Petrik"], "venue": "In IJCAI,", "year": 2007}, {"title": "Feature selection using regularization in approximate linear programs for markov decision processes", "authors": ["Marek Petrik", "Gavin Taylor", "Ron Parr", "Shlomo Zilberstein"], "venue": "arXiv preprint arXiv:1005.1860,", "year": 2010}, {"title": "Off-policy temporal-difference learning with function approximation", "authors": ["Doina Precup", "Richard S Sutton", "Sanjoy Dasgupta"], "venue": "In ICML,", "year": 2001}, {"title": "Sparse reinforcement learning via convex optimization", "authors": ["Zhiwei Qin", "Weichang Li", "Firdaus Janoos"], "venue": "In Proceedings of the 31st International Conference on Machine Learning", "year": 2014}, {"title": "Stochastic approximation: A dynamical systems viewpoint", "authors": ["Zeev Schuss", "Vivek S Borkar"], "year": 2009}, {"title": "Explicit manifold representations for value-function approximation in reinforcement learning", "authors": ["William D Smart"], "venue": "ISAIM,", "year": 2004}, {"title": "Incremental basis construction from temporal difference error", "authors": ["Yi Sun", "Mark Ring", "J\u00fcrgen Schmidhuber", "Faustino J Gomez"], "venue": "In Proceedings of the 28th International Conference on Machine Learning", "year": 2011}, {"title": "Reinforcement learning: An introduction", "authors": ["R.S. Sutton", "A. Barto"], "year": 1998}, {"title": "An emphatic approach to the problem of off-policy temporaldifference learning", "authors": ["R.S. Sutton", "A.R. Mahmood", "M White"], "year": 2015}, {"title": "A new q (lambda) with interim forward view and monte carlo equivalence", "authors": ["Rich Sutton", "Ashique R Mahmood", "Doina Precup", "Hado V Hasselt"], "venue": "In Proceedings of the 31st International Conference on Machine Learning", "year": 2014}, {"title": "Learning to predict by the methods of temporal differences", "authors": ["Richard S Sutton"], "venue": "Machine learning,", "year": 1988}, {"title": "A convergent o(n) temporal-difference algorithm for off-policy learning with linear function approximation", "authors": ["Richard S Sutton", "Hamid R Maei", "Csaba Szepesv\u00e1ri"], "venue": "In Advances in neural information processing systems,", "year": 2009}, {"title": "Lifetime value marketing using reinforcement learning", "authors": ["Georgios Theocharous", "Assaf Hallak"], "venue": "RLDM", "year": 2013}, {"title": "Personalized ad recommendation systems for life-time value optimization with guarantees", "authors": ["Georgios Theocharous", "Philip S Thomas", "Mohammad Ghavamzadeh"], "venue": "In Proceedings of the Twenty-Fourth International Joint Conference on Artificial Intelligence", "year": 2015}, {"title": "High confidence policy improvement", "authors": ["Philip Thomas", "Georgios Theocharous", "Mohammad Ghavamzadeh"], "venue": "In Proceedings of the 32nd International Conference on Machine Learning", "year": 2015}, {"title": "Policy evaluation using the omega-return", "authors": ["Philip S Thomas", "Scott Niekum", "Georgios Theocharous", "George Konidaris"], "venue": "In Advances in Neural Information Processing Systems", "year": 2015}, {"title": "An analysis of temporal-difference learning with function approximation", "authors": ["John N Tsitsiklis", "Benjamin Van Roy"], "venue": "Automatic Control, IEEE Transactions on,", "year": 1997}, {"title": "Off-policy td (\u03bb) with a true online equivalence", "authors": ["Hado van Hasselt", "A Rupam Mahmood", "Richard S Sutton"], "venue": "In Proceedings of the 30th Conference on Uncertainty in Artificial Intelligence, Quebec City,", "year": 2014}, {"title": "A novel approach for constructing basis functions in approximate dynamic programming for feedback control", "authors": ["Jian Wang", "Zhenhua Huang", "Xin Xu"], "venue": "In Adaptive Dynamic Programming And Reinforcement Learning (ADPRL),", "year": 2013}, {"title": "Investigating practical, linear temporal difference learning", "authors": ["Adam White", "Martha White"], "venue": "arXiv preprint arXiv:1602.08771,", "year": 2016}, {"title": "Regularized feature selection in reinforcement learning", "authors": ["Dean S Wookey", "George D Konidaris"], "venue": "Machine Learning,", "year": 2015}, {"title": "Representation discovery using a fixed basis in reinforcement learning", "authors": ["Dean Stephen Wookey"], "venue": "PhD thesis, University of the Witwatersrand South Africa,", "year": 2016}, {"title": "On convergence of emphatic temporal-difference learning", "authors": ["H. Yu"], "venue": "In COLT,", "year": 2015}, {"title": "Convergence of least squares temporal difference methods under general conditions", "authors": ["Huizhen Yu"], "venue": "In Proceedings of the 27th International Conference on Machine Learning", "year": 2010}, {"title": "Graying the black box: Understanding dqns", "authors": ["Tom Zahavy", "Nir Ben-Zrihem", "Shie Mannor"], "venue": "arXiv preprint arXiv:1602.02658,", "year": 2016}], "id": "SP:affdeb920a9c60e1586d55e40bcbc0e4be49fc4f", "authors": [{"name": "Assaf Hallak", "affiliations": []}, {"name": "Shie Mannor", "affiliations": []}], "abstractText": "The problem of on-line off-policy evaluation (OPE) has been actively studied in the last decade due to its importance both as a stand-alone problem and as a module in a policy improvement scheme. However, most Temporal Difference (TD) based solutions ignore the discrepancy between the stationary distribution of the behavior and target policies and its effect on the convergence limit when function approximation is applied. In this paper we propose the Consistent Off-Policy Temporal Difference (COP-TD(\u03bb, \u03b2)) algorithm that addresses this issue and reduces this bias at some computational expense. We show that COP-TD(\u03bb, \u03b2) can be designed to converge to the same value that would have been obtained by using on-policy TD(\u03bb) with the target policy. Subsequently, the proposed scheme leads to a related and promising heuristic we call logCOP-TD(\u03bb, \u03b2). Both algorithms have favorable empirical results to the current state of the art online OPE algorithms. Finally, our formulation sheds some new light on the recently proposed Emphatic TD learning.", "title": "Consistent On-Line Off-Policy Evaluation"}