0	40	Hamiltonian Monte Carlo is a powerful sampling algorithm which has been shown to outperform many existing MCMC algorithms, especially in problems with highdimensional and correlated distributions (Duane et al., 1987; Neal, 2011).
1	38	The algorithm mimics the movement of a body balancing potential and kinetic energy by extending the state space to include auxiliary momentum variables and using Hamiltonian dynamics.
2	17	By traversing long isoprobability contours in this extended state space, HMC is able to move long distances in state space in a single update step, and thus has proved to be more effective than standard MCMC methods in a variety of applications.
3	35	The method has gained a lot of interest from the scientific community and since then has been extended to tackle the problem of sampling on various geometric structures such as constrained spaces (Lan et al., 2014; Brubaker et al., 2012; Hartmann and Schütte, 2005), on general Hilbert space (Beskos et al., 2011) and on Riemannian manifolds (Girolami and Calderhead, 2011; Wang et al., 2013).
6	6	In its statistical formulation it is an inference problem on hypotheses of shared history based on observed heritable traits under a model of evolution.
7	34	Phylogenetics is an essential tool for understanding biological systems and is an important discipline of computational biology.
8	3	The Bayesian paradigm is now commonly used to assess support for inferred tree structures or to test hypotheses that can be expressed in phylogenetic terms (Huelsenbeck et al., 2001).
9	1	Although the last several decades have seen an explosion of advanced methods for sampling from Bayesian posterior distributions, including HMC, phylogenetics still uses relatively classical Markov chain Monte Carlo (MCMC) based methods.
11	45	Also, to represent the phylogenetic relation among a fixed number of species, one needs to specify both the tree topology (a discrete object) and the branch lengths (continuous distances).
20	23	In fact, there is no general notion of differentiability of the posterior function on the whole tree space and any scheme to approximate Hamiltonian dynamics needs to take this issue into account.
22	5	After reviewing how the ensemble of phylogenetic trees is naturally described as a geometric structure we identify as an orthant complex (Billera et al., 2001), we define PPHMC for sampling posteriors on orthant complexes along with a probabilistic version of the leapfrog algorithm.
24	48	We establish that the integrator retains the good theoretical properties of Hamiltonian dynamics in classical settings, namely probabilistic equivalents of time-reversibility, volume preservation, and accessibility, which combined together result in a proof of ergodicity for the resulting Markov chain.
25	2	Although a direct application of the integrator to the phylogenetic posterior does work, we obtain significantly better performance by using a surrogate function near the boundary between topologies to control approximation error.
26	228	This approach also addresses a general problem in using Reflective HMC (RHMC; Afshar and Domke, 2015) for energy functions with discontinuous derivatives (for which the accuracy of RHMC is of order O( ), instead of the standard local error O( 3) of HMC on Rn).
27	69	We provide, validate, and benchmark two independent implementations in open-source software.
28	52	A phylogenetic tree (τ, q) is a tree graph τ with N leaves, each of which has a label, and such that each edge e is associated with a non-negative number qe.
31	3	Any edge incident to a leaf is called a pendant edge, and any other edge is called an internal edge.
33	5	(This lower bound on branch lengths is a technical condition for theoretical development and can be relaxed in practice.)
36	7	Two tree topologies τ1 and τ2 are called adjacent topologies if there exists a single NNI move that transforms τ1 into τ2.
38	9	An orthant of dimension n is simply Rn≥0; each n-dimensional orthant is bounded by a collection of lower dimensional orthant faces.
39	17	An orthant complex is a geometric object X obtained by gluing various orthants of the same dimension n, indexed by a countable set Γ, such that: (i) the intersection of any two orthants is a face of both orthants, and (ii) each x ∈ X belongs to a finite number of orthants.
41	28	Generalizing the definitions from phylogenetics, we refer to τ as its topology and to q as the vector of attributes.
