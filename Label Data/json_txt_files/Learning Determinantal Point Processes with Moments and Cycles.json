{"sections": [{"heading": "1. Introduction", "text": "Determinantal Point Processes (DPPs) are a family of probabilistic models that arose from the study of quantum mechanics (Macchi, 1975) and random matrix theory (Dyson, 1962). Following the seminal work of Kulesza and Taskar (Kulesza & Taskar, 2012), discrete DPPs have found numerous applications in machine learning, including in document and timeline summarization (Lin & Bilmes, 2012; Yao et al., 2016), image search (Kulesza & Taskar, 2011; Affandi et al., 2014) and segmentation (Lee et al., 2016), audio signal processing (Xu & Ou, 2016), bioinformatics (Batmanghelich et al., 2014) and neuroscience (Snoek et al., 2013). What makes such models appealing is that they exhibit repulsive behavior and lend themselves naturally to tasks where returning a diverse set of objects is important.\nOne way to define a DPP is through an N \u00d7 N symmetric positive semidefinite matrix K, called a kernel, whose\n1Department of Mathematics, MIT, USA. Correspondence to: John Urschel <urschel@mit.edu>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\neigenvalues are bounded in the range [0, 1]. Then the DPP associated with K, which we denote by DPP(K), is the distribution on Y \u2286 [N ] = {1, . . . , N} that satisfies, for any J \u2286 [N ],\nP[J \u2286 Y ] = det(KJ),\nwhere KJ is the principal submatrix of K indexed by the set J . The graph induced by K is the graph G = ([N ], E) on the vertex set [N ] that connects i, j \u2208 [N ] if and only if Ki,j 6= 0.\nThere are fast algorithms for sampling (or approximately sampling) from DPP(K) (Deshpande & Rademacher, 2010; Rebeschini & Karbasi, 2015; Li et al., 2016b;a). Marginalizing the distribution on a subset I \u2286 [N ] and conditioning on the event that J \u2286 Y both result in new DPPs and closed form expressions for their kernels are known (Borodin & Rains, 2005).\nThere has been much less work on the problem of learning the parameters of a DPP. A variety of heuristics have been proposed, including Expectation-Maximization (Gillenwater et al., 2014), MCMC (Affandi et al., 2014), and fixed point algorithms (Mariet & Sra, 2015). All of these attempt to solve a nonconvex optimization problem, and no guarantees on their statistical performance are known. Recently, Brunel et al. (Brunel et al., 2017) studied the rate of estimation achieved by the maximum likelihood estimator, but the question of efficient computation remains open.\nApart from positive results on sampling, marginalization and conditioning, most provable results about DPPs are actually negative. It is conjectured that the maximum likelihood estimator is NP-hard to compute (Kulesza, 2012). Actually, approximating the mode of size k of a DPP to within a ck factor is known to be NP-hard for some c > 1 (C\u0327ivril & Magdon-Ismail, 2009; Summa et al., 2015). The best known algorithms currently obtain a ek+o(k) approximation factor (Nikolov, 2015; Nikolov & Singh, 2016).\nIn this work, we bypass the difficulties associated with maximum likelihood estimation by using the method of moments to achieve optimal sample complexity. We introduce a parameter `, which we call the cycle sparsity of the graph induced by the kernelK, which governs the number of moments that need to be considered and, thus, the sample complexity. Moreover, we use a refined version of Horton\u2019s al-\ngorithm (Horton, 1987; Amaldi et al., 2010) to implement the method of moments in polynomial time.\nThe cycle sparsity of a graph is the smallest integer ` so that the cycles of length at most ` yield a basis for the cycle space of the graph. Even though there are in general exponentially many cycles in a graph to consider, Horton\u2019s algorithm constructs a minimum weight cycle basis and, in doing so, also reveals the parameter ` together with a collection of at most ` induced cycles spanning the cycle space.\nWe use such cycles in order to construct our method of moments estimator. For any fixed ` \u2265 2, our overall algorithm has sample complexity\nn = O ((C \u03b1 )2` + logN \u03b12\u03b52 ) for some constant C > 1 and runs in time polynomial in n and N , and learns the parameters up to an additive \u03b5 with high probability. The (C/\u03b1)2` term corresponds to the number of samples needed to recover the signs of the entries in K. We complement this result with a minimax lower bound (Theorem 2) to show that this sample complexity is in fact near optimal. In particular, we show that there is an infinite family of graphs with cycle sparsity ` (namely length ` cycles) on which any algorithm requires at least (C \u2032\u03b1)\u22122` samples to recover the signs of the entries of K for some constant C \u2032 > 1. Finally, we show experimental results that confirm many quantitative aspects of our theoretical predictions. Together, our upper bounds, lower bounds, and experiments present a nuanced understanding of which DPPs can be learned provably and efficiently."}, {"heading": "2. Estimation of the Kernel", "text": ""}, {"heading": "2.1. Model and definitions", "text": "Let Y1, . . . , Yn be n independent copies of Y \u223c DPP(K), for some unknown kernel K such that 0 K IN . It is well known that K is identified by DPP(K) only up to flips of the signs of its rows and columns: If K \u2032 is another symmetric matrix with 0 K \u2032 IN , then DPP(K \u2032)=DPP(K) if and only if K \u2032 = DKD for some D \u2208 DN , where DN denotes the class of all N \u00d7 N diagonal matrices with only 1 and \u22121 on their diagonals (Kulesza, 2012, Theorem 4.1). We call such a transform a DN -similarity of K.\nIn view of this equivalence class, we define the following pseudo-distance between kernels K and K \u2032:\n\u03c1(K,K \u2032) = inf D\u2208DN |DKD \u2212K \u2032|\u221e ,\nwhere for any matrix K, |K|\u221e = maxi,j\u2208[N ] |Ki,j | denotes the entrywise sup-norm.\nFor any S \u2282 [N ], we write \u2206S = det(KS), where KS denotes the |S| \u00d7 |S| submatrix of K obtained by keeping rows and colums with indices in S. Note that for 1 \u2264 i 6= j \u2264 N , we have the following relations:\nKi,i = P[i \u2208 Y ], \u2206{i,j} = P[{i, j} \u2286 Y ],\nand |Ki,j | = \u221a Ki,iKj,j \u2212\u2206{i,j}. Therefore, the principal minors of size one and two of K determine K up to the sign of its off-diagonal entries. In fact, for any K, there exists an ` depending only on the graph GK induced by K, such that K can be recovered up to a DN -similarity with only the knowledge of its principal minors of size at most `. We will show that this ` is exactly the cycle sparsity."}, {"heading": "2.2. DPPs and graphs", "text": "In this section, we review some of the interplay between graphs and DPPs that plays a key role in the definition of our estimator.\nWe begin by recalling some standard graph theoretic notions. Let G = ([N ], E), |E| = m. A cycle C of G is any connected subgraph in which each vertex has even degree. Each cycle C is associated with an incidence vector x \u2208 GF (2)m such that xe = 1 if e is an edge in C and xe = 0 otherwise. The cycle space C of G is the subspace of GF (2)m spanned by the incidence vectors of the cycles in G. The dimension \u03bdG of the cycle space is called cyclomatic number, and it is well known that \u03bdG := m\u2212N + \u03ba(G), where \u03ba(G) denotes the number of connected components of G.\nRecall that a simple cycle is a graph where every vertex has either degree two or zero and the set of vertices with degree two form a connected set. A cycle basis is a basis of C \u2282 GF (2)m such that every element is a simple cycle. It is well known that every cycle space has a cycle basis of induced cycles.\nDefinition 1. The cycle sparsity of a graph G is the minimal ` for which G admits a cycle basis of induced cycles of length at most `, with the convention that ` = 2 whenever the cycle space is empty. A corresponding cycle basis is called a shortest maximal cycle basis.\nA shortest maximal cycle basis of the cycle space was also studied for other reasons by (Chickering et al., 1995). We defer a discussion of computing such a basis to Section 4.\nFor any subset S \u2286 [N ], denote by GK(S) = (S,E(S)) the subgraph of GK induced by S. A matching of GK(S) is a subset M \u2286 E(S) such that any two distinct edges in M are not adjacent in G(S). The set of vertices incident to some edge in M is denoted by V (M). We denote by M(S) the collection of all matchings of GK(S). Then, if GK(S) is an induced cycle, we can write the principal\nminor \u2206S = det(KS) as follows: \u2206S = \u2211\nM\u2208M(S)\n(\u22121)|M | \u220f\n{i,j}\u2208M\nK2i,j \u220f\ni 6\u2208V (M)\nKi,i\n+ 2\u00d7 (\u22121)|S|+1 \u220f\n{i,j}\u2208E(S)\nKi,j . (1)\nOthers have considered the relationship between the principal minors of K and recovery of DPP(K). There has been work regarding the symmetric principal minor assignment problem, namely the problem of computing a matrix given an oracle that gives any principal minor in constant time (Rising et al., 2015).\nIn our setting, we can approximate the principal minors of K by empirical averages. However the accuracy of our estimator deteriorates with the size of the principal minor, and we must therefore estimate the smallest possible principal minors in order to achieve optimal sample complexity. Here, we prove a new result, namely, that the smallest ` such that all the principal minors of K are uniquely determined by those of size at most ` is exactly the cycle sparsity of the graph induced by K.\nProposition 1. Let K \u2208 RN\u00d7N be a symmetric matrix, GK be the graph induced byK, and ` \u2265 3 be some integer. The kernelK is completely determined up toDN -similarity by its principal minors of size at most ` if and only if the cycle sparsity of GK is at most `.\nProof. Note first that all the principal minors of K completely determine K up to a DN -similarity (Rising et al., 2015, Theorem 3.14). Moreover, recall that principal minors of degree at most 2 determine the diagonal entries of K as well as the magnitude of its off-diagonal entries. In particular, given these principal minors, one only needs to recover the signs of the off-diagonal entries of K. Let the sign of cycle C in K be the product of the signs of the entries of K corresponding to the edges of C.\nSuppose GK has cycle sparsity ` and let (C1, . . . , C\u03bd) be a cycle basis of GK where each Ci, i \u2208 [\u03bd] is an induced cycle of length at most `. By (1), the sign of any Ci, i \u2208 [\u03bd] is completely determined by the principal minor \u2206S , where S is the set of vertices of Ci and is such that |S| \u2264 `. Moreover, for i \u2208 [\u03bd], let xi \u2208 GF (2)m denote the incidence vector of Ci. By definition, the incidence vector x of any cycle C is given by \u2211 i\u2208I xi for some subset I \u2282 [\u03bd]. The sign of C is then given by the product of the signs of Ci, i \u2208 I and thus by corresponding principal minors. In particular, the signs of all cycles are determined by the principal minors \u2206S with |S| \u2264 `. In turn, by Theorem 3.12 in (Rising et al., 2015), the signs of all cycles completely determine K, up to a DN -similarity.\nNext, suppose the cycle sparsity of GK is at least ` + 1,\nand let C` be the subspace of GF (2)m spanned by the induced cycles of length at most ` in GK . Let x1, . . . , x\u03bd be a basis of C` made of the incidence column vectors of induced cycles of length at most ` inGK and form the matrix A \u2208 GF (2)m\u00d7\u03bd by concatenating the xi\u2019s. Since C` does not span the cycle space of GK , \u03bd < \u03bdGK \u2264 m. Hence, the rank of A is less than m, so the null space of A> is non trivial. Let x\u0304 be the incidence column vector of an induced cycle C\u0304 that is not in C`, and let h \u2208 GL(2)m with A>h = 0, h 6= 0 and x\u0304>h = 1. These three conditions are compatible because C\u0304 /\u2208 C`. We are now in a position to define an alternate kernel K \u2032 as follows: Let K \u2032i,i = Ki,i and |K \u2032i,j | = |Ki,j | for all i, j \u2208 [N ]. We define the signs of the off-diagonal entries of K \u2032 as follows: For all edges e = {i, j}, i 6= j, sgn(K \u2032e) = sgn(Ke) if he = 0 and sgn(K \u2032e) = \u2212 sgn(Ke) otherwise. We now check that K and K \u2032 have the same principal minors of size at most ` but differ on a principal minor of size larger than `. To that end, let x be the incidence vector of a cycle C in C` so that x = Aw for some w \u2208 GL(2)\u03bd . Thus the sign of C in K is given by\u220f\ne : xe=1\nKe = (\u22121)x >h \u220f e : xe=1 K \u2032e\n= (\u22121)w >A>h \u220f e : xe=1 K \u2032e = \u220f e : xe=1 K \u2032e\nbecause A>h = 0. Therefore, the sign of any C \u2208 C` is the same in K and K \u2032. Now, let S \u2286 [N ] with |S| \u2264 `, and let G = GKS = GK\u2032S be the graph corresponding to KS (or, equivalently, to K \u2032S). For any induced cycle C in G, C is also an induced cycle in GK and its length is at most `. Hence, C \u2208 C` and the sign of C is the same in K and K \u2032. By (Rising et al., 2015, Theorem 3.12), det(KS) = det(K \u2032S). Next observe that the sign of C\u0304 in K is given by\u220f\ne : x\u0304e=1\nKe = (\u22121)x\u0304 >h \u220f e : x\u0304e=1 K \u2032e = \u2212 \u220f e : xe=1 K \u2032e.\nNote also that since C\u0304 is an induced cycle of GK = GK\u2032 , the above quantity is nonzero. Let S\u0304 be the set of vertices in C\u0304. By (1) and the above display, we have det(KS\u0304) 6= det(K \u2032\nS\u0304 ). Together with (Rising et al., 2015, Theorem\n3.14), it yields K 6= DK \u2032D for all D \u2208 DN ."}, {"heading": "2.3. Definition of the Estimator", "text": "Our procedure is based on the previous result and can be summarized as follows. We first estimate the diagonal entries (i.e., the principal minors of size one) of K by the method of moments. By the same method, we estimate the principal minors of size two ofK, and we deduce estimates of the magnitude of the off-diagonal entries. To use these estimates to deduce an estimate G\u0302 of GK , we make the following assumption on the kernel K.\nAssumption 1. Fix \u03b1 \u2208 (0, 1). For all 1 \u2264 i < j \u2264 N , either Ki,j = 0, or |Ki,j | \u2265 \u03b1.\nFinally, we find a shortest maximal cycle basis of G\u0302, and we set the signs of our non-zero off-diagonal entry estimates by using estimators of the principal minors induced by the elements of the basis, again obtained by the method of moments.\nFor S \u2286 [N ], set \u2206\u0302S = 1\nn n\u2211 p=1 1S\u2286Yp , and define\nK\u0302i,i = \u2206\u0302{i} and B\u0302i,j = K\u0302i,iK\u0302j,j \u2212 \u2206\u0302{i,j},\nwhere K\u0302i,i and B\u0302i,j are our estimators of Ki,i and K2i,j , respectively.\nDefine G\u0302 = ([N ], E\u0302), where, for i 6= j, {i, j} \u2208 E\u0302 if and only if B\u0302i,j \u2265 12\u03b1\n2. The graph G\u0302 is our estimator of GK . Let {C\u03021, ..., C\u0302\u03bdG\u0302} be a shortest maximal cycle basis of the cycle space of G\u0302. Let S\u0302i \u2286 [N ] be the subset of vertices of C\u0302i, for 1 \u2264 i \u2264 \u03bdG\u0302. We define\nH\u0302i = \u2206\u0302S\u0302i \u2212 \u2211\nM\u2208M(S\u0302i)\n(\u22121)|M | \u220f\n{i,j}\u2208M\nB\u0302i,j \u220f\ni 6\u2208V (M)\nK\u0302i,i,\nfor 1 \u2264 i \u2264 \u03bdG\u0302. In light of (1), for large enough n, this quantity should be close to\nHi = 2\u00d7 (\u22121)|S\u0302i|+1 \u220f\n{i,j}\u2208E(S\u0302i)\nKi,j .\nWe note that this definition is only symbolic in nature, and computing H\u0302i in this fashion is extremely inefficient. Instead, to compute it in practice, we will use the determinant of an auxiliary matrix, computed via a matrix factorization. Namely, let us define the matrix K\u0303 \u2208 RN\u00d7N such that K\u0303i,i = K\u0302i,i for 1 \u2264 i \u2264 N , and K\u0303i,j = B\u03021/2i,j . We have\ndet K\u0303S\u0302i = \u2211 M\u2208M (\u22121)|M | \u220f {i,j}\u2208M B\u0302i,j \u220f i 6\u2208V (M) K\u0302i,i\n+ 2\u00d7 (\u22121)|S\u0302i|+1 \u220f\n{i,j}\u2208E\u0302(S\u0302i)\nB\u0302 1/2 i,j ,\nso that we may equivalently write\nH\u0302i = \u2206\u0302S\u0302i \u2212 det(K\u0303S\u0302i) + 2\u00d7 (\u22121) |S\u0302i|+1 \u220f {i,j}\u2208E\u0302(S\u0302i) B\u0302 1/2 i,j .\nFinally, let m\u0302 = |E\u0302|. Set the matrix A \u2208 GF (2)\u03bdG\u0302\u00d7m\u0302 with i-th row representing C\u0302i in GF (2)m, 1 \u2264 i \u2264 \u03bdG\u0302, b = (b1, . . . , b\u03bdG\u0302) \u2208 GF (2)\n\u03bdG\u0302 with bi = 12 [sgn(H\u0302i) + 1], 1 \u2264 i \u2264 \u03bdG\u0302, and let x \u2208 GF (2)m be a solution to the linear system Ax = b if a solution exists, x = 1m otherwise.\nWe define K\u0302i,j = 0 if {i, j} /\u2208 E\u0302 and K\u0302i,j = K\u0302j,i = (2x{i,j} \u2212 1)B\u0302 1/2 i,j for all {i, j} \u2208 E\u0302."}, {"heading": "2.4. Geometry", "text": "The main result of this subsection is the following lemma which relates the quality of estimation of K in terms of \u03c1 to the quality of estimation of the principal minors \u2206S . Lemma 1. Let K satisfy Assumption 1, and let ` be the cycle sparsity of GK . Let \u03b5 > 0. If |\u2206\u0302S \u2212\u2206S | \u2264 \u03b5 for all S \u2286 [N ] with |S| \u2264 2 and if |\u2206\u0302S \u2212\u2206S | \u2264 (\u03b1/4)|S| for all S \u2286 [N ] with 3 \u2264 |S| \u2264 `, then\n\u03c1(K\u0302,K) < 4\u03b5/\u03b1 .\nProof. We can bound |B\u0302i,j \u2212K2i,j |, namely,\nB\u0302i,j \u2264 (Ki,i + \u03b12/16)(Kj,j + \u03b12/16)\u2212 (\u2206{i,j} \u2212 \u03b12/16) \u2264 K2i,j + \u03b12/4\nand\nB\u0302i,j \u2265 (Ki,i \u2212 \u03b12/16)(Kj,j \u2212 \u03b12/16)\u2212 (\u2206{i,j} + \u03b12/16) \u2265 K2i,j \u2212 3\u03b12/16,\ngiving |B\u0302i,j \u2212K2i,j | < \u03b12/4. Thus, we can correctly determine whether Ki,j = 0 or |Ki,j | \u2265 \u03b1, yielding G\u0302 = GK . In particular, the cycle basis C\u03021, . . . , C\u0302\u03bdG\u0302 of G\u0302 is a cycle basis of GK . Let 1 \u2264 i \u2264 \u03bdG\u0302. Denote by t = (\u03b1/4)|Si|. We have\u2223\u2223\u2223H\u0302i \u2212Hi\u2223\u2223\u2223 \u2264 |\u2206\u0302S\u0302i \u2212\u2206S\u0302i |+ |M(S\u0302i)|maxx\u2208\u00b11 [ (1 + 4tx)|S\u0302i| \u2212 1\n] \u2264 (\u03b1/4)|S\u0302i| + |M(S\u0302i)| [ (1 + 4t)|S\u0302i| \u2212 1\n] \u2264 (\u03b1/4)|S\u0302i| + T ( |S\u0302i|, \u230a |S\u0302i| 2 \u230b) 4t T (|S\u0302i|, |S\u0302i|)\n\u2264 (\u03b1/4)|S\u0302i| + 4t (2 |S\u0302i| 2 \u2212 1)(2|S\u0302i| \u2212 1)\n\u2264 (\u03b1/4)|S\u0302i| + t22|S\u0302i|\n< 2\u03b1|S\u0302i| \u2264 |Hi|,\nwhere, for positive integers p < q, we denote by T (q, p) = \u2211p i=1 ( q i ) . Therefore, we can deter-\nmine the sign of the product \u220f {i,j}\u2208E(S\u0302i)Ki,j for every element in the cycle basis and recover the signs of the non-zero off-diagonal entries of Ki,j . Hence,\n\u03c1(K\u0302,K) = max1\u2264i,j\u2264N \u2223\u2223\u2223|K\u0302i,j | \u2212 |Ki,j |\u2223\u2223\u2223. For i = j,\u2223\u2223\u2223|K\u0302i,j | \u2212 |Ki,j |\u2223\u2223\u2223 = |K\u0302i,i \u2212Ki,i| \u2264 \u03b5. For i 6= j with {i, j} \u2208 E\u0302 = E, one can easily show that\u2223\u2223\u2223B\u0302i,j \u2212K2i,j\u2223\u2223\u2223 \u2264 4\u03b5, yielding\n|B\u03021/2i,j \u2212 |Ki,j || \u2264 4\u03b5\u2223\u2223B\u03021/2i,j + |Ki,j |\u2223\u2223 \u2264 4\u03b5 \u03b1 ,\nwhich completes the proof.\nWe are now in a position to establish a sufficient sample size to estimate K within distance \u03b5. Theorem 1. Let K satisfy Assumption 1, and let ` be the cycle sparsity of GK . Let \u03b5 > 0. For any A > 0, there exists C > 0 such that\nn \u2265 C ( 1 \u03b12\u03b52 + ` ( 4 \u03b1 )2`) logN ,\nyields \u03c1(K\u0302,K) \u2264 \u03b5 with probability at least 1\u2212N\u2212A.\nProof. Using the previous lemma, and applying a union bound,\nP [ \u03c1(K\u0302,K) > \u03b5 ] \u2264 \u2211 |S|\u22642 P [ |\u2206\u0302S \u2212\u2206S | > \u03b1\u03b5/4 ] +\n\u2211 2\u2264|S|\u2264` P [ |\u2206\u0302S \u2212\u2206S | > (\u03b1/4)|S| ] \u2264 2N2e\u2212n\u03b1 2\u03b52/8 + 2N `+1e\u22122n(\u03b1/4) 2`\n, (2)\nwhere we used Hoeffding\u2019s inequality."}, {"heading": "3. Information theoretic lower bound", "text": "We prove an information-theoretic lower bound that holds already if GK is an `-cycle. Let D(K\u2016K \u2032) and H(K,K \u2032) denote respectively the Kullback-Leibler divergence and the Hellinger distance between DPP(K) and DPP(K \u2032). Lemma 2. For \u03b7 \u2208 {\u2212,+}, letK\u03b7 be the `\u00d7`matrix with elements given by\nKi,j =  1/2 if j = i \u03b1 if j = i\u00b1 1 \u03b7\u03b1 if (i, j) \u2208 {(1, `), (`, 1)} 0 otherwise .\nThen, for any \u03b1 \u2264 1/8, it holds\nD(K\u2016K \u2032) \u2264 4(6\u03b1)`, and H(K,K \u2032) \u2264 (8\u03b12)` .\nProof. It is straightforward to see that\ndet(K+J )\u2212 det(K \u2212 J ) = { 2\u03b1` if J = [`] 0 else .\nIf Y is sampled from DPP(K\u03b7), we denote by p\u03b7(S) = P[Y = S], for S \u2286 [`]. It follows from the inclusionexclusion principle that for all S \u2286 [`],\np+(S)\u2212 p\u2212(S) = \u2211\nJ\u2286[`]\\S\n(\u22121)|J|(detK+S\u222aJ \u2212 detK \u2212 S\u222aJ)\n= (\u22121)`\u2212|S|(detK+ \u2212 detK\u2212) = \u00b12\u03b1` , (3)\nwhere |J | denotes the cardinality of J . The inclusionexclusion principle also yields that p\u03b7(S) = |det(K\u03b7 \u2212 IS\u0304)| for all S \u2286 [l], where IS\u0304 stands for the ` \u00d7 ` diagonal matrix with ones on its entries (i, i) for i /\u2208 S, zeros elsewhere.\nDenote by D(K+\u2016K\u2212) the Kullback Leibler divergence between DPP(K+) and DPP(K\u2212):\nD(K+\u2016K\u2212) = \u2211 S\u2286[`] p+(S) log ( p+(S) p\u2212(S) )\n\u2264 \u2211 S\u2286[`] p+(S) p\u2212(S) (p+(S)\u2212 p\u2212(S))\n\u2264 2\u03b1` \u2211 S\u2286[`] |det(K+ \u2212 IS\u0304)| |det(K\u2212 \u2212 IS\u0304)| , (4)\nby (3). Using the fact that 0 < \u03b1 \u2264 1/8 and the Gershgorin circle theorem, we conclude that the absolute value of all eigenvalues of K\u03b7\u2212 IS\u0304 are between 1/4 and 3/4. Thus we obtain from (4) the bound D(K+\u2016K\u2212) \u2264 4(6\u03b1)`.\nUsing the same arguments as above, the Hellinger distance H(K+,K\u2212) between DPP(K+) and DPP(K\u2212) satisfies\nH(K+,K\u2212) = \u2211 J\u2286[`] ( p+(J)\u2212 p\u2212(J)\u221a p+(J) + \u221a p\u2212(J) )2\n\u2264 \u2211 J\u2286[`] 4\u03b12` 2 \u00b7 4\u2212` = (8\u03b12)`\nwhich completes the proof.\nThe sample complexity lower bound now follows from standard arguments.\nTheorem 2. Let 0 < \u03b5 \u2264 \u03b1 \u2264 1/8 and 3 \u2264 ` \u2264 N . There exists a constant C > 0 such that if\nn \u2264 C ( 8` \u03b12` + log(N/`) (6\u03b1)` + logN \u03b52 ) ,\nthen the following holds: for any estimator K\u0302 based on n samples, there exists a kernelK that satisfies Assumption 1 and such that the cycle sparsity of GK is ` and for which \u03c1(K\u0302,K) \u2265 \u03b5 with probability at least 1/3.\nProof. Recall the notation of Lemma 2. First consider the N \u00d7N block diagonal matrix K (resp. K \u2032) where its first block isK+ (resp. K\u2212) and its second block is IN\u2212`. By a standard argument, the Hellinger distance Hn(K,K \u2032) between the product measures DPP(K)\u2297n and DPP(K \u2032)\u2297n satisfies\n1\u2212 H 2 n(K,K \u2032) 2 = ( 1\u2212 H 2(K,K \u2032) 2 )n \u2265 (1\u2212 \u03b12` 2\u00d7 8` )n ,\nwhich yields the first term in the desired lower bound.\nNext, by padding with zeros, we can assume that L = N/` is an integer. Let K(0) be a block diagonal matrix where each block is K+ (using the notation of Lemma 2). For j = 1, . . . , L, define the N \u00d7 N block diagonal matrix K(j) as the matrix obtained from K(0) by replacing its jth block with K\u2212 (again using the notation of Lemma 2).\nSince DPP(K(j)) is the product measure of L lower dimensional DPPs that are each independent of each other, using Lemma 2 we have D(K(j)\u2016K(0)) \u2264 4(6\u03b1)`. Hence, by Fano\u2019s lemma (see, e.g., Corollary 2.6 in (Tsybakov, 2009)), the sample complexity to learn the kernel of a DPP within a distance \u03b5 \u2264 \u03b1 is\n\u2126\n( log(N/`)\n(6\u03b1)` ) which yields the second term.\nThe third term follows from considering K0 = (1/2)IN and letting Kj be obtained from K0 by adding \u03b5 to the jth entry along the diagonal. It is easy to see that D(Kj\u2016K0) \u2264 8\u03b52. Hence, a second application of Fano\u2019s lemma yields that the sample complexity to learn the kernel of a DPP within a distance \u03b5 is \u2126( logN\u03b52 ).\nThe third term in the lower bound is the standard parametric term and is unavoidable in order to estimate the magnitude of the coefficients of K. The other terms are more interesting. They reveal that the cycle sparsity of GK , namely, `, plays a key role in the task of recovering the sign pattern of K. Moreover the theorem shows that the sample complexity of our method of moments estimator is near optimal."}, {"heading": "4. Algorithms", "text": ""}, {"heading": "4.1. Horton\u2019s algorithm", "text": "We first give an algorithm to compute the estimator K\u0302 defined in Section 2. A well-known algorithm of Horton (Horton, 1987) computes a cycle basis of minimum total length in time O(m3N). Subsequently, the running time was improved toO(m2N/ logN) time (Amaldi et al., 2010). Also, it is known that a cycle basis of minimum total length is a shortest maximal cycle basis (Chickering et al., 1995). Together, these results imply the following.\nLemma 3. Let G = ([N ], E), |E| = m. There is an algorithm to compute a shortest maximal cycle basis in O(m2N/ logN) time.\nIn addition, we recall the following standard result regarding the complexity of Gaussian elimination (Golub & Van Loan, 2012).\nAlgorithm 1 Compute Estimator K\u0302 Input: samples Y1, ..., Yn, parameter \u03b1 > 0.\nCompute \u2206\u0302S for all |S| \u2264 2. Set K\u0302i,i = \u2206\u0302{i} for 1 \u2264 i \u2264 N . Compute B\u0302i,j for 1 \u2264 i < j \u2264 N . Form K\u0303 \u2208 RN\u00d7N and G\u0302 = ([N ], E\u0302). Compute a shortest maximal cycle basis {v\u03021, ..., v\u0302\u03bdG\u0302}. Compute \u2206\u0302S\u0302i for 1 \u2264 i \u2264 \u03bdG\u0302. Compute C\u0302S\u0302i using det K\u0303S\u0302i for 1 \u2264 i \u2264 \u03bdG\u0302. Construct A \u2208 GF (2)\u03bdG\u0302\u00d7m, b \u2208 GF (2)\u03bdG\u0302 . Solve Ax = b using Gaussian elimination. Set K\u0302i,j = K\u0302j,i = (2x{i,j}\u22121)B\u0302 1/2 i,j , for all {i, j} \u2208 E\u0302.\nLemma 4. LetA \u2208 GF (2)\u03bd\u00d7m, b \u2208 GF (2)\u03bd . Then Gaussian elimination will find a vector x \u2208 GF (2)m such that Ax = b or conclude that none exists in O(\u03bd2m) time.\nWe give our procedure for computing the estimator K\u0302 in Algorithm 1. In the following theorem, we bound the running time of Algorithm 1 and establish an upper bound on the sample complexity needed to solve the recovery problem as well as the sample complexity needed to compute an estimate K\u0302 that is close to K.\nTheorem 3. Let K \u2208 RN\u00d7N be a symmetric matrix satisfying 0 K I , and satisfying Assumption 1. Let GK be the graph induced by K and ` be the cycle sparsity of GK . Let Y1, ..., Yn be samples from DPP(K) and \u03b4 \u2208 (0, 1). If\nn > log(N `+1/\u03b4)\n(\u03b1/4) 2`\n,\nthen with probability at least 1 \u2212 \u03b4, Algorithm 1 computes an estimator K\u0302 which recovers the signs of K up to a DN - similarity and satisfies\n\u03c1(K, K\u0302) < 1\n\u03b1\n( 8 log(4N `+1/\u03b4)\nn\n)1/2 (5)\nin O(m3 + nN2) time.\nProof. (5) follows directly from (2) in the proof of Theorem 1. That same proof also shows that with probability at least 1 \u2212 \u03b4, the support of GK and the signs of K are recovered up to a DN -similarity. What remains is to upper bound the worst case run time of Algorithm 1. We will perform this analysis line by line. Initializing K\u0302 requires O(N2) operations. Computing \u2206S for all subsets |S| \u2264 2 requires O(nN2) operations. Setting K\u0302i,i requires O(N) operations. Computing B\u0302i,j for 1 \u2264 i < j \u2264 N requires O(N2) operations. Forming K\u0303 requires O(N2) operations. Forming GK requires O(N2) operations. By\nLemma 3, computing a shortest maximal cycle basis requires O(mN) operations. Constructing the subsets Si, 1 \u2264 i \u2264 \u03bdG\u0302, requires O(mN) operations. Computing \u2206\u0302Si for 1 \u2264 i \u2264 \u03bdG\u0302 requires O(nm) operations. Computing C\u0302Si using det(K\u0303[Si]) for 1 \u2264 i \u2264 \u03bdG\u0302 requires O(m`3) operations, where a factorization of each K\u0303[Si] is used to compute each determinant in O(`3) operations. Constructing A and b requires O(m`) operations. By Lemma 4, finding a solution x using Gaussian elimination requires O(m3) operations. Setting K\u0302i,j for all edges {i, j} \u2208 E requires O(m) operations. Put this all together, Algorithm 1 runs in O(m3 + nN2) time."}, {"heading": "4.2. Chordal Graphs", "text": "Here we show that it is possible to obtain faster algorithms by exploiting the structure of GK . Specifically, in the case where GK chordal, we give an O(m) time algorithm to determine the signs of the off-diagonal entries of the estimator K\u0302, resulting in an improved overall runtime of O(m + nN2). Recall that a graph G = ([N ], E) is said to be chordal if every induced cycle in G is of length three. Moreover, a graph G = ([N ], E) has a perfect elimination ordering (PEO) if there exists an ordering of the vertex set {v1, ..., vN} such that, for all i, the graph induced by {vi} \u222a {vj |{i, j} \u2208 E, j > i} is a clique. It is well known that a graph is chordal if and only if it has a PEO. A PEO of a chordal graph with m edges can be computed in O(m) operations using lexicographic breadth-first search (Rose et al., 1976).\nLemma 5. Let G = ([N ], E), be a chordal graph and {v1, ..., vn} be a PEO. Given i, let i\u2217 := min{j|j > i, {vi, vj} \u2208 E}. Then the graph G\u2032 = ([N ], E\u2032), where E\u2032 = {{vi, vi\u2217}}N\u2212\u03ba(G)i=1 , is a spanning forest of G.\nProof. We first show that there are no cycles in G\u2032. Suppose to the contrary, that there is an induced cycle C of length k on the vertices {vj1 , ..., vjk}. Let v be the vertex of smallest index. Then v is connected to two other vertices in the cycle of larger index. This is a contradiction to the construction.\nWhat remains is to show that |E\u2032| = N \u2212 \u03ba(G). It suffices to prove the case \u03ba(G) = 1. Suppose to the contrary, that there exists a vertex vi, i < N , with no neighbors of larger index. Let P be the shortest path in G from vi to vN . By connectivity, such a path exists. Let vk be the vertex of smallest index in the path. However, it has two neighbors in the path of larger index, which must be adjacent to each other. Therefore, there is a shorter path.\nNow, given the chordal graph GK induced by K and the estimates of principal minors of size at most three, we provide an algorithm to determine the signs of the edges of\nAlgorithm 2 Compute Signs of Edges in Chordal Graph\nInput: GK = ([N ], E) chordal, \u2206\u0302S for |S| \u2264 3.\nCompute a PEO {v1, ..., vN}. Compute the spanning forest G\u2032 = ([N ], E\u2032). Set all edges in E\u2032 to have positive sign. Compute C\u0302{i,j,i\u2217} for all {i, j} \u2208 E \\ E\u2032, j < i. Order edges E \\ E\u2032 = {e1, ..., e\u03bd} such that i > j if max ei < max ej . Visit edges in sorted order and for e = {i, j}, j > i, set\nsgn({i, j}) = sgn(C\u0302{i,j,i\u2217}) sgn({i, i\u2217}) sgn({j, i\u2217}).\nGK , or, equivalently, the off-diagonal entries of K.\nTheorem 4. IfGK is chordal, Algorithm 2 correctly determines the signs of the edges of GK in O(m) time.\nProof. We will simultaneously perform a count of the operations and a proof of the correctness of the algorithm. Computing a PEO requires O(m) operations. Computing the spanning forest requires O(m) operations. The edges of the spanning tree can be given arbitrary sign, because it is a cycle-free graph. This assigns a sign to two edges of each 3-cycle. Computing each C\u0302{i,j,i\u2217} requires a constant number of operations because ` = 3, requiring a total of O(m \u2212N) operations. Ordering the edges requires O(m) operations. Setting the signs of each remaining edge requires O(m) operations.\nTherefore, when GK is chordal, the overall complexity required by our algorithm to compute K\u0302 is reduced to O(m+ nN2)."}, {"heading": "5. Experiments", "text": "Here we present experiments to supplement the theoretical results of the paper. We test our algorithm on two types of random matrices. First, we consider the matrix K \u2208 RN\u00d7N corresponding to the cycle on N vertices,\nK = 1\n2 I +\n1 4 A,\nwhere A is symmetric and has non-zero entries only on the edges of the cycle, either +1 or \u22121, each with probability 1/2. By the Gershgorin circle theorem, 0 K I . Next, we consider the matrix K \u2208 RN\u00d7N corresponding to the clique on N vertices,\nK = 1\n2 I +\n1\n4 \u221a N A,\nwhere A is symmetric and has all entries either +1 or \u22121, each with probability 1/2. It is well known that \u22122 \u221a N A 2 \u221a N with high probability, implying 0 K I .\nFor both cases and for a range of values of matrix dimension N and samples n, we run our algorithm on 50 randomly generated instances. We record the proportion of trials where we recover the graph induced by K, and the proportion of the trials where we recover both the graph and correctly determine the signs of the entries.\nIn Figure 1, the shade of each box represents the proportion of trials where recovery was successful for a given pair N,n. A completely white box corresponds to zero success rate, black to a perfect success rate.\nThe plots corresponding to the cycle and the clique are telling. We note that for the clique, recovering the sparsity pattern and recovering the signs of the off-diagonal entries come hand-in-hand. However, for the cycle, there is a noticeable gap between the number of samples required to recover the sparsity pattern and the number of samples required to recover the signs of the off-diagonal entries. This empirically confirms the central role that cycle sparsity plays in parameter estimation, and further corroborates our theoretical results."}, {"heading": "6. Conclusion and open questions", "text": "In this paper, we gave the first provable guarantees for learning the parameters of a DPP. Our upper and lower bounds reveal the key role played by the parameter `, which is the cycle sparsity of graph induced by the kernel of the DPP. Our estimator does not need to know ` beforehand, but can adapt to the instance. Moreover, our procedure outputs an estimate of `, which could potentially be used for further inference questions such as testing and confidence intervals. An interesting open question is whether on a graph by graph basis, the parameter ` exactly determines the optimal sample complexity. Moreover when the number of samples is too small, can we exactly characterize which signs can be learned correctly and which cannot (up to a similarity transformation by D)? Such results would lend new theoretical insights into the output of algorithms for learning DPPs, and which individual parameters in the estimate we can be confident about and which we cannot.\nAcknowledgements. A.M. is supported in part by NSF CAREER Award CCF-1453261, NSF Large CCF1565235, a David and Lucile Packard Fellowship and an Alfred P. Sloan Fellowship. P.R. is supported in part by NSF CAREER DMS-1541099, NSF DMS-1541100, DARPA W911NF-16-1-0551, ONR N00014-17-1-2147 and a grant from the MIT NEC Corporation."}], "year": 2017, "references": [{"title": "Learning the parameters of determinantal point process kernels", "authors": ["Affandi", "Raja Hafiz", "Fox", "Emily B", "Adams", "Ryan P", "Taskar", "Benjamin"], "venue": "In Proceedings of the 31th International Conference on Machine Learning, ICML 2014, Beijing,", "year": 2014}, {"title": "Efficient deterministic algorithms for finding a minimum cycle basis in undirected graphs", "authors": ["Amaldi", "Edoardo", "Iuliano", "Claudio", "Rizzi", "Romeo"], "venue": "In International Conference on Integer Programming and Combinatorial Optimization,", "year": 2010}, {"title": "Diversifying sparsity using variational determinantal point processes", "authors": ["Batmanghelich", "Nematollah Kayhan", "Quon", "Gerald", "Kulesza", "Alex", "Kellis", "Manolis", "Golland", "Polina", "Bornn", "Luke"], "year": 2014}, {"title": "Eynard\u2013mehta theorem, schur process, and their pfaffian analogs", "authors": ["Borodin", "Alexei", "Rains", "Eric M"], "venue": "Journal of statistical physics,", "year": 2005}, {"title": "Maximum likelihood estimation of determinantal point processes", "authors": ["Brunel", "Victor-Emmanuel", "Moitra", "Ankur", "Rigollet", "Philippe", "Urschel", "John"], "year": 2017}, {"title": "On finding a cycle basis with a shortest maximal cycle", "authors": ["Chickering", "David M", "Geiger", "Dan", "Heckerman", "David"], "venue": "Information Processing Letters,", "year": 1995}, {"title": "On selecting a maximum volume sub-matrix of a matrix and related problems", "authors": ["\u00c7ivril", "Ali", "Magdon-Ismail", "Malik"], "venue": "Theoretical Computer Science,", "year": 2009}, {"title": "Efficient volume sampling for row/column subset selection", "authors": ["Deshpande", "Amit", "Rademacher", "Luis"], "venue": "In Foundations of Computer Science (FOCS),", "year": 2010}, {"title": "Statistical theory of the energy levels of complex systems", "authors": ["Dyson", "Freeman J"], "venue": "III. J. Mathematical Phys.,", "year": 1962}, {"title": "Expectation-maximization for learning determinantal point processes", "authors": ["Gillenwater", "Jennifer A", "Kulesza", "Alex", "Fox", "Emily", "Taskar", "Ben"], "venue": "In NIPS,", "year": 2014}, {"title": "A polynomial-time algorithm to find the shortest cycle basis of a graph", "authors": ["Horton", "Joseph Douglas"], "venue": "SIAM Journal on Computing,", "year": 1987}, {"title": "Learning with determinantal point processes", "authors": ["A. Kulesza"], "venue": "PhD thesis, University of Pennsylvania,", "year": 2012}, {"title": "k-DPPs: Fixed-size determinantal point processes", "authors": ["Kulesza", "Alex", "Taskar", "Ben"], "venue": "In Proceedings of the 28th International Conference on Machine Learning,", "year": 2011}, {"title": "Determinantal Point Processes for Machine Learning", "authors": ["Kulesza", "Alex", "Taskar", "Ben"], "venue": "Now Publishers Inc.,", "year": 2012}, {"title": "Individualness and determinantal point processes for pedestrian detection", "authors": ["Lee", "Donghoon", "Cha", "Geonho", "Yang", "Ming-Hsuan", "Oh", "Songhwai"], "venue": "In Computer Vision ECCV 2016 - 14th European Conference,", "year": 2016}, {"title": "Fast sampling for strongly rayleigh measures with application to determinantal point processes", "authors": ["Li", "Chengtao", "Jegelka", "Stefanie", "Sra", "Suvrit"], "year": 2016}, {"title": "Fast dpp sampling for nystrom with application to kernel methods", "authors": ["Li", "Chengtao", "Jegelka", "Stefanie", "Sra", "Suvrit"], "venue": "International Conference on Machine Learning (ICML),", "year": 2016}, {"title": "Learning mixtures of submodular shells with application to document summarization", "authors": ["Lin", "Hui", "Bilmes", "Jeff A"], "venue": "In Proceedings of the Twenty-Eighth Conference on Uncertainty in Artificial Intelligence, Catalina Island, CA,", "year": 2012}, {"title": "The coincidence approach to stochastic point processes", "authors": ["Macchi", "Odile"], "venue": "Advances in Appl. Probability,", "year": 1975}, {"title": "Fixed-point algorithms for learning determinantal point processes", "authors": ["Mariet", "Zelda", "Sra", "Suvrit"], "venue": "In Proceedings of the 32nd International Conference on Machine Learning", "year": 2015}, {"title": "Randomized rounding for the largest simplex problem", "authors": ["Nikolov", "Aleksandar"], "venue": "In Proceedings of the Forty-Seventh Annual ACM on Symposium on Theory of Computing,", "year": 2015}, {"title": "Maximizing determinants under partition constraints", "authors": ["Nikolov", "Aleksandar", "Singh", "Mohit"], "venue": "In STOC,", "year": 2016}, {"title": "Fast mixing for discrete point processes", "authors": ["Rebeschini", "Patrick", "Karbasi", "Amin"], "venue": "In COLT, pp", "year": 2015}, {"title": "An efficient algorithm for the symmetric principal minor assignment problem", "authors": ["Rising", "Justin", "Kulesza", "Alex", "Taskar", "Ben"], "venue": "Linear Algebra and its Applications,", "year": 2015}, {"title": "Algorithmic aspects of vertex elimination on graphs", "authors": ["Rose", "Donald J", "Tarjan", "R Endre", "Lueker", "George S"], "venue": "SIAM Journal on computing,", "year": 1976}, {"title": "Introduction to nonparametric estimation", "authors": ["Tsybakov", "Alexandre B"], "year": 2009}, {"title": "Scalable discovery of audio fingerprint motifs in broadcast streams with determinantal point process based motif clustering", "authors": ["Xu", "Haotian", "Ou"], "venue": "IEEE/ACM Trans. Audio, Speech & Language Processing,", "year": 2016}, {"title": "Tweet timeline generation with determinantal point processes", "authors": ["Yao", "Jin-ge", "Fan", "Feifan", "Zhao", "Wayne Xin", "Wan", "Xiaojun", "Chang", "Edward Y", "Xiao", "Jianguo"], "venue": "In Proceedings of the Thirtieth AAAI Conference on Artificial Intelligence,", "year": 2016}], "id": "SP:c9465f842b3ca9429e15728ba76be84b6df0fb50", "authors": [{"name": "John Urschel", "affiliations": []}, {"name": "Ankur Moitra", "affiliations": []}, {"name": "Philippe Rigollet", "affiliations": []}], "abstractText": "Determinantal Point Processes (DPPs) are a family of probabilistic models that have a repulsive behavior, and lend themselves naturally to many tasks in machine learning where returning a diverse set of objects is important. While there are fast algorithms for sampling, marginalization and conditioning, much less is known about learning the parameters of a DPP. Our contribution is twofold: (i) we establish the optimal sample complexity achievable in this problem and show that it is governed by a natural parameter, which we call the cycle sparsity; (ii) we propose a provably fast combinatorial algorithm that implements the method of moments efficiently and achieves optimal sample complexity. Finally, we give experimental results that confirm our theoretical findings.", "title": "Learning Determinantal Point Processes with Moments and Cycles"}