{"sections": [{"heading": "1. Introduction", "text": "The conditional gradient algorithm (Frank & Wolfe, 1956) (also known as Frank-Wolfe) is historically the earliest algorithm for solving general constrained convex optimization problems. Due to its projection-free property and ability to handle structural constraints, it has regained a significant amount of interest in recent years. Different properties concerning the algorithm, such as the sparsity property (Clarkson, 2010) and the primal-dual convergence rate (Jaggi, 2013), have been analyzed in details. Many different algorithm variants, such as the composite variant (Harchaoui et al., 2015), the online and stochastic vari-\n1Department of Computer Science and Technology, Tsinghua University, Beijing, China 2Artificial Intelligence Department, Ant Financial Services Group, Hangzhou, China 3School of Information Systems, Singapore Management University, Singapore 4Tencent AI Lab, Shenzhen, China. Correspondence to: Wenwu Zhu <wwzhu@tsinghua.edu.cn>, Wenpeng Zhang <zhangwenpeng0@gmail.com>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nants (Hazan & Kale, 2012) (Hazan, 2016) (Hazan & Luo, 2016), faster variants over special types of convex domains, i.e. spectrahedron (Garber, 2016) and polytope (Garber & Hazan, 2016), have also been proposed.\nHowever, despite this great flourish of research on conditional gradient, its distributed online variant over networks has rarely been investigated. In comparison to this situation is the popularity of the variants of its gradient descent and dual averaging counterparts\u2014distributed online gradient descent (D-OGD) (Ram et al., 2010) (Yan et al., 2013) and distributed online dual averaging (D-ODA) (Duchi et al., 2012) (Hosseini et al., 2013) (Lee et al., 2015), which have been successfully applied in handling large-scale streaming data in decentralized computational architectures (e.g., sensor networks and smart phones). Despite the success of these algorithms, the projection operation required in them still limits their further applicability in many settings of practical interests. For example, in matrix learning (Dud\u0131\u0301k et al., 2012), multiclass classification (Hazan & Luo, 2016) and many other related problems, where the convex domain is the set of all matrices with bounded nuclear norm, the projection operation amounts to computing the full singular value decomposition (SVD) of a matrix, too expensive an operation that does not meet the need of locally light computation in distributed online learning. To avoid this kind of expensive operation, the distributed online variant of conditional gradient is desired since it is expected to be able to eschew the projection operation by using a linear minimization step instead. In the aforementioned case, the linear step amounts to finding the top singular vector of a matrix, which is at least one order of magnitude simpler. However, how to design and analyze this variant remains an open problem.\nTo fill this gap, in this work, we present the distributed online conditional gradient (D-OCG) algorithm as the desired variant. This algorithm is a novel extension of the previous online variant (Hazan, 2016), in which each local learner communicates its dual variables with its neighbors to cooperate with each other. We present highly non-trivial analysis of the regret bound for the proposed algorithm, which can capture the intuition that the algorithm\u2019s regret bound should be larger on graphs with more nodes and should be smaller on \u201dwell-connected\u201d graphs (e.g., complete graphs) than on \u201dpoorly connected\u201d graphs (e.g., cycle graphs). We\nevaluate the performance of the D-OCG algorithm on two large-scale real-world datasets for a multiclass classification task. The experimental results show that D-OCG runs significantly faster than both D-OGD and D-ODA. This illustrates that although the regret bound for D-OCG is in higher order O(T 3/4) than those in order O(T 1/2) for DOGD and D-ODA, its lower computational cost per iteration outweighs the increased number of iterations, making it overall a faster algorithm. The theoretical results regarding the algorithm\u2019s regret bound for different graphs are also well confirmed."}, {"heading": "2. Preliminaries", "text": "In this section, we first give a formal definition of the distributed online convex optimization problem, and then review the two algorithms that our algorithm are built upon."}, {"heading": "2.1. Distributed Online Convex Optimization", "text": "Let G = (V,E) denote an undirected graph with vertex set V = {1, \u00b7 \u00b7 \u00b7 , n} and edge set E \u2282 V \u00d7 V . In distributed online convex optimization defined overG (see the book (Sayed et al., 2014) and the survey (Hazan, 2016) for more details), each node i \u2208 V is associated with a separate agent or learner. At each round t = 1, \u00b7 \u00b7 \u00b7 , T , each learner i \u2208 V is required to generate a decision point xi(t) from a convex compact set K \u2286 Rm. Then the adversary replies each learner\u2019s decision with a convex loss function ft,i : K \u2192 R and each learner suffers the loss ft,i(xi(t)). The communication between learners is specified by the graph G: learner i can only communicate directly with its immediate neighbors N(i) = {j \u2208 V |(i, j) \u2208 E}. The goal of the learners is to generate a sequence of decision points xi(t), i \u2208 V so that the regret with respect to each learner i regarding any fixed decision x \u2208 K in hindsight,\nRT (xi,x) = n\u2211 j=1 T\u2211 t=1 (ft,j(xi(t))\u2212 ft,j(x)),\nis sublinear in T .\nWe make the following assumptions: (1) each function ft,i(x) is L-Lipschitz with respect to the L2 norm \u2016\u00b7\u2016 on K, i.e. \u2200 x,y \u2208 K, |ft,i(x)\u2212 ft,i(y)| \u2264 L \u2016x\u2212 y\u2016 . Note that the Lipschitz condition implies that for any x \u2208 K and any\u2207ft,i(x) \u2208 \u2202ft,i(x), we have \u2016\u2207ft,i(x)\u2016 \u2264 L. (2) the Euclidean diameter of K is bounded by D, i.e. \u2200x,y \u2208 K, \u2016x\u2212 y\u2016 \u2264 D.\nTwo definitions are important for deriving useful properties. We say that a function f is \u03b2-smooth if \u2200x,y \u2208 K, we have\nf(y) \u2264 f(x) + \u3008\u2207f(x) , y \u2212 x\u3009+ \u03b2 2 \u2016y \u2212 x\u20162.\nWe say that a function f is \u03c3-strongly convex if \u2200x,y \u2208 K, we have\nf(y) \u2265 f(x) + \u3008\u2207f(x) , y \u2212 x\u3009+ \u03c3 2 \u2016y \u2212 x\u20162.\nA \u03c3-strongly convex function f has a very important property: if x\u2217 = arg minx\u2208Kf(x), then for any x \u2208 K, we have\nf(x)\u2212 f(x\u2217) \u2265 \u03c3 2 \u2016x\u2212 x\u2217\u20162."}, {"heading": "2.2. Distributed Online Dual Averaging", "text": "In the distributed online dual averaging algorithm (Duchi et al., 2012) (Hosseini et al., 2013), each learner i \u2208 V maintains a sequence of iterates xi(t) and a sequence of dual variables zi(t). At each round t = 1, \u00b7 \u00b7 \u00b7 , T , each learner i first computes the new dual variable zi(t + 1) from a weighted combination of its new subgradient gi(t) and other dual variables {zj(t), j \u2208 N(i)} received from its neighbors, then updates the iterate xi(t + 1) via a proximal projection \u220f\u03c8 K(zi(t + 1), \u03b1i(t)), where \u03b1i(t) is a positive number from a non-increasing sequence, \u03c8(x) : K \u2192 R is a proximal function and\u220f\u03c8 K(z, \u03b1) = arg minx\u2208K { \u3008z , x\u3009+ 1\u03b1\u03c8(x) } denotes the projection onto K operator specified by z, \u03b1 and \u03c8(x) (see (Nesterov, 2009) (Xiao, 2010) for more details). The communication between learners is modeled by a doubly stochastic symmetric matrix P , which satisfies (1) Pij > 0 only if (i, j) \u2208 E (i 6= j) or i = j; (2) \u2200 i \u2208 V , \u2211n j=1 Pij = \u2211 j\u2208N(i) Pij = 1 and \u2200 j \u2208 V ,\u2211n\ni=1 Pij = \u2211 i\u2208N(j) Pij = 1.\nAlgorithm 1 Distributed Online Dual Averaging (D-ODA) 1: Input: convex set K, maximum round number T , 2: parameters {\u03b1i(t)}, \u2200 i \u2208 V 3: Initialize: xi(1) \u2208 K, zi(1) = 0, \u2200 i \u2208 V 4: for t = 1, \u00b7 \u00b7 \u00b7 , T do 5: The adversary reveals ft,i, \u2200 i \u2208 V 6: Compute subgradients gi(t) \u2208 \u2202ft,i(xi(t)), \u2200 i \u2208 V 7: for Each Learner i \u2208 V do 8: zi(t+ 1) = \u2211 j\u2208N(i) pijzj(t)+gi(t)\n9: xi(t+ 1) = \u220f\u03c8 K(zi(t+ 1), \u03b1i(t))\n10: end for 11: end for"}, {"heading": "2.3. Online Conditional Gradient", "text": "The standard online conditional gradient algorithm (Hazan & Kale, 2012) (Hazan, 2016) eschews the computational expensive projection operation by using a simple linear optimization step instead and is thus much more efficient for many computationally intensive tasks.\nAlgorithm 2 Online Conditional Gradient (OCG) 1: Input: convex set K, maximum round number T , 2: parameters \u03b7 and {\u03c3t} 3: Initialize: x1 \u2208 K 4: for t = 1, \u00b7 \u00b7 \u00b7 , T do 5: The adversary reveals ft 6: Compute a subgradient gt \u2208 \u2202ft(xt) 7: Ft(x) = \u03b7 \u2211t\u22121 i=1 \u3008gi , x\u3009+ \u2016x\u2212 x1\u2016 2\n8: vt = arg minx\u2208K {\u3008\u2207Ft(xt) , x\u3009} 9: xt+1 = xt + \u03c3t(vt \u2212 xt)\n10: end for"}, {"heading": "3. Distributed Online Conditional Gradient", "text": "In this section, we first present the proposed distributed online conditional gradient algorithm, and then give the theoretical analysis of its regret bound."}, {"heading": "3.1. Algorithm", "text": "Algorithm 3 Distributed Online Conditional Gradient (DOCG)\n1: Input: convex set K, maximum round number T , 2: parameters {\u03b7i} and{\u03c3t,i}, \u2200 i \u2208 V 3: Initialize: xi(1) \u2208 K, zi(1) = 0, \u2200 i \u2208 V 4: for t = 1, \u00b7 \u00b7 \u00b7 , T do 5: The adversary reveals ft,i, \u2200 i \u2208 V 6: Compute subgradients gi(t) \u2208 \u2202ft,i(xi(t)), \u2200 i \u2208 V 7: for Each Learner i \u2208 V do 8: Ft,i(x) = \u03b7i \u3008zi(t) , x\u3009+ \u2016x\u2212 x1(1)\u20162 9: vi(t) = arg minx\u2208K {\u3008\u2207Ft,i(xi(t)) , x\u3009}\n10: xi(t+ 1) = xi(t) + \u03c3t,i(vi(t)\u2212 xi(t)) 11: zi(t+ 1) = \u2211 j\u2208N(i) pijzj(t)+gi(t) 12: end for 13: end for"}, {"heading": "3.2. Analysis", "text": "Theorem 1. The D-OCG algorithm with parameters \u03b7i = (1\u2212\u03c32(P ))D 2( \u221a n+1+( \u221a n\u22121)\u03c32(P ))LT 3/4\nand \u03c3t,i = 1\u221at for any i \u2208 V and any t = 1, \u00b7 \u00b7 \u00b7 , T attains the following regret bound\nRT (xi,x) \u2264 8nLDT 3/4\n+ 6 \u221a n+ 1\u2212 \u03c32(P )\n4( \u221a n+ 1 + ( \u221a n\u2212 1)\u03c32(P )) LDT 1/4\n+ 2( \u221a n+ 1 + ( \u221a n\u2212 1)\u03c32(P ))\n1\u2212 \u03c32(P ) LDT 3/4,\nwhere \u03c32(P ) denotes the second largest eigenvalue of matrix P and 1 \u2212 \u03c32(P ) denotes the corresponding spectral gap value.\nRemark. (1) The regret bound for D-OCG is in the similar order O(T 3/4) to that of its centralized variant\nOCG (Hazan, 2016). (2) Since the connectivity of a graph is captured by its spectral gap value 1\u2212\u03c32(P ) (Duchi et al., 2012) (Colin et al., 2016): the better the connectivity of a graph is, the larger the spectral gap value will be, it is easy to verify that this theorem captures the intuition that the D-OCG\u2019s regret bound will be larger on larger graphs (the regret bound will be larger when the node size n is larger for all T ) and will be smaller on \u201dwell-connected\u201d graphs than on \u201dpoorly connected\u201d graphs (the regret bound will be smaller when the spectral gap value is larger for certain large T ).\nTo analyze the regret bound for D-OCG, we first establish its connection to D-ODA. To this end, we consider the following points\nx\u2217i (t) = arg min x\u2208K Ft,i(x),\nwhere Ft,i(x) are the functions defined in line 8 in D-OCG. Actually, these points are exactly the iterates of D-ODA with regularization \u03c8(x) = \u2016x\u2212 x1(1)\u20162 applied to the following loss functions\nf\u0303t,i(x) = ft,i(x + (xi(t)\u2212 x\u2217i (t))).\nNote that these loss functions are not the same as the original ft,i(x) in D-OCG. The reason is that the subgradients used in the aforementioned D-ODA are \u2202ft,i(xi(t)) rather than \u2202ft,i(x\u2217i (t)). Indeed, in this algorithm, the subgradients are evaluated at the points x\u2217i (t), thus the corresponding loss functions f\u0303t,i(x) should satisfy\n\u2202f\u0303t,i(x \u2217 i (t)) = \u2202ft,i(xi(t)).\nThis clearly holds by definition of f\u0303t,i(x).\nBased on the above preparation, we can now present the following lemma.\nLemma 1. For any fixed i \u2208 V , the following bound holds for any j \u2208 V and any x \u2208 K T\u2211 t=1 (ft,j(x \u2217 i (t))\u2212 ft,j(x))\n\u2264 2L T\u2211 t=1 \u2225\u2225xj(t)\u2212 x\u2217j (t)\u2225\u2225+ T\u2211 t=1 (f\u0303t,j(x \u2217 i (t))\u2212 f\u0303t,j(x)).\nProof. By definition of f\u0303t,j(x) and the Lipschitz-ness of ft,j(x), for any x \u2208 K, we have\u2223\u2223\u2223f\u0303t,j(x)\u2212 ft,j(x)\u2223\u2223\u2223 \u2264 L\u2225\u2225xj(t)\u2212 x\u2217j (t)\u2225\u2225 . Then by plugging in two auxiliary terms in each difference\nft,j(x \u2217 i (t))\u2212 ft,j(x), we obtain T\u2211 t=1 (ft,j(x \u2217 i (t))\u2212 ft,j(x))\n= T\u2211 t=1 (ft,j(x \u2217 i (t))\u2212 f\u0303t,j(x\u2217i (t)) + f\u0303t,j(x)\u2212 ft,j(x)\n+ f\u0303t,j(x \u2217 i (t))\u2212 f\u0303t,j(x))\n\u2264 T\u2211 t=1 \u2223\u2223\u2223ft,j(x\u2217i (t))\u2212 f\u0303t,j(x\u2217i (t))\u2223\u2223\u2223 +\nT\u2211 t=1 \u2223\u2223\u2223f\u0303t,j(x)\u2212 ft,j(x)\u2223\u2223\u2223 +\nT\u2211 t=1 (f\u0303t,j(x \u2217 i (t))\u2212 f\u0303t,j(x))\n\u2264 2L T\u2211 t=1 \u2225\u2225xj(t)\u2212 x\u2217j (t)\u2225\u2225+ T\u2211 t=1 (f\u0303t,j(x \u2217 i (t))\u2212 f\u0303t,j(x)).\nNotice that the last summation in the above bound is exactly the part of the regret of D-ODA incurred by learner j with respect to learner i. Thus, to proceed, we require lemmas that allow us to relate the iterates xi(t) to the iterates x\u2217i (t). Let ht,i(x) = Ft,i(x) \u2212 Ft,i(x\u2217i (t)) and ht,i = ht,i(xi(t)). In the following, we first present a lemma that establishes the recursion between ht+1,i and ht,i.\nLemma 2. The following recursion between ht+1,i and ht,i holds for any i \u2208 V and any t = 1, \u00b7 \u00b7 \u00b7 , T\nht+1,i \u2264 (1\u2212 \u03c3t,i)ht,i + \u03c32t,iD2 + \u03b7i \u2016zi(t+ 1)\u2212 zi(t)\u2016 \u221a ht+1,i,\nwhere zi(t) denotes the dual variable defined in D-OCG.\nProof. Using the definitions of ht,i(x) and xi(t + 1), the fact that Ft,i(x) are 2-smooth and the boundedness of K, we obtain\nht,i(xi(t+ 1)) = Ft,i(xi(t) + \u03c3t,i(vi(t)\u2212 xi(t))) \u2212 Ft,i(x\u2217i (t)) \u2264 Ft,i(xi(t))\u2212 Ft,i(x\u2217i (t))\n+ \u03c3t,i \u3008\u2207Ft,i(xi(t)) , vi(t)\u2212 xi(t)\u3009\n+ \u03c32t,i \u2016vi(t)\u2212 xi(t)\u2016 2\n\u2264 Ft,i(xi(t))\u2212 Ft,i(x\u2217i (t)) + \u03c3t,i \u3008\u2207Ft,i(xi(t)) , vi(t)\u2212 xi(t)\u3009 + \u03c32t,iD 2.\nBy the optimality of vi(t), we have\n\u3008\u2207Ft,i(xi(t)) , vi(t)\u3009 \u2264 \u3008\u2207Ft,i(xi(t)) , x\u2217i (t)\u3009 .\nBy the convexity of Ft,i(x), we have\n\u3008\u2207Ft,i(xi(t)) , x\u2217i (t)\u2212 xi(t)\u3009 \u2264 Ft,i(x\u2217i (t))\u2212Ft,i(xi(t)).\nPutting the above three inequalities together, we obtain\nht,i(xi(t+ 1)) \u2264 Ft,i(xi(t))\u2212 Ft,i(x\u2217i (t)) + \u03c3t,i(Ft,i(x \u2217 i (t))\u2212 Ft,i(xi(t)))\n+ \u03c32t,iD 2\n= (1\u2212 \u03c3t,i)(Ft,i(xi(t))\u2212 Ft,i(x\u2217i (t))) + \u03c32t,iD 2 = (1\u2212 \u03c3t,i)ht,i + \u03c32t,iD2.\nNext, by definition of ht+1,i and the optimality of x\u2217i (t), we have\nht+1,i = Ft+1,i(xi(t+ 1))\u2212 Ft+1,i(x\u2217i (t+ 1)) = Ft,i(xi(t+ 1))\u2212 Ft,i(x\u2217i (t+ 1))\n+ (Ft+1,i(xi(t+ 1))\u2212 Ft,i(xi(t+ 1))) \u2212 (Ft+1,i(x\u2217i (t+ 1))\u2212 Ft,i(x\u2217i (t+ 1))) \u2264 Ft,i(xi(t+ 1))\u2212 Ft,i(x\u2217i (t))\n+ (Ft+1,i(xi(t+ 1))\u2212 Ft,i(xi(t+ 1))) \u2212 (Ft+1,i(x\u2217i (t+ 1))\u2212 Ft,i(x\u2217i (t+ 1))).\nThen, by definition of Ft+1,i(x) and Ft,i(x), we have\nFt+1,i(x)\u2212 Ft,i(x) = \u03b7i \u3008zi(t+ 1)\u2212 zi(t),x\u3009 .\nThus,\nht+1,i \u2264 ht,i(xi(t+ 1)) + \u03b7i \u3008zi(t+ 1)\u2212 zi(t),xi(t+ 1)\u3009 \u2212 \u03b7i \u3008zi(t+ 1)\u2212 zi(t),x\u2217i (t+ 1)\u3009\n= ht,i(xi(t+ 1))\n+ \u03b7i \u3008zi(t+ 1)\u2212 zi(t),xi(t+ 1)\u2212 x\u2217i (t+ 1)\u3009 \u2264 ht,i(xi(t+ 1))\n+ \u03b7i \u2016zi(t+ 1)\u2212 zi(t)\u2016 \u2016xi(t+ 1)\u2212 x\u2217i (t+ 1)\u2016 .\nThe last inequality follows from the Cauchy-Schwarz inequality.\nNow, we derive the bound for \u2016xi(t+ 1)\u2212 x\u2217i (t+ 1)\u2016. By definition, Ft,i(x) are 2-strongly convex and x\u2217i (t) = arg minx\u2208K Ft,i(x). Thus, using the property of strongly convex functions, for any x \u2208 K, we have\n\u2016x\u2212 x\u2217i (t)\u2016 2 \u2264 Ft,i(x)\u2212 Ft,i(x\u2217i (t)).\nAnalogously, it is easy to deduce that\n\u2016xi(t+ 1)\u2212 x\u2217i (t+ 1)\u2016 \u2264 \u221a ht+1,i.\nCombining this bound and the above two bounds for ht+1,i and ht,i(xi(t+ 1)) yields the stated recursion.\nTo make the above recursion more concrete, it remains to bound the deviation term \u2016zi(t+ 1)\u2212 zi(t)\u2016, which measures the stability of local dual variables over each node.\nLemma 3. For any i \u2208 V and any t = 1, \u00b7 \u00b7 \u00b7 , T , the dual variables zi(t) and zi(t + 1) specified in D-OCG satisfy the following bound\n\u2016zi(t+ 1)\u2212 zi(t)\u2016 \u2264 1 + \u03c32(P ) 1\u2212 \u03c32(P ) \u221a nL+ L.\nProof. Let P r denote the r-th power of matrix P and P rij denote the j-th entry of the i-th row of P r. Then, via a bit of algebra, we can get the following generalized recursion\nzi(t+ 1) = n\u2211 j=1 P t+1\u2212sij zj(s) + t\u22121\u2211 r=s n\u2211 j=1 P t\u2212rij gj(r)\n+ gi(t).\nClearly, this recursion reduces to the standard dual variable update in D-OCG when s = t. Next, since zj(1) = 0, by setting s = 1, we can obtain\nzi(t+ 1) = t\u22121\u2211 r=1 n\u2211 j=1 P t\u2212rij gj(r) + gi(t).\nThen by assuming P 0 to be the identity matrix In, we have zi(t+1)\u2212zi(t) = t\u22121\u2211 r=1 n\u2211 j=1 (P t\u2212rij \u2212 P t\u2212r\u22121 ij )gj(r)+gi(t).\nUsing the fact that \u2016gi(t)\u2016 \u2264 L, the properties of norm functions and the symmetry of matrix P , we obtain\n\u2016zi(t+ 1)\u2212 zi(t)\u2016\n= \u2225\u2225\u2225\u2225\u2225\u2225 t\u22121\u2211 r=1 n\u2211 j=1 (P t\u2212rij \u2212 P t\u2212r\u22121 ij )gj(r) + gi(t) \u2225\u2225\u2225\u2225\u2225\u2225 \u2264\nt\u22121\u2211 r=1 n\u2211 j=1 \u2223\u2223P t\u2212rij \u2212 P t\u2212r\u22121ij \u2223\u2223 \u2225\u2225gj(r)\u2225\u2225+ \u2016gi(t)\u2016 \u2264 L\nt\u22121\u2211 r=1 \u2225\u2225P t\u2212ri \u2212 P t\u2212r\u22121i \u2225\u22251 + L, where P ri denotes the i-th column of matrix P r.\nNow we try to bound the L1 norm sum in the above inequality. By plugging in an all-ones column vector and then using the properties of norm functions, we obtain\nt\u22121\u2211 r=1 \u2225\u2225P t\u2212ri \u2212 P t\u2212r\u22121i \u2225\u22251 =\nt\u22121\u2211 r=1 \u2225\u2225(P t\u2212ri \u2212 1/n)\u2212 (P t\u2212r\u22121i \u2212 1/n)\u2225\u22251 \u2264\nt\u22121\u2211 r=1 ( \u2225\u2225P t\u2212ri \u2212 1/n\u2225\u22251 + \u2225\u2225P t\u2212r\u22121i \u2212 1/n\u2225\u22251).\nTo proceed, we introduce a useful property of stochastic matrices (Duchi et al., 2012). Let \u2206n = {x \u2208 Rn |x 0, \u2211n i=1 xi = 1} denote the n-dimensional probability simplex. Then for any positive integer s = 1, \u00b7 \u00b7 \u00b7 and any x \u2208 \u2206n, the following inequality holds\n\u2016P sx\u2212 1/n\u20161 \u2264 \u03c32(P ) s \u221a n.\nTaking x to be the i-th canonical basis vector ei in Rn, we have\n\u2016P sei \u2212 1/n\u20161 \u2264 \u03c32(P ) s \u221a n.\nNote that this inequality also holds for s = 0 since\u2225\u2225P 0ei \u2212 1/n\u2225\u22251 = 2(n\u2212 1)n \u2264 \u221an, for any n = 1, \u00b7 \u00b7 \u00b7 . In addition, it is easy to verify that\n\u2016P si \u2212 1/n\u20161 = \u2016P sei \u2212 1/n\u20161.\nThus, we have\nt\u22121\u2211 r=1 ( \u2225\u2225P t\u2212ri \u2212 1/n\u2225\u22251 + \u2225\u2225P t\u2212r\u22121i \u2212 1/n\u2225\u22251)\n\u2264 t\u22121\u2211 r=1 (\u03c32(P ) t\u2212r + \u03c32(P ) t\u2212r\u22121) \u221a n\n= 1 + \u03c32(P )\n1\u2212 \u03c32(P ) (1\u2212 \u03c32(P )t\u22121)\n\u221a n\n\u2264 1 + \u03c32(P ) 1\u2212 \u03c32(P ) \u221a n.\nThe above equation and the last inequality follow respectively from the summation formula of geometric series and the fact that \u03c32(P ) < 1 when P is a doubly stochastic matrix (Berman & Plemmons, 1979).\nCombining the above together yields the stated bound.\nCombining the results in Lemma 2 and Lemma 3, we can obtain a more concrete recursion between ht+1,i and ht,i, and then deduce the bound for ht,i.\nLemma 4. Assume that the parameters \u03b7i and \u03c3t,i in DOCG are chosen such that \u03b7i(\n1+\u03c32(P ) 1\u2212\u03c32(P )\n\u221a n+1)L \u221a ht+1,i \u2264\n\u03c32t,iD 2. Then the following bound for ht,i holds for any i \u2208 V and any t = 1, \u00b7 \u00b7 \u00b7 , T\nht,i \u2264 4D2\u03c3t,i.\nThis lemma can be easily proved using mathematical induction and we place its detailed proof in the Appendix. Now we can deduce the bound for the deviation between xi(t) and x\u2217i (t). Lemma 5. For any fixed i \u2208 V , the iterates xi(t) and x\u2217i (t) satisfy the following bound\nT\u2211 t=1 \u2016xi(t)\u2212 x\u2217i (t)\u2016 \u2264 8 3 DT 3/4.\nProof. As is given in the proof of Lemma 2, for any x \u2208 K, we have\n\u2016x\u2212 x\u2217i (t)\u2016 2 \u2264 Ft,i(x)\u2212 Ft,i(x\u2217i (t)).\nIt then follows that \u2016xi(t)\u2212 x\u2217i (t)\u2016 \u2264 \u221a Ft,i(xi(t))\u2212 Ft,i(x\u2217i (t))\n= \u221a ht,i \u2264 2D\u221a\u03c3t,i = 2Dt\u22121/4.\nThe last inequality follows from the bound in Lemma 4 and the last equation follows from the definition of \u03c3t,i. Thus, summing over t = 1, \u00b7 \u00b7 \u00b7 , T , we obtain\nT\u2211 t=1 \u2016xi(t)\u2212 x\u2217i (t)\u2016 \u2264 2D T\u2211 t=1 t\u22121/4\n\u2264 2D(1 + \u222b T 1 t\u22121/4dt)\n= 2D(1 + 4\n3 t3/4 \u2223\u2223\u2223\u2223T 1 )\n\u2264 2D(4 3 T 3/4 \u2212 1 3 ) = 8\n3 DT 3/4.\nBefore proceeding with the final proof of Theorem 1, we present the regret bound of the D-ODA algorithm applied to the loss functions f\u0303t,j(x). To this end, we first introduce an auxiliary sequence which are composed of the centralized averages of dual variables over all nodes at each iteration\nz\u0304(t) = 1\nn n\u2211 i=1 zi(t).\nNote that the dual variables used in the above definition are exactly those specified in D-OCG. Then, as for the deviation between the local dual variable zi(t) and the global dual variable z\u0304(t), we have the following lemma. Lemma 6. For any i \u2208 V and any t = 1, \u00b7 \u00b7 \u00b7 , T , the dual variable zi(t) defined in D-OCG and their averages z\u0304(t) over all nodes satisfy the following bound\n\u2016zi(t)\u2212 z\u0304(t)\u2016 \u2264 \u221a nL\n1\u2212 \u03c32(P ) .\nTwo similar bounds for \u2016zi(t)\u2212 z\u0304(t)\u2016 in D-ODA are reported in (Duchi et al., 2012) (Hosseini et al., 2013)1 . Our bound is tighter than both of them. The proof is a little bit similar to that in Lemma 3 and is presented in detail in the Appendix.\nWe can now give the regret bound for the D-ODA algorithm in the following lemma. Lemma 7. The D-ODA algorithm with regularization \u03c8(x) = \u2016x\u2212 x1(1)\u20162 and parameters \u03b1i(t) = \u03b7, \u2200 i \u2208 V , applied to the loss functions f\u0303t,j(x) attains the following regret bound\nRaT (xi,x) \u2264 6 \u221a n+ 1\u2212 \u03c32(P )\n2(1\u2212 \u03c32(P )) \u03b7L2T +\n1 \u03b7 D2.\nUsing our tighter bound for \u2016zi(t)\u2212 z\u0304(t)\u2016, this lemma can be easily deduced from the general regret bound for the DODA algorithm (Hosseini et al., 2013). The detailed proof is presented in the Appendix.\nNow, we are ready to prove our theorem.\nProof of Theorem 1. By plugging in two auxiliary terms in each difference ft,j(xi(t))\u2212 ft,j(x), we have T\u2211 t=1 (ft,j(xi(t))\u2212 ft,j(x))\n= T\u2211 t=1 (ft,j(xi(t))\u2212 ft,j(x\u2217i (t)) + ft,j(x\u2217i (t))\u2212 ft,j(x))\n\u2264 T\u2211 t=1 |ft,j(xi(t))\u2212 ft,j(x\u2217i (t))|\n+ T\u2211 t=1 (ft,j(x \u2217 i (t))\u2212 ft,j(x)).\nUsing the Lipschitz-ness of ft,j(x), we can obtain the following bound for the first summation T\u2211 t=1 |ft,j(xi(t))\u2212 ft,j(x\u2217i (t))| \u2264 L T\u2211 t=1 \u2016xi(t)\u2212 x\u2217i (t)\u2016 .\n1Strictly, the norm utilized in them is the general dual norm.\nRecall that Lemma 1 provides the bound for the second summation. Combining these two bounds together, we have T\u2211 t=1 (ft,j(xi(t))\u2212 ft,j(x))\n\u2264 L T\u2211 t=1 \u2016xi(t)\u2212 x\u2217i (t)\u2016+ 2L T\u2211 t=1 \u2225\u2225xj(t)\u2212 x\u2217j (t)\u2225\u2225 +\nT\u2211 t=1 (f\u0303t,j(x \u2217 i (t))\u2212 f\u0303t,j(x)).\nHence,\nRT (xi,x) = n\u2211 j=1 T\u2211 t=1 (ft,j(xi(t))\u2212 ft,j(x))\n\u2264 nL T\u2211 t=1 \u2016xi(t)\u2212 x\u2217i (t)\u2016\n+ 2L n\u2211 j=1 T\u2211 t=1 \u2225\u2225xj(t)\u2212 x\u2217j (t)\u2225\u2225 +\nn\u2211 j=1 T\u2211 t=1 (f\u0303t,j(x \u2217 i (t))\u2212 f\u0303t,j(x)).\nNote that, as the parameters are set to be \u03b71 = \u00b7 \u00b7 \u00b7 = \u03b7n = \u03b7, the last term in the right side is exactly the regret of the D-ODA algorithm applied to f\u0303t,j(x). In addition, using the results in Lemma 5, the sum of the first and the second terms is further bounded by 8nLDT 3/4. Thus, we have\nRT (xi,x) \u2264 8nLDT 3/4 +RaT (xi,x)\n\u2264 8nLDT 3/4 + 6 \u221a n+ 1\u2212 \u03c32(P )\n2(1\u2212 \u03c32(P )) \u03b7L2T\n+ 1\n\u03b7 D2.\nLet \u03b7 = (1\u2212\u03c32(P ))D 2( \u221a n+1+( \u221a n\u22121)\u03c32(P ))LT 3/4\n. Then via a bit of analysis, we can verify that the choice of \u03b7i satisfies the constraint required in Lemma 4\n\u03b7i( 1 + \u03c32(P ) 1\u2212 \u03c32(P ) \u221a n+ 1)L\n\u221a ht+1,i \u2264 \u03c32t,iD2.\nThe detailed verification is presented in the Appendix.\nWe thus finally obtain\nRT (xi,x) \u2264 8nLDT 3/4\n+ 6 \u221a n+ 1\u2212 \u03c32(P )\n4( \u221a n+ 1 + ( \u221a n\u2212 1)\u03c32(P )) LDT 1/4\n+ 2( \u221a n+ 1 + ( \u221a n\u2212 1)\u03c32(P ))\n1\u2212 \u03c32(P ) LDT 3/4."}, {"heading": "4. Experiments", "text": "To evaluate the performance of the proposed D-OCG algorithm, we conduct simulation experiments for a popular machine learning problem: multiclass classification."}, {"heading": "4.1. Experimental Setup", "text": "Multiclass Classification In the distributed online learning setting, the problem is as follows. At each round t = 1, \u00b7 \u00b7 \u00b7 , T , each learner i is presented with a data example ei(t) \u2208 Rk which belongs to one of the classes C = {1, \u00b7 \u00b7 \u00b7 , h} and is required to generate a decision matrix Xi(t) = [xT1 ; \u00b7 \u00b7 \u00b7 ;xTh ] \u2208 Rh\u00d7k that predicts the class label with arg max`\u2208C xT` ei(t). Then the adversary reveals the true class labels yi(t) and each learner i suffers a convex multivariate logistic loss\nft,i(Xi(t)) = log ( 1+ \u2211\n` 6=yi(t)\nexp(xT` ei(t)\u2212 xTyi(t)ei(t)) ) .\nThe convex domain of the decision matrices is K = {X \u2208 Rh\u00d7k| \u2016X\u2016tr \u2264 \u03c4}, where \u2016\u00b7\u2016tr denotes the nuclear norm of matrices. In this case, the linear minimization required in each iteration of D-OCG amounts to compute a matrix\u2019s top singular vector, an operation that can be done in time near linear to the number of non-zeros in the matrix, whereas the projection onto K operation needed in traditional distributed online algorithms amounts to performing a full SVD, an O(hkmin(h, k)) time operation that is much more expensive.\nDatasets We use two multiclass datasets selected from the LIBSVM2 repository with relatively large number of instances, which is summarized in Table 1.\nNetwork Topology To investigate the influence of network topology, we conduct our experiments on three types of graphs, which represent different levels of connectivity.\n\u2022 Complete graph. This represents the highest level of connectivity in our experiments: all nodes are connected to each other.\n\u2022 Cycle graph. This represents the lowest level of connectivity in our experiments: each node has only two immediate neighbors.\n\u2022 Watts-Strogatz. This random graph generation technique (Watts & Strogatz, 1998) has two tunable pa-\n2https://www.csie.ntu.edu.tw/ cjlin/libsvmtools/datasets/\nrameters: the average degree of the graph k and the rewiring probability p. In general, the higher the rewiring probability, the better the connectivity of the graph (Colin et al., 2016). We tune the parameters k = 4 and p = 0.3 to achieve an intermediate level of connectivity in our experiments.\nCompared Algorithms To evaluate the performance benefit of D-OCG over its counterparts with projection operation, we compare it with two classic algorithms: DOGD (Yan et al., 2013) and D-ODA (Hosseini et al., 2013). To verify that performing online conditional gradient in the distributed setting does not lose much quality compared with that in the centralized setting, we also compare DOCG with OCG, i.e. D-OCG with 1 node.\nParameter Settings We set most of the parameters in these algorithms as what their corresponding theories suggest. For instance, the parameters \u03c3t,i in D-OCG are strictly set to be 1\u221a\nt and the learning rates in D-OGD are\nset to be the typical decaying sequence 1\u221a t . We use the method utilized in (Duchi et al., 2012) to generate the doubly stochastic matrices and fix the nuclear norm bound \u03c4 to 50 throughout."}, {"heading": "4.2. Experimental Results", "text": "We measure the running time of the D-OGD, D-ODA and D-OCG algorithms run on a complete graph with 9 nodes and see how fast the average losses decrease. From the results shown in Figure 1, we can clearly observe that DOCG is significantly faster than both D-OGD and D-ODA, which illustrates the necessity and usefulness of using conditional gradient in distributed online learning.\nWe then investigate how the number of nodes affects the performance of D-OCG by running experiments on complete graphs with varying number of nodes. From the results shown in Figure 2(a), we can make the following two main observations. First, the average losses decrease\nmore slowly on larger graphs than on smaller graphs, which nicely confirms our theoretical results. Second, D-OCG is able to yield comparable results to the centralized OCG.\nWe finally test the influence of network topology on the algorithm\u2019s performance. We run experiments on the aforementioned three types of graphs with 16 nodes using the aloi dataset. As shown in Figure 2(b), graphs with better connectivity lead to slightly faster convergence, which illustrates good agreement of empirical results with our theoretical predictions."}, {"heading": "5. Conclusion", "text": "In this paper, we propose the distributed online conditional gradient algorithm for projection-free distributed online learning in networks. We give detailed analysis of the regret bound for the proposed algorithm, which depends on both the network size and the network topology. We evaluate the efficacy of the proposed algorithm on two real-world datasets for a multiclass classification task and find that it runs significantly faster than the counterpart algorithms with projection. The theoretical results regarding the regret bound for different graphs have also been verified."}, {"heading": "Acknowledgements", "text": "This work is supported by National Program on Key Basic Research Project No. 2015CB352300 and National Natural Science Foundation of China Major Project No. U1611461. It is also supported by the National Research Foundation, Prime Ministers Office, Singapore under its International Research Centres in Singapore Funding Initiative. We thank Zheng Xiong for helping constructing the networks and thank Wei Liu for his kind help in preparing the submission and the rebuttal. We finally acknowledge anonymous reviewers for their insightful comments on comparison and explanation of the regret bound."}], "year": 2017, "references": [{"title": "Nonnegative Matrices in the Mathematical Sciences", "authors": ["Berman", "Abraham", "Plemmons", "Robert J"], "year": 1979}, {"title": "Coresets, sparse greedy approximation, and the frank-wolfe algorithm", "authors": ["Clarkson", "Kenneth L"], "venue": "ACM Transactions on Algorithms (TALG),", "year": 2010}, {"title": "Gossip dual averaging for decentralized optimization of pairwise functions", "authors": ["Colin", "Igor", "Bellet", "Aurelien", "Salmon", "Joseph", "Cl\u00e9men\u00e7on", "St\u00e9phan"], "venue": "In International Conference on Machine Learning,", "year": 2016}, {"title": "Dual averaging for distributed optimization: convergence analysis and network scaling", "authors": ["Duchi", "John C", "Agarwal", "Alekh", "Wainwright", "Martin J"], "venue": "IEEE Transactions on Automatic Control,", "year": 2012}, {"title": "Lifted coordinate descent for learning with trace-norm regularization", "authors": ["Dud\u0131\u0301k", "Miroslav", "Malick", "J\u00e9r\u00f4me"], "venue": "In International Conference on Artificial Intelligence and Statistics,", "year": 2012}, {"title": "An algorithm for quadratic programming", "authors": ["Frank", "Marguerite", "Wolfe", "Philip"], "venue": "Naval Research Logistics Quarterly,", "year": 1956}, {"title": "Faster projection-free convex optimization over the spectrahedron", "authors": ["Garber", "Dan"], "venue": "In Advances In Neural Information Processing Systems,", "year": 2016}, {"title": "A linearly convergent variant of the conditional gradient algorithm under strong convexity, with applications to online and stochastic optimization", "authors": ["Garber", "Dan", "Hazan", "Elad"], "venue": "SIAM Journal on Optimization,", "year": 2016}, {"title": "Conditional gradient algorithms for normregularized smooth convex optimization", "authors": ["Harchaoui", "Zaid", "Juditsky", "Anatoli", "Nemirovski", "Arkadi"], "venue": "Mathematical Programming,", "year": 2015}, {"title": "Projection-free online learning", "authors": ["Hazan", "Elad", "Kale", "Satyen"], "venue": "In International Conference on Machine Learning,", "year": 2012}, {"title": "Variance-reduced and projection-free stochastic optimization", "authors": ["Hazan", "Elad", "Luo", "Haipeng"], "venue": "In International Conference on Machine Learning,", "year": 2016}, {"title": "Online distributed optimization via dual averaging", "authors": ["Hosseini", "Saghar", "Chapman", "Airlie", "Mesbahi", "Mehran"], "venue": "In IEEE Conference on Decision and Control,", "year": 2013}, {"title": "Revisiting frank-wolfe: projection-free sparse convex optimization", "authors": ["Jaggi", "Martin"], "venue": "In International Conference on Machine Learning,", "year": 2013}, {"title": "Decentralized online optimization with global objectives and local communication", "authors": ["Lee", "Soomin", "Nedic", "Angelia", "Raginsky", "Maxim"], "venue": "arXiv preprint arXiv:1508.07933,", "year": 2015}, {"title": "Primal-dual subgradient methods for convex problems", "authors": ["Nesterov", "Yurii"], "venue": "Mathematical programming,", "year": 2009}, {"title": "Distributed stochastic subgradient projection algorithms for convex optimization", "authors": ["Ram", "S Sundhar", "Nedi\u0107", "Angelia", "Veeravalli", "Venugopal V"], "venue": "Journal of optimization theory and applications,", "year": 2010}, {"title": "Collective dynamics of small-worldnetworks", "authors": ["Watts", "Duncan J", "Strogatz", "Steven H"], "year": 1998}, {"title": "Dual averaging methods for regularized stochastic learning and online optimization", "authors": ["Xiao", "Lin"], "venue": "Journal of Machine Learning Research,", "year": 2010}, {"title": "Distributed autonomous online learning: Regrets and intrinsic privacy-preserving properties", "authors": ["Yan", "Feng", "Sundaram", "Shreyas", "SVN Vishwanathan", "Qi", "Yuan"], "venue": "IEEE Transactions on Knowledge and Data Engineering,", "year": 2013}], "id": "SP:5c3d16906d223d19d7c79a3ef177b61b001cc22b", "authors": [{"name": "Wenpeng Zhang", "affiliations": []}, {"name": "Peilin Zhao", "affiliations": []}, {"name": "Wenwu Zhu", "affiliations": []}, {"name": "Steven C. H. Hoi", "affiliations": []}, {"name": "Tong Zhang", "affiliations": []}], "abstractText": "The conditional gradient algorithm has regained a surge of research interest in recent years due to its high efficiency in handling large-scale machine learning problems. However, none of existing studies has explored it in the distributed online learning setting, where locally light computation is assumed. In this paper, we fill this gap by proposing the distributed online conditional gradient algorithm, which eschews the expensive projection operation needed in its counterpart algorithms by exploiting much simpler linear optimization steps. We give a regret bound for the proposed algorithm as a function of the network size and topology, which will be smaller on smaller graphs or \u201dwell-connected\u201d graphs. Experiments on two large-scale real-world datasets for a multiclass classification task confirm the computational benefit of the proposed algorithm and also verify the theoretical regret bound.", "title": "Projection-free Distributed Online Learning in Networks"}