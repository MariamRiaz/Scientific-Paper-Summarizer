{"sections": [{"heading": "1. Introduction", "text": "Consider the following common academic (or similar) hiring scenario: The dean has promised your department 3 faculty slots, in any areas. Your goal is to hire the best candidates possible \u2014 but how should you identify them? An immediate problem is that candidates are incomparable across subfields, because, among other things, standards of publication, citation counts, and letter-writing styles can vary considerably across subfields. An attractive way to rank candidates is according to how strong they are relative to others working in the same field, to whom they are directly comparable. If we model each subfield as corresponding to a different distribution over metrics that are monotonically increasing in candidate quality, this is the value we get when we evaluate the CDF function of the distribution on a candidate\u2019s realized value. But because\n1University of Pennsylvania, Philadelphia, USA. Correspondence to: Zhiwei Steven Wu <steven7woo@gmail.com>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nthe number of candidates each year is small, simply comparing each candidate to their direct competitors this year \u2014 i.e. taking their empirical CDF values as truth \u2014 would lead to a noisy ranking: it could be that due to chance, the best candidate this year in subfield A would be a mediocre candidate in a typical year, and the top two candidates in subfield B would each be the top candidate in a typical year. We would prefer to evaluate our success by considering the unknown true CDF value of each candidate.1 Similar situations, in which we must select a high quality set of candidates from multiple, mutually incomparable groups, arise frequently. Some affirmative action policies are premised on the assertion that SAT scores and other measures may not be directly comparable across different groups (e.g. due to only advantaged groups having the financial resources for test preparation courses and multiple retakes).\nFor various reasons, in these settings we may also be concerned with the fairness of our choices.2 But what should fairness mean? In this paper, we take inspiration from (Dwork et al., 2012) who propose that fairness should mean that \u201csimilar individuals are treated similarly\u201d, where \u201csimilarity\u201d is measured with respect to some task specific metric. In our setting, the natural task-specific metric is the true within-group CDF value for each individual. On its own, this is compatible with the goal of selecting the best candidates, but in our work, the main obstacle is that we do not know the true CDF value of each individual, and can only approximate this from data. We study the degree to which fairness and optimality are compatible with one another in this setting."}, {"heading": "1.1. Our Results", "text": "We study a setting in which we wish to select k individuals out of a pool of n for some task. The individuals are drawn from d populations, each represented by a different\n1Letters of recommendation often seek to communicate this information, with statements like \u201cThis candidate is among the top 5 students I have seen in my 16 years as a professor.\u201d\n2With respect to men\u2019s and women\u2019s sports, equal opportunity is legislated in Title IX. With respect to faculty hiring, fairness concerns can arise because the proportion of women can vary substantially across subfields. For example, as reported in (Cohoon et al., 2011), the percentage of female authors varies from 10% to 44% across ACM conferences, when averaged over the 10 year period from 1998-2008.\ndistribution over real numbers.3 The number of draws from each distribution may differ. The \u201cquality\u201d of an individual is defined to be their (true) CDF value, as evaluated on the distribution from which they were drawn. An algorithm is evaluated based on the (expected) quality of the k individuals it selects.\nThe meritocratic fairness definition we propose informally asks that lower quality individuals are never (probabilistically) favored over higher quality individuals. When formulating this definition, we have a choice as to how to incorporate randomness. The strongest formulation possible (ex-post fairness) does not involve randomness, and simply requires that every individual actually selected has quality at least that of every individual not selected. The weakest formulation (ex-ante fairness) incorporates the randomness of the selection of the population from the underlying distribution, and informally requires that for any pair of individuals, the higher quality individual is selected with weakly higher probability than the lower quality individual, where the randomness is over the realization of the population from the underlying distributions, as well as any internal randomness of the mechanism. An intermediate formulation (ex-interim fairness) requires informally that higher quality individuals be selected with weakly higher probability than lower quality individuals, where the probability is computed over the randomness of the mechanism, but not over the selection of the population. Roughly speaking, these choices correspond to what an individual may know and still be satisfied by a promise of \u201cfairness\u201d. Individuals should be satisfied with ex-post fairness even after the choices of the mechanism are made, with full knowledge of the applicant pool \u2014 that is, they should be satisfied with the actual outcome, regardless of the algorithm used to reach it. In contrast, individuals with full knowledge of the applicant pool should still be satisfied with ex-interim fairness before the mechanism makes its decisions \u2014 that is, they should feel satisfied that the algorithm used is fair. An individual should only be satisfied by ex-ante fairness if she has no knowledge of the applicant pool (and so can consider it a random variable) before the choices are made.\nGiven such a spectrum of fairness constraints, we observe that the strongest ex-post fairness is impossible to achieve, whereas the weakest ex-ante fairness is sometimes easy to achieve: when the population sizes are the same, it is satisfied by the mechanism that simply selects the k individuals with highest empirical CDF values.4 Our main results\n3We study the simple setting in which each individual is represented by a 1-dimensional \u201cscore\u201d \u2014 e.g. a credit score, a time in the 100m dash, etc. \u2014 which itself may encapsulate or summarize many features into a single value. Generalizing this work to richer representations is an interesting direction for future work.\n4However, for the cases in which the populations are not the same size, we do not know of better utility guarantees for ex-ante\ntherefore concern the cost (in terms of the expected quality of the selected applicants) of asking for the stronger notion of ex-interim fairness. We show that satisfying an exact variant of this constraint requires the selection algorithm to select uniformly at random amongst all individuals, and hence obtain only trivial utility guarantees, but that subject to an approximate relaxation of this constraint, it is possible to recover asymptotically optimal utility bounds. We show that when we further relax the problem, to allow the algorithm to select approximately k individuals (rather than exactly k), it is possible to recover asymptotically optimal utility bounds while satisfying ex-post fairness guarantees within each sub-population, and approximate ex-interim fairness guarantees across populations. We summarize our results in Table 1. We complement our theoretical results with empirical simulations which emphasize that both the utility and fairness guarantees of our algorithms are better in practice than our theorems promise.\nFinally, we remark on an interesting property of our upper bounds: they are oblivious, in the sense that they do not make use of the raw scores associated with each individual \u2014 only their empirical CDF ranking. As such, our upper bounds can be viewed as universal distributions over permutations (of empirical CDF rankings) that satisfy a fairness guarantee, rather than algorithms. Our lower bounds apply not just to oblivious algorithms, but to any algorithm, even those that can make use of raw scores (or indeed, even knowledge of the family of distributions from which populations are drawn)."}, {"heading": "1.2. Related Work", "text": "This paper fits into a rapidly growing line of work studying \u201cfairness\u201d in learning settings that is now too large to summarize fully, and so we discuss only the most closely related work. Our definition of fairness is in the spirit of (Dwork et al., 2012), who propose that individual fairness should mean that \u201csimilar individuals are treated similarly\u201d with respect to some underlying task-specific metric. As with the work of (Joseph et al., 2016; Jabbari et al., 2016), we define the metric to be a measure of quality already present in the model (in our case, the CDF values of individuals) but unknown to the algorithm, except through samples. It is this necessity to learn the underlying metric that poses the tension between the fairness constraint and the accuracy goal. Although in this line of work, we adopt a definition that merely requires \u201cbetter individuals be treated better\u201d according to the true unknown metric, this necessarily requires that \u201csimilar individuals be treated similarly\u201d with respect to empirical estimates of the metric.\nTechnically, our work includes adaptations of techniques in\nfairness than those we derive for the stronger notion of ex-interim fairness.\ndifferential privacy (Dwork et al., 2006). Specifically, we adopt variants of the \u201creport noisy max\u201d algorithm (Dwork & Roth, 2014), and Raskhodnikova and Smith\u2019s \u201cexponential mechanism for scores with varying sensitivities\u201d (Raskhodnikova & Smith, 2016), which is itself a variant of the exponential mechanism (McSherry & Talwar, 2007)."}, {"heading": "2. Model and Preliminaries", "text": "There are d different populations, indexed by j. For each population j, there is a pool of candidates with their raw scores (and henceforth observations) drawn i.i.d. from some unknown continuous distribution Fj over R. Let F = F1 \u00d7 \u00b7 \u00b7 \u00b7 \u00d7 Fd denote the product distribution. We will slightly abuse notation and write xij to denote both the individual i in the population j and her associated observation, and write X to denote the set of all candidates. Let mj be the size of the candidate pool from population j, n = \u2211 jmj be the size of the total population, and m = minjmj be the smallest population size. Each individual xij is associated with the following values.\n\u2022 A cumulative distribution function (CDF) value Fj(xij) = PrFj [x < xij ],5 and an empirical CDF value F\u0302j(xij) = 1mj \u2211mj i\u2032=1 1[x < xi\u2032j ].\n\u2022 A complementary cumulative distribution function (CCDF) value: pij = 1 \u2212 Fj(xij) and an empirical CCDF value p\u0302ij = 1mj \u2211mj i\u2032=1 1[x \u2265 xi\u2032j ].\nA selection algorithm A takes all the n observations X drawn from different distributions as input, and (randomly) selects k individuals as outputs. We will write A(X,xij) (or Aij for simplicity) to denote the selection probability over the individual xij . The utility for selecting an individual xij is her true CDF value Fj(xij). Equivalently, the loss for selecting an individual xij is the true CCDF value pij . The loss for an algorithmA on input X is then defined as\nL(A, X) = 1 k \u2211 xij\u2208X A(X,xij)(1\u2212Fj(xij))\n5We adopt a slightly different definition from the standard one: Fj(xij) = PrFj [x \u2264 xij ].\nand the expected loss of the algorithm is EX\u223cF [L(A, X)]."}, {"heading": "2.1. Fairness Formulation", "text": "Our goal is design selection algorithms subject to a meritocratic fairness notion that requires that less qualified candidates (in terms of CDF values) are never preferred over more qualified ones. We will present three different formulations of such notion based on the different forms of randomness we are considering.\nFirst, the weakest formulation is the following ex-ante fairness, which guarantees fairness over the randomness of both the random draws of the candidates and the coin flips of the algorithm.\nDefinition 2.1 (Ex-Ante Fairness). An algorithm A satisfies ex-ante fairness if for any pair of candidates xij , xi\u2032j\u2032 with CDF values Fj(xij) > Fj\u2032(xi\u2032j\u2032), their selection probabilities (when they are in the pool) satisfy\nE [A(X,xij)] \u2265 E [A(X,xi\u2032j\u2032)]\nwhere the expectations are taken over the (n \u2212 2) random draws of all the other candidates.\nAn intermediate formulation of fairness is the following exinterim fairness, which guarantees fairness over the randomness of the algorithms (but not the realizations of X) on almost all of inputs drawn from the distribution.\nDefinition 2.2 (Exact Ex-Interim Fairness). Let \u03b4 \u2208 (0, 1). An algorithm A satisfies \u03b4-exact ex-interim fairness if with probability at least 1\u2212 \u03b4 over the realized observations X , for any pair of individuals xij , xi\u2032j\u2032 \u2208 X ,\nA(X,xij) > A(X,xi\u2032j\u2032) only if Fj(xij) > Fj\u2032(xi\u2032j\u2032)\nWe also consider the following relaxation:\nDefinition 2.3 (Approximate Ex-Interim Fairness). An algorithm A satisfies (\u03b5, \u03b4)-approximate ex-interim fairness if with probability at least 1\u2212 \u03b4 over the realized observations X , for any pair of individuals xij , xi\u2032j\u2032 \u2208 X ,\nA(X,xij) > e\u03b5A(X,xi\u2032j\u2032) only if Fj(xij) > Fj\u2032(xi\u2032j\u2032)\nRemark 2.4. We note that this relaxation of ex-interim fairness bears a similarity to the definition of differential\nprivacy (Dwork et al., 2006), and indeed, techniques from the differential privacy literature will prove useful in designing algorithms to satisfy it.\nPerhaps the strongest formulation is the following ex-post fairness condition, which requires that an individual is selected only if a more qualified individual is also selected. Definition 2.5 (Ex-post Fairness). An algorithmA satisfies ex-post fairness if any pair of individuals xij and xi\u2032j\u2032 such that Fj(xij) > Fj\u2032(xi\u2032j\u2032), the individual xi\u2032j\u2032 is admitted only if xij is also selected.\nNote that any algorithm that satisfies ex-post fairness must admit a prefix of individuals from each population, which is also sufficient to guarantee within population ex-post fairness, but that this is not sufficient to satisfy the constraint between populations.\nIt is not hard to see that satisfying ex-post fairness in the generality that we have defined it is impossible, since it requires perfectly selecting the k true best CDF values from only sample data. Thus, the primary focus of our paper is on ex-interim fairness. Unless we specify differently, the term \u201cfair\u201d and \u201cfairness\u201drefer to ex-interim fairness."}, {"heading": "2.2. Oblivious Algorithms", "text": "A special class of selection algorithms is the class of oblivious algorithms, which select candidates with probabilities that only depend on their empirical CDF values, not on their observations. Definition 2.6 (Oblivious Algorithms). An algorithm A is oblivious if for any pair of input observations X and X \u2032 that induce the same empirical CDF values over the candidates, A(X) = A(X \u2032).\nAll of our algorithms presented in this paper are oblivious. As a result, we need to make no assumption on the underlying distributions to achieve both fairness and utility guarantees. Moreover, the utility guarantee of an oblivious algorithm can be characterized as follows. Lemma 2.7. The expected loss achieved by any oblivious algorithm A is the expected average empirical CCDF values among the selected candidates.\nA very simple example of an oblivious algorithm is GREEDY which selects the k individuals with the highest empirical CDF values (breaking ties uniformly at random). Lemma 2.8. Suppose that the populations sizes are the same, that is, mj = m for each j. The algorithm GREEDY satisfies ex-ante fairness and has an expected loss at most k2n + 1 m .\nTo simplify our bounds on the expected loss, we will use k/2n as our benchmark and define the regret of an algorithm A to beR(A) = EX\u223cF [L(A, X)]\u2212 k2n ."}, {"heading": "3. An Approximately Fair Algorithm", "text": "In this section, we provide an algorithm that satisfies approximate fairness in the sense of Definition 2.3. We will present our solution in three steps.\n1. First, we provide confidence intervals for the candidates\u2019 CCDF values pij based on their empirical CCDF values p\u0302ij . As we show, our bound has a tighter dependence on pij , which gives better utility guarantee than using the standard DKW inequality of Dvoretzky et al. (1956).\n2. Next, we give a simple subroutine NOISYTOP that randomly selects k individuals out of n based on their \u201cscores\u201d. We show that individuals with similar scores will have close selection probabilities under this subroutine. This subroutine is similar to the \u201cReport Noisy Max\u201d algorithm (Dwork & Roth, 2014).\n3. Then, we will use the deviation bound in the first step to assign scores to the candidates. We show that running NOISYTOP based on these scores give approximate fairness and low regret guarantees. These scores are computed in a way similar to the generalized exponential mechanism of Raskhodnikova & Smith (2016)."}, {"heading": "3.1. Confidence Intervals for CCDF Values", "text": "We will first give the following concentration inequality specialized for the uniform distribution over (0, 1).\nLemma 3.1. Fix any n \u2208 N. Let x1, x2, . . . , xn be i.i.d. draws from the uniform distribution over (0, 1). Then with probability at least 1\u2212 \u03b4, for any p \u2208 (0, 1),\n|p\u2212 p\u0302| \u2264 \u221a ln(2n/\u03b4)\n(\u221a 3p\nn +\n2\nn\n)\nwhere p\u0302 = 1n \u2211n i=1 1[xi < p].\nTo translate this result into a deviation bound on the CCDF values, first note that CCDF values for any distribution Fj are drawn from the uniform distribution over (0, 1), so the bound applies immediately to the CCDF values. By a standard calculation, we can also get a bound in terms of the empirical CCDF value p\u0302ij as shown below.\nLemma 3.2. For each j \u2208 [d], draw mj points Xj = {xij} mj i=1 i.i.d. from Fj . For each point xij , let pij be its true CCDF value and p\u0302ij be its empirical CCDF value in Fj . Then with probability at least 1\u2212 \u03b4 over the n random draws,\n|pij \u2212 p\u0302ij | \u2264 9 \u221a p\u0302ij m ln(2n/\u03b4)\nwhere m = minjmj and n = \u2211d j=1mj .\nRemark 3.3. The standard DKW inequality gives a bound of O\u0303( \u221a 1/m). Our bound gives a tighter dependence for small empirical CCDF value p\u0302ij . For example, when p\u0302ij = 1/m, we obtain a bound of O\u0303(1/m). 6"}, {"heading": "3.2. The NoisyTop Subroutine", "text": "Given a set of individuals with scores Y = {y1, . . . , yn}, the subroutine NOISYTOP will first perturb each score by adding independent noise drawn from the Laplace distribution,7 and output the k individuals with the minimum noisy scores (ties broken arbitrarily). We will now show that NOISYTOP has the following desirable \u201cLipschitz\u201d property\u2014individuals with similar scores are chosen with similar probabilities. This is crucial for obtaining approximate fairness.\nAlgorithm 1 NOISYTOP({y1, y2, . . . , yn}, \u03b1, k) Input: n numbers {y1, y2, . . . , yn} and parameter \u03b1\nFor each i \u2208 [n]: let y\u0303i = yi + Lap(\u03b1) Output: the k indices with the smallest y\u0303i\nLemma 3.4. Let i, j \u2208 [n] be such that \u2206 = yi \u2212 yj \u2265 0. Let Pi and Pj denote the probabilities that the two indices i and j are output by NOISYTOP({y1, y2, . . . , yn}, \u03b1) respectively. Then Pi \u2264 Pj \u2264 Pi exp(2\u2206/\u03b1).\nProof. Let y\u0303i and y\u0303j be the noisy scores for i or j. We will introduce a new random variable Q to denote the value of the (k \u2212 1)-st lowest noisy value, not counting y\u0303i and y\u0303j . We will slightly abuse notation and write Pr[R = r] as a shorthand for the pdf of any random variable R evaluated at r. The ratio PiPj can then be written as\u222b q\u2208R Pr[Q = q] (\u222b t\u2208R Pr[y\u0303j = t] Pr[y\u0303i < min{t, q}]dt ) dq\u222b\nq\u2208R Pr[Q = q] (\u222b t\u2208R Pr[y\u0303i = t] Pr[y\u0303j < min{t, q}]dt ) dq\n(1)\nFor any fixed value r \u2208 R, we also have the following based on the Laplace distribution,\nPr[y\u0303i = r] Pr[y\u0303j = r] =\n1 2\u03b1 exp ( \u2212 |r\u2212yi|\u03b1 ) 1 2\u03b1 exp ( \u2212 |r\u2212yj |\u03b1\n) = exp ( |r \u2212 yj | \u03b1 \u2212 |r \u2212 yi| \u03b1\n) By the triangle inequality we know that |r\u2212yj |\u2212|r\u2212yi| \u2264 \u2206. It follows that for any t and q,\nexp(\u2212\u2206/\u03b1) \u2264 Pr[y\u0303i = t] Pr[y\u0303j = t] \u2264 exp(\u2206/\u03b1) and,\n6As shown in Corollary 3.8, this also gives an improvement over regret when k is small (O\u0303( \u221a k/n) versus O\u0303( \u221a 1/n)).\n7The Laplace distribution Lap(b) has density function f(x) = exp(\u2212|x|/b).\nPr[y\u0303i < min{q, t}] Pr[y\u0303j < min{q, t}] = \u222b r<min{q,t} Pr[y\u0303i = r] dr\u222b r<min{q,t} Pr[y\u0303j = r] dr\n\u2264 exp(\u2206/\u03b1)\nPlugging these bounds into Equation (1), we get PiPj \u2264 exp(2\u2206/\u03b1). The inequality that Pi/Pj \u2264 1 follows directly from yi \u2265 yj ."}, {"heading": "3.3. Wrapping Up", "text": "We will present our algorithm FAIRTOP by combining the methods in the previous two sections. In the light of Lemma 3.2, we will define the following confidence interval width function on the empirical CCDF values\nc(p\u0302) = 9 ln(2n/\u03b4) \u221a p\u0302/m\nand a normalized score function s(p\u0302) = p\u0302/c(p\u0302). We have that any candidate is guaranteed a score not much lower than a less qualified one.\nLemma 3.5. Let x, y \u2208 [0, 1] be the (true) CCDF values for two individuals such that x \u2264 y. Let x\u0302, y\u0302 be the empirical CCDF values respectively. Suppose that |x\u2212 x\u0302| \u2264 c(x\u0302) and |y \u2212 y\u0302| \u2264 c(y\u0302), then s(x\u0302)\u2212 s(y\u0302) \u2264 1.\nAlgorithm 2 FAIRTOP(X = {xij}, \u03b5, \u03b4, k,m) Input: candidates\u2019 observations X , fairness parameters \u03b5, \u03b4, number of selected individuals k, and smallest population size m\nFor each individual xij \u2208 X Compute the empirical CCDF value p\u0302ij and the associated score s(p\u0302ij)\nRun NOISYTOP({s(p\u0302ij}, 2/\u03b5, k)\nOur algorithm FAIRTOP (presented in Algorithm 2) proceeds by first computing the normalized score of every candidates based on their empirical CCDF values, and then calling NOISYTOP to output k individuals. We will first establish the approximate fairness guarantee.\nTheorem 3.6. The algorithm FAIRTOP instantiated with parameters \u03b5 and \u03b4 satisfies (\u03b5, \u03b4)-approximate fairness.\nProof sketch. By Lemma 3.2, we know that with probability 1 \u2212 \u03b4, for every candidate xij , the true and empirical CCDF values satisfy |pij \u2212 p\u0302ij | \u2264 c(p\u0302ij). This means that for any pair of individuals a and a\u2032 with CCDF values pa < pa\u2032 (that is, a is more qualified than a\u2032), we also have s(p\u0302a) \u2264 s(p\u0302a\u2032) + 1 by Lemma 3.5. Finally, by the result of Lemma 3.4 and the instantiation of NOISYTOP, we guarantee that a\u2032 will not be selected with substantially higher probability: Aa exp(\u03b5) \u2265 Aa\u2032 , which recovers the approximate fairness guarantee.\nOur algorithm also has a diminishing regret guarantee:\nTheorem 3.7. Fix any \u03b2 \u2208 (0, 1). Then with probability at least 1 \u2212 \u03b2, the algorithm FAIRTOP instantiated with fairness parameters \u03b5 and \u03b4 has regret bounded by(\n1\n\u03b5\n\u221a( k\nn +\n1\nm\n) 1\nm +\n1\nm\u03b52\n) \u00b7 polylog(n, 1/\u03b2, 1/\u03b4)\nThus for example, as the smallest sampled population size m grows (fixing k and \u03b5), our regret rapidly approaches 0. To understand the utility guarantee better, we will state the regret bound for the following natural scaling, which is also examined in the simulations of Section 7:\nCorollary 3.8. Consider an instance with two population of sizesm1 andm2 such thatm1 = \u03b1m2 for some constant \u03b1 \u2265 1. Suppose we instantiate FAIRTOP with parameter \u03b5 = \u0398(1), then the regret is at most O\u0303 (\u221a k m ) ."}, {"heading": "4. Within Population Ex-Post Fairness", "text": "In this section, we provide a variant of the FAIRTOP algorithm that satisfies approximate ex-interim fairness across different populations, but also ex-post fairness within each population. The key idea here is that since we know the ranking of the candidates true qualities within each population, we can guarantee ex-post fairness within populations as long as we select a prefix of candidates in each population. This will however come at a cost \u2014 our algorithm will no longer select exactly k individuals, but only approximately k individuals.\nSimilar to FAIRTOP, the algorithm ABOVETHRE (presented in Algorithm 3) also computes the normalized scores for each candidate. Instead of perturbing the scores, ABOVETHRE computes a noisy threshold Tj for each population by adding Laplace noise to s(k/n). The algorithm then selects all candidates with scores above the noisy threshold. Because the algorithm selects a prefix of the raw scores within each population, within population ex-post fairness is immediate. We also show that ABOVETHRE also achieves approximate ex-interim fairness.\nTheorem 4.1. The algorithm ABOVETHRE instantiated with fairness parameters \u03b5 and \u03b4 satisfies both (\u03b5, \u03b4)approximate ex-interim fairness and ex-post fairness within each population.\nNote that were the algorithm to take all the individuals with scores above s(k/n), it would select a (k/n) fraction from each population and therefore select k people in total. Due to the noisy thresholds, the algorithm will only select approximately k individuals. We will now establish the utility guarantee of ABOVETHRE and show that the number of selected individuals is roughly k\u00b1 O\u0303( \u221a k) when m = \u0398(n).\nAlgorithm 3 ABOVETHRE(X = {xij}, \u03b5, \u03b4, k,m) Input: observations X , fairness parameters \u03b5, \u03b4, target number of selected individuals k, smallest population size m\nFor each individual xij Compute her empirical CCDF value p\u0302ij and the associated score s(p\u0302ij) For each population j Compute a noisy threshold Tj = s(k/n)+\u03bdj where \u03bdj is drawn from Lap(1/\u03b5) Select candidates xij with scores s(p\u0302ij) above Tj\nTheorem 4.2. Fix any \u03b2 \u2208 (0, 1). With probability at least 1 \u2212 \u03b2, the algorithm ABOVETHRE instantiated with fairness parameters \u03b5 and \u03b4 has regret bounded by(\n1\nm\u03b52 +\n\u221a k\n\u03b5 \u221a mn\n) \u00b7 polylog(n, d, 1/\u03b4, 1/\u03b2),\nand selects a total number of k\u0302 individuals with\n|k \u2212 k\u0302| \u2264 d+\n( n\nm\u03b52 +\n\u221a nk \u03b5 \u221a m\n) \u00b7 polylog(n, d, 1/\u03b4, 1/\u03b2)"}, {"heading": "5. Lower Bound for Exact Fairness", "text": "We will show that it is impossible to achieve exact exinterim fairness with non-trivial regret guarantees.\nTheorem 5.1. Fix any \u03b4 < 0.0002 and any \u03b4-fair algorithm A. There exist two distributions F1 and F2 over the two populations such that if algorithm A takes m observations drawn from each distribution as input, and must select at least k = \u2126(m1/2+\u03b1) individuals for any \u03b1 > 0, A incurs a regret of \u2126(1).\nThe main idea is to show that there exist distributions F1 and F2 such that any fair algorithm will essentially have to select uniformly at random across \u2126(m) individuals, which incurs regret \u2126(1). We will proceed via Bayesian reasoning. Suppose that the observations from the two populations are drawn from two different unit-variance Gaussian distributions N (\u00b51, 1) and N (\u00b52, 1), and both means \u00b51 and \u00b52 are themselves drawn from the prior N (0, 1). The following lemma characterizes the posterior distribution on the mean given a collection of observations.\nLemma 5.2. (Murphy, 2007) Suppose that a mean parameter \u00b5 is drawn from a prior distribution N (0, 1). Let D = (x1, x2, . . . , xm) be m i.i.d. draws from the distributionN (\u00b5, 1). Then the posterior distribution of \u00b5 conditioned on D is the Gaussian distribution N (\u00b5\u0302, \u03c32), where \u00b5\u0302 = \u2211 i xi\nm+1 and \u03c3 2 = 1m+1 .\nThe result above shows that conditioned on any m draws from the Gaussian distribution, there is constant probability that the true mean will be bounded away from the posterior maximum likelihood estimate by at least \u2126(1/ \u221a m). With this observation, we will partition the real line into the following intervals: Given any posterior mean \u00b5\u0302 any integer r \u2265 1, let the two intervals I+r (\u00b5\u0302) and I\u2212r (\u00b5\u0302) be\nI+r (\u00b5\u0302) = [\u00b5\u0302+ (r \u2212 1)/ \u221a m, \u00b5\u0302+ r/ \u221a m] and I\u2212r (\u00b5\u0302) = [\u00b5\u0302\u2212 r/ \u221a m, \u00b5\u0302\u2212 (r \u2212 1)/ \u221a m]\nThe intervals capture the uncertainty we have regarding the CDF values of the observations xij . Let Xj = (x1j , x2j , . . . , xmj} denote the m draws from each distributionFj , \u00b5\u0302j = \u2211 i xij m+1 be the posterior mean for \u00b5j conditioned on the draws. Consider two individuals xi1 and xi\u20322 such that xi1 \u2208 I+r (\u00b5\u03021) and xi\u20322 \u2208 I+r+1(\u00b5\u03022). Even though (xi\u20322 \u2212 \u00b5\u03022) > (xi1 \u2212 \u00b5\u03021), there is a constant probability that their CDF values satisfy F1(xi1) > F2(xi\u20322). Any fair algorithm therefore must play these two individuals in these \u201cneighboring\u201d intervals with equal probabilities.\nNext, we show that with high probability over the realizations of the true mean \u00b5 and the m draws X , all of the O(m logm) intervals around the posterior mean will be \u201chit\u201d by points in X . Lemma 5.3. Fix any c < 1 and \u03b2 \u2208 (0, 1). Let mean \u00b5 be drawn from N (0, 1), r\u0302 = \u221a cm logm + 1 and X = (x1, x2, . . . , xm) be m i.i.d. draws from N (\u00b5, 1). Let \u00b5\u0302 = \u2211 i xi\nm+1 . Then except with probability 2r\u0302 exp ( \u2212m\n(1/2\u2212c/2) \u221a 2A\n) + 3\u03b2 over the joint realizations of \u00b5\nand X , the following holds\n\u2022 for all r \u2264 r\u0302 \u2212 2 \u221a\n2 ln(2/\u03b2), there exist two draws x+r , x \u2212 r \u2208 X such that x+r \u2208 I+r (\u00b5\u0302) and x\u2212r \u2208 I\u2212r (\u00b5\u0302); \u2022 the number of points that are bigger than \u00b5\u0302 + (r\u0302 \u2212 2 \u221a 2 ln(2/\u03b2))/ \u221a m is no more than\nm1\u2212c/2 +m1/2\u2212c/4 \u221a 3 ln(1/\u03b2)\nWe show that the event that all of the consecutive intervals are occupied for both populations will force a fair algorithm to play all the individuals in these intervals with equal probability. More formally, fix any c and sufficiently small constant \u03b2, let r\u0302 = \u221a cn log n+ 1 and let Y = {xij | xij \u2208\nI+r (\u00b5\u0302j) \u2228 xij \u2208 I\u2212r (\u00b5\u0302j) for some r \u2264 r\u0302 \u2212 2 \u221a\n2 ln(2/\u03b2)}. Consider the following events:\n\u2022 FULLCHAIN(X1, X2): for all r \u2264 r\u0302 \u2212 2 \u221a\n2 ln(2/\u03b2) and j \u2208 {1, 2}, both the intervals I+r (\u00b5\u0302j), I\u2212r (\u00b5\u0302j) contain at least one point in Xj ,\n\u2022 UARCHAIN(A, X1, X2): the points in Y are selected by the algorithm A with equal probabilities.\nLemma 5.4. Fix any \u03b4-fair algorithm A for some \u03b4 < 0.0002. With probability at least 1/2 over the realizations of \u00b51, \u00b52, X1 and X2, the event FULLCHAIN(X1, X2) implies UARCHAIN(A, X1, X2).\nProof sketch for Theorem 5.1. The combination of Lemmas 5.3 and 5.4 shows that with constant probability over \u00b51, \u00b52 and X , A will need to select \u2126(m) individuals with equal probabilities, which leads to an expected regret of \u2126(1) over the draws of \u00b51, \u00b52 This means there exist distributionsF1 = N (\u00b5\u22171, 1) andF2 = N (\u00b5\u22172, 1) under which A incurs \u2126(1) regret."}, {"heading": "6. Sequential Batch Setting", "text": "We briefly mention an extension to the sequential batch setting, in which the algorithm selects individuals in T rounds. In each round t, for each population j, there aremj new candidates with their observations drawn i.i.d. from the distribution Fj , At each round t, the algorithm needs to select k individuals from this pool. Let Stj be the set of observations from population j accumulated after the first t rounds. In particular, for any observation x and population j, let the historical CCDF value be q\u0302tj(x) =\n1 |mjt| \u2211 x\u2032\u2208Stj\n1[x\u2032 < x]. As t grows large, the empirical CCDF values become better estimates for the true CCDF values. We give a variant of the FAIRTOP algorithm that achieves (\u03b5, \u03b4)-approximate fairness in every round, and incurs average regret over time diminishing as O\u0303 ( 1\n\u03b5 \u221a mT\n) ."}, {"heading": "7. Simulations", "text": "We conclude by discussing some illustrative simulation results for FAIRTOP, along with comparisons to simpler algorithms without fairness guarantees. The simulations were conducted on data in which the raw scores for each population i = 1, 2 were drawn from N (\u00b5i, 1) respectively, and the \u00b5i themselves were chosen randomly fromN (0, 1). Thus befitting the motivation for our model, the raw scores are not directly comparable between populations. While we varied the population sizes, they were held in the fixed ratio m1/m2 = 2 and k = d0.1(m1 +m2)e.\nFor such a simulation with population sizes m1 = 100 and m2 = 50, Figure 1(a) shows the underlying scores computed by FAIRTOP (which depend only on the empirical CDF values) for each member of both populations, but sorted according to their true CDF values so that the transpositions that occur between emprical and true CDFs are apparent; the red points are for the larger population and green for the smaller. Overlaid on this arc of underlying scores is a black plot illustrating sample post-noise scores\nwhen \u03b5 = 10. As we can see, re-sorting the points by their noisy scores will result in a significant amount of additional reshuffling.\nFigure 1(b) illustrates the induced distribution over chosen individuals; here we show the results of resampling the Laplace noise (again at \u03b5 = 10) for 100,000 trials, and choosing the top k post-noise scores across populations. The ordering is again by true CDF values and the same color coding is used. At this value of \u03b5 the distribution is biased towards better true CDF values but still enjoys strong fairness properties. For example, the \u201cunfairness ratio\u201d (maximum ratio of the number of times a worse CDF value is chosen to a better CDF value is chosen) is only 1.56 (note that this is substantially stronger than the bound of e10 guaranteed by our theorem). It is also visually clear that FAIRTOP is treating similar CDF values similarly, both within and between populations.\nNevertheless, the regret of FAIRTOP for these population sizes and \u03b5 is nontrivial (roughly 0.20 regret compared to the best k true CDF values). Of course, as per Theorem 3.7 by increasing \u03b5 we can reduce regret to any desired level at the expense of weakened fairness guarantees. However, as per Corollary 3.8 even for fixed \u03b5 (and therefore fixed fairness properties), regret diminishes rapidly in the natural scaling where the population sizes grow, but in a fixed ratio. This is illustrated empirically in Figure 1(c), where for varying choices of \u03b5 we plot regret as m1,m2 \u2192 \u221e with m1/m2 = 2.\nWe now briefly compare the properties of FAIRTOP to simpler approaches that generally enjoy lower regret but have no fairness properties. Perhaps the simplest is to pick the k highest ranked individuals by empirical CDF rank. This method will in general have very low regret, but since it is deterministic, any trial in which it doesn\u2019t select the top k true CDF values has no fairness guarantee (i.e. the unfairness ratio will be infinite), and this happens in approx-\nimately approximately 87% of trials under the simulation parameters above (and approaches 100% as populations grow in fixed ratio).\nPerhaps the most natural \u201clearning\u201d approach is to use the raw scores to obtain estimated population means \u00b5\u0302i (or more generally to estimate the unknown parameters of some known or assumed parametric form) and then use the CDFs of N (\u00b5\u03021, 1) and N (\u00b5\u03022, 1) to select the k best individuals across the two populations. This again has generally lower regret than FAIRTOP, but is deterministic and without fairness guarantees, with approximately 53% of trials resulting in unbounded unfairness ratio (approaching 100% as populations grow in fixed ratio).\nBut the main drawback of such a learning approach in comparison to the data-oblivious FAIRTOP is its need for realizability. For instance, if we change the population 2 scores to be drawn from the uniform distribution over a wide range, but the learning approach continues to assume normality in each population, it will virtually always choose only members of population 2, a clear and dramatic violation of any intuitive notion of fairness. This is of course due the fact that the highest scores in population 2 appear to have extraordinarily high CDF values when (incorrectly) assumed to have been drawn from a normal distribution. In contrast FAIRTOP, since it doesn\u2019t even consider the actual scores but only generic properties of the relationship between empirical and true CDF values, will behave exactly the same, in both fairness and regret, regardless of how the underlying scores are generated."}], "year": 2017, "references": [{"title": "Gender and computing conference papers", "authors": ["Cohoon", "J McGrath", "Nigai", "Sergey", "Kaye", "Joseph Jofish"], "venue": "Communications of the ACM,", "year": 2011}, {"title": "Asymptotic minimax character of the sample distribution function and of the classical multinomial estimator", "authors": ["A. Dvoretzky", "J. Kiefer", "J. Wolfowitz"], "venue": "Ann. Math. Statist., 27(3):642\u2013669,", "year": 1956}, {"title": "Calibrating noise to sensitivity in private data analysis", "authors": ["Dwork", "Cynthia", "McSherry", "Frank", "Nissim", "Kobbi", "Smith", "Adam"], "venue": "In Theory of Cryptography Conference,", "year": 2006}, {"title": "Fairness through awareness", "authors": ["Dwork", "Cynthia", "Hardt", "Moritz", "Pitassi", "Toniann", "Reingold", "Omer", "Zemel", "Richard"], "venue": "In Proceedings of the 3rd Innovations in Theoretical Computer Science Conference,", "year": 2012}, {"title": "Fair learning in Markovian environments", "authors": ["Jabbari", "Shahin", "Joseph", "Matthew", "Kearns", "Michael", "Morgenstern", "Jamie", "Roth", "Aaron"], "venue": "arXiv preprint arXiv:1611.03071,", "year": 2016}, {"title": "Fairness in learning: Classic and contextual bandits", "authors": ["Joseph", "Matthew", "Kearns", "Michael", "Morgenstern", "Jamie H", "Roth", "Aaron"], "venue": "In Advances in Neural Information Processing Systems,", "year": 2016}, {"title": "Mechanism design via differential privacy", "authors": ["McSherry", "Frank", "Talwar", "Kunal"], "venue": "In Foundations of Computer Science,", "year": 2007}, {"title": "Conjugate Bayesian analysis of the Gaussian distribution", "authors": ["Murphy", "Kevin P"], "year": 2007}, {"title": "Lipschitz extensions for node-private graph statistics and the generalized exponential mechanism", "authors": ["Raskhodnikova", "Sofya", "Smith", "Adam D"], "venue": "IEEE 57th Annual Symposium on Foundations of Computer Science,", "year": 2016}], "id": "SP:8e29794241bcfb6c896ae170366911448423b341", "authors": [{"name": "Michael Kearns", "affiliations": []}, {"name": "Aaron Roth", "affiliations": []}, {"name": "Zhiwei Steven Wu", "affiliations": []}], "abstractText": "We consider the problem of selecting a pool of individuals from several populations with incomparable skills (e.g. soccer players, mathematicians, and singers) in a fair manner. The quality of an individual is defined to be their relative rank (by cumulative distribution value) within their own population, which permits cross-population comparisons. We study algorithms which attempt to select the highest quality subset despite the fact that true CDF values are not known, and can only be estimated from the finite pool of candidates. Specifically, we quantify the regret in quality imposed by \u201cmeritocratic\u201d notions of fairness, which require that individuals are selected with probability that is monotonically increasing in their true quality. We give algorithms with provable fairness and regret guarantees, as well as lower bounds, and provide empirical results which suggest that our algorithms perform better than the theory suggests.", "title": "Meritocratic Fairness for Cross-Population Selection"}