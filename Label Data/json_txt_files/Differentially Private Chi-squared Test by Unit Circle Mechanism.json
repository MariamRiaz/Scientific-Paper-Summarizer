{"sections": [{"text": "\u221a N)) where N is the\nsample size. Furthermore, we introduce novel procedures for multiple \u03c72 tests by incorporating the unit circle mechanism into the sparse vector technique and the exponential mechanism. These procedures can control the family-wise error rate (FWER) properly, which has never been attained by existing mechanisms."}, {"heading": "1. Introduction", "text": "Hypothesis testing is a statistical framework to ascertain whether or not given samples follow a specific model or not in a systematic manner. For this study, we presume that highly sensitive information might be included in the samples. A typical situation is genome-wide association studies (GWAS). Homer et al. reported that a patient\u2019s disease status could be inferred from aggregate statistics collected for GWAS (Homer et al., 2008).\nDifferential privacy (Dwork et al., 2006) is a recent notion of privacy that is tailored to a privacy-preserving release of aggregate statistics. As described in this paper, we give specific consideration to the differential privacy of \u03c72 test\n1Department of Computer Science, University of Tsukuba, 1-1-1 Tennohdai, Tsukuba, Ibaraki, Japan 2JST CREST 3RIKEN Center for Advanced Intelligence Project. Correspondence to: Kazuya Kakizaki <kazuya@mdl.cs.tsukuba.ac.jp>, Kazuto Fukuchi <kazuto@mdl.cs.tsukuba.ac.jp>, Jun Sakuma <jun@cs.tsukuba.ac.jp>.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nof independence. Two lines of studies exist in differentially private \u03c72-tests of independence: input perturbation and output perturbation. The input perturbation method ensures differential privacy by randomizing each count in the contingency table (Uhler et al., 2013; Johnson & Shmatikov, 2013; Wang et al., 2015; Gaboardi et al., 2016). The output perturbation method randomizes the test statistic to satisfy differential privacy (Fienberg et al., 2011; Yu et al., 2014; Uhler et al., 2013; Wang et al., 2015). Also recently, there is a study for the differential privacy of \u03c72 test of identity, which ensures type-I and typ-II error (Cai et al., 2017).\nThe contribution of this study is three-fold. First, we analyze the type-II error of the differentially private mechanism for output perturbation. In principle, (non-privacypreserving) hypothesis test procedures are preferred to achieve a greater power with keeping the significance at a prescribed level. In the case of differentially private hypothesis test, the same is required under the constraint of differential privacy. Much efforts have been devoted to controlling the significance level properly (Wang et al., 2015; Gaboardi et al., 2016) whereas little attention has been paid to the power analysis. We analyze the type-II error of the differentially private mechanism for \u03c72-test, and show that it is upper-bounded by two terms which are mechanism-dependent. The bound indicates that a mechanism with a lower sensitivity and lower \u03b3 error (defined in Section 4) achieves a greater power.\nSecond, we investigate the geometrical property of the test statistic of the \u03c72-test. Then, we propose the unit circle mechanism: a novel differentially private mechanism based on the geometrical property. In existing mechanisms based on output perturbation, the sensitivity is O(1) in terms of N (Fienberg et al., 2011; Yu et al., 2014; Uhler et al., 2013). We demonstrate that the sensitivity of the unit circle mechanism is O(1/ \u221a N), which achieves lower type-II error (Theorem 7).\nThird, we present two procedures for differentially private multiple \u03c72 tests of independence that can control the familywise error rate (FWER). Actually, FWER can be controlled properly using existing DP mechanisms for \u03c72-test by repeatedly using (Uhler et al., 2013), for example. However, such a naive construction consumes the privacy budget, which is linear to the number of all the considered\ntests and which would produce useless test results. There exist several studies that work with a lower privacy budget in the multiple testing setting (Johnson & Shmatikov, 2013). However, to the best of our knowledge, no differentially private multiple testing procedure that can control FWER properly has been presented. We introduce two novel procedures for multiple \u03c72 tests by incorporating the unit circle mechanism into the sparse vector technique (SVT) (Dwork & Roth, 2014) and exponential mechanism (McSherry & Talwar, 2007). The exponential mechanism based procedure works in the non-interactive setting, in which the set of hypotheses considered needs to be prescribed before starting the testing procedure. This mechanism first selects top-k significant hypotheses and then performs the statistical test for each hypothesis. The SVT based procedure works in the interactive setting, in which the hypothesis to be considered at each round can be interactively chosen after observing the result of the tests in the previous rounds. The SVT based procedure controls FWER by adjusting the threshold of SVT using Monte Carlo sampling. Simultaneously, we show the privacy budget consumed by the both procedures is not dependent on the total number of the hypotheses considered, but only on the prescribed maximum number of hypothesizes to be accepted."}, {"heading": "2. Preliminaries", "text": ""}, {"heading": "2.1. Differential Privacy", "text": "Let S = {xi|xi \u2208 X , i = 1, . . . , N} be a set of records. Presume that an analyst holds S and wishes to release a result of statistical analysis f(S) to the public, where f : S \u2192 Y is a statistical query. S and Y respectively denote the input domain and output domain. Differential privacy (DP) is a privacy definition that restricts privacy breach of any element in S caused by releasing y = f(S) (Dwork et al., 2006). Let d(S, S\u2032) = |{i : xi \u0338= x\u2032i, xi \u2208 S, x\u2032i \u2208 S\u2032}| denote the Hamming distance between two sets. When h(S, S\u2032) = 1, we say that S and S\u2032 are adjacent, or that S \u223c S\u2032. Ensuring DP requires randomization of outputs, by definition. Let Mf (S) denote a randomization mechanism of f . Mf is differentially private if it satisfies the following definition:\nDefinition 1 (\u03f5-DP (Dwork et al., 2006)). Mechanism M : S \u2192 Y provides \u03f5-DP if, for any S \u223c S\u2032 and Y \u2286 Y ,\nPr[M(S) \u2208 Y ] \u2264 exp(\u03f5) Pr[M(x\u2032) \u2208 Y ].\nWe introduce a basic mechanism that ensures DP for scalar outputs. For query f , the following randomization by Laplace mechanism\nM(S) = f(S) + Lap(\u2206f \u03f5 )\nguarantees \u03f5-DP, where Lap(b) denotes a random value generated from the Laplace distribution for which the scale parameter is b (Dwork et al., 2006). \u2206f denotes the sensitivity of the query, which is defined as\n\u2206f = max S\u223cS\u2032\n|f(S)\u2212 f(S\u2032)|.\nWe remark that no post-processing of outputs obtained from any DP mechanism changes the guarantee on"}, {"heading": "DP (Dwork & Roth, 2014).", "text": ""}, {"heading": "2.2. Answering Multiple Queries", "text": "When we obtain multiple outputs from a mechanism computed on disjoint data subsets, the following composition theorem is applied. Theorem 1 (Composition theorem (McSherry & Talwar, 2007)). Let Mi : S \u2192 Yi be \u03f5-DP mechanism for i = 1, \u00b7 \u00b7 \u00b7 ,K. Let M\u0302 : S \u2192 Yi\u00d7, \u00b7 \u00b7 \u00b7 ,\u00d7YK be the mechanism that outputs (M1, \u00b7 \u00b7 \u00b7 ,MK). Then, M\u0302 is K\u03f5differential private.\nLet f1, . . . , fK be a query sequence. Suppose analyst wishes to know whether or not fk(S) > \u03c4 holds for all k where \u03c4 is a threshold. If the analyst obtains {fk(S)}Kk=1, the privacy budget for each query needs to be set to 1/K\u03f5 to ensure \u03f5-DP, which would result in extremely unuseful outputs when K is large. Suppose the analyst is interested only in whether or not each output is above a threshold value. If the analyst has a good reason to believe that only s(\u226a K) answers would exceed the threshold value, the sparse vector technique (SVT) (Dwork & Roth, 2014) helps to reduce consumption of the privacy budget drastically. Let \u22a4 mean that fk(S) > \u03c4 . Assuming SVT is terminated after answering at most s outputs, it outputs \u22a4 only when the following holds for k = 1, . . .:\nfk(S) + Lap(4\u2206s/\u03f5) \u2265 \u03c4 + \u03c1 (1)\nwhere \u03c1 = Lap(2\u2206s/\u03f5) and \u2206 is the sensitivity of fk1. Otherwise, it outputs nothing. It is proved that SVT guarantees \u03f5-DP. What is remarkable about SVT is that the privacy budget is independent on the total number of the queries, but only on s. See Appendix. A for the detail ."}, {"heading": "3. Differentially Private \u03c72-Test", "text": ""}, {"heading": "3.1. \u03c72-Test of Independence", "text": "Let X0 and X1 be discrete random variables and presume that we are interested in the independence between the two random variables. In this study, we suppose the random variables are binary. For the statistical test of independence, the null hypothesis is that X0 and X1 are independent. Let S = {x1, \u00b7 \u00b7 \u00b7 , xN} be a set of samples drawn\n1We require that all the queries have the same sensitivity\nfrom the two random variables where xTn = (xn,0, xn,1) \u2208 {0, 1}2 are realization of X0 and X1. Given S, Table 1 denotes the 2 \u00d7 2 contingency table w.r.t. X0 and X1 where cpq denotes the number of samples in S such that X0 = p and X1 = q. The marginals N1, N0,M1, and M0 are defined as in Table 1. The test statistic for \u03c72-test of independence is given as\n\u03c72(S) =\n(c11c00 \u2212 c10c01)2N (c11 + c10)(c11 + c01)(c10 + c00)(c01 + c00) . (2)\nUnder the null hypothesis H0, the \u03c72-test statistics is known to follow the \u03c72 distribution with one degree of freedom, asymptotically (Bishop et al., 1975). Given S and significance level \u03b1, the \u03c72-test of independence is run as\n\u03c72-test(S,\u03b1) =\n{ rej if \u03c72(S) > \u03c4\u03b1,\nacc otherwise.\nTherein, \u03c4\u03b1 is a threshold determined such that\u222b\u221e \u03c4 \u03c7 2 (1)(z)dz = \u03b1. Here, rej and acc respectively indicate that H0 is rejected and accepted. We learn that there exists evidence that X0 and X1 are dependent on the significance level of \u03b1 if H0 rejected. The type-1 error of \u03c72 test is equivalent to the significance level:\n\u03b1 = Pr[\u03c72(S) > \u03c4\u03b1|H0 is true].\nThe power is defined by the probability of rejecting the null hypothesis when the alternative hypothesis is true:\n1\u2212 \u03b2 = Pr[\u03c72(S) > \u03c4\u03b1|H1 is true]\nTherein, \u03b2 denotes the type-II error.\nLet M be a randomization mechanism for \u03c72 testing. Under the constraints that M ensures DP and that type-I error is preserved at most \u03b1, we evaluate the utility of the mechanism by 1\u2212 \u03b2, the power of the mechanism."}, {"heading": "3.2. Output Perturbation Method", "text": "The most straightforward method to ensure the DP of \u03c72 test is the randomization of the test statistic (Fienberg et al.,"}, {"heading": "2011; Yu et al., 2014; Uhler et al., 2013; Wang et al., 2015). Application of the Laplace mechanism to the \u03c72 statistic immediately ensures DP, as", "text": "\u03c7\u03022(S) = \u03c72(S) + Lap( \u2206\n\u03f5 ),\nwhere \u2206 is the sensitivity of the test statistic. For example, given N0 and N1 are released to the public, (Yu et al., 2014) derived the following sensitivity:\n\u2206Y = N2\nN0N1\n( max{N0, N1}\nmax{N0, N1}+ 1\n) . (3)\nOther sensitivity analyses are provided elsewhere in the relevant literature (Fienberg et al., 2011; Wang et al., 2015). In principle, these sensitivities are in O(1) with respect to N assuming N0 \u2243 N1."}, {"heading": "3.3. Input Perturbation Method", "text": "Given a contingency table, the input perturbation method first randomizes each cell of the contingency table independently as2 c\u0302pq = cpq + Lap( 2\u03f5 ), and then evaluates the test statistic with the randomized table (Johnson & Shmatikov, 2013). After randomization, each cell can take a negative value. (Barak et al., 2007; Li et al., 2010; Hardt et al., 2012; Li & Miklau, 2012; Gaboardi et al., 2014) have suggested methods of calculating a differentially private contingency table while avoiding this problem. For independence testing, (Gaboardi et al., 2016) modified the contingency table by using the work of (Lee et al., 2015) based on constraint optimization problem so that the total number of the samples is N and each cell has a positive value. The DP of the test statistic is readily ensured because of the post-processing theorem. In input perturbation, given N0 \u2243 N1, (Gaboardi et al., 2016) and (Wang et al., 2015) reported by experiments that the accuracy of the test results can be improved when the number of samples increases."}, {"heading": "3.4. Significance Level of DP \u03c72 Test", "text": "The threshold for non-privacy-preserving \u03c72 test is determined based on the fact that \u03c72(S) follows the \u03c72 distribution asymptotically when H holds. However, \u03c7\u03022(S) does not follow the \u03c72 distribution anymore, even when H holds. For the randomization mechanism to keep the type-I error \u03b1, the threshold \u03c4\u03b1 needs to be adjusted so that \u03b1 = Pr[\u03c7\u03022(S) > \u03c4\u0302\u03b1|H0 is true] holds. Letting \u03c7\u03022(1) denote the distribution that \u03c7\u03022(S) follows, then \u03c4\u0302\u03b1 is determined so that\n\u222b\u221e \u03c4\u0303\u03b1 \u03c7\u03022(1)(z)dz = \u03b1.\nFor the input perturbation case, (Uhler et al., 2013) demonstrated that the test static arising from randomized cell counts asymptotically approximates the \u03c72 distribution. However, the sample distribution can deviate considerably from the \u03c72 distribution when the sample size is small. A study by (Gaboardi et al., 2016) also proved that the ex-\n2When one can assume that the marginal of the table (N0 and N1) is known publicly, the global sensitivity of the count query is 1.\npectation of \u03c7\u03022(S) generated by input perturbation is biased. (Gaboardi et al., 2016) and (Wang et al., 2015) independently presented methods to correct the bias by adjusting the threshold, respectively using Monte Carlo sampling and a permutation test.\nFor the output perturbation case, (Uhler et al., 2013) derived a distribution of perturbed \u03c72 statistic when the test statistic is randomized with the Laplace distribution. In this case, the threshold can be adjusted accurately using the derived distribution. Although not described in the literature above specifically, the threshold for test statistics generated by output perturbation can be adjusted using Monte Carlo sampling in a method similar to one reported in (Gaboardi et al., 2016)."}, {"heading": "4. Power of DP \u03c72 Test", "text": "The type-I error can be correctly controlled by adjusting the threshold appropriately as discussed in Section 3.4 whereas theoretical analysis on the power has never been intensively investigated in existing works. For the power analysis, we derive the following upper bound. Theorem 2. Let \u03b2\u03c4 denote the type-II error when one use threshold \u03c4 for the (non-privacy-preserving) \u03c72 test. Let P = {P : H1is true} be the set of distributions of sample sets. Let M be a differentially private mechanism for \u03c72 test and \u03c4\u0302\u03b1 > \u03c4\u03b1 be the threshold for M that is determined so that the type-I error of M becomes \u03b1. Then for any \u03b3 > 0, the upper bound of the type-II error of M is\nPr[M(S, \u03c4\u0302\u03b1) = acc|H1 is true] \u2264\nsup P\u2208P { Pr S\u223cP [M(S, \u03c4\u0302\u03b1)=acc|\u03c72(S)> \u03c4\u0302\u03b1+\u03b3]+\u03b2\u03c4\u0302\u03b1+\u03b3 } .\nThe proof is shown in Appendix B. The upper bound consists of the probability term and the type-II error term. We discuss the behavior of these terms w.r.t. N .\nThe first probability term represents the probability that the privacy mechanism accepts the null hypothesis when the non-privacy-preserving test rejects it with threshold \u03c4\u0302\u03b1+\u03b3. For notational simplicity, we call the probability term the \u03b3 error:\nE(\u03c4\u0302\u03b1, \u03b3,M) = sup P\u2208P Pr S\u223cP [M(S, \u03c4\u0302\u03b1) = acc|\u03c72(S) > \u03c4\u0302\u03b1 + \u03b3].\nThe \u03b3 error measures how often the mechanism wrongly rejects the null hypothesis. The \u03b3 error thus depends on the mechanism M. The analysis of this term will be discussed in the next subsection again.\nThe second term \u03b2\u03c4\u0302\u03b1+\u03b3 is the type-II error of non-privacypreserving test with threshold \u03c4\u0302\u03b1 + \u03b3, which depends on\nthe mechanism, too. This term becomes smaller if \u03c4\u0302\u03b1 is closer to \u03c4\u03b1. This occurs when the distribution of \u03c7\u03022(S) is close to the distribution of \u03c72(S). In the case of output perturbation, this happens when the sensitivity of the mechanism decreases faster w.r.t. N . Thus, fixing sample size N , a greater power would be realized by employing a mechanism with a low sensitivity ."}, {"heading": "4.1. Power Analysis of Output Perturbation", "text": "First, we discuss the \u03b3 error of output perturbation. Theorem 3. Let M\u2206 be a \u03f5-differentially private mechanism of output perturbation with sensitivity \u2206. Then, the \u03b3 error is upper bounded by 12 exp ( \u2212\u03b3\u03f5 \u2206 ) .\nThe proof is shown in Appendix C. Substituting the sensitivity derived in Eq.3 to this bound, we can confirm that the \u03b3 error of the mechanism of (Yu et al., 2014) is O(1) in terms of N . The same conclusion is derived from the mechanisms of (Fienberg et al., 2011) and (Wang et al., 2015). The sensitivities employed by these mechanisms are also O(1). A mechanism with a lower \u03b3 error and a lower sensitivity is needed to achieve greater power with ensuring DP."}, {"heading": "4.2. Power Analysis of Input Perturbation", "text": "In the input perturbation method, randomization is applied to each cell. So the analysis of the \u03b3 error and the sensitivity cannot be appropriately derived. Because of this difficulty of analysis, we will evaluate the power of input perturbation numerically in Section 7."}, {"heading": "5. Unit Circle Mechanism", "text": "This section introduces a variant of output perturbation: the unit circle mechanism. This section first investigates the geometrical property. Then a novel mechanism is designed based on the property. We also show that the \u03b3 error and the sensitivity asymptotically vanish in the limit of N . Because of this property, the proposed mechanism achieves better power compared to existing output perturbation mechanisms."}, {"heading": "5.1. Geometrical Interpretation of \u03c72 Test", "text": "Given (c11, c10) and the marginals N0 and N1 in Table 1, the test statistic of Eq. 2 is represented as\n\u03c72(c11, c10) = (c11N0 \u2212 c10N1)2N\n(c11 + c10)(N \u2212 c11 \u2212 c10)N1N0 . (4)\nLetting \u03c72(c11, c10) = \u03c4\u03b1 and rearranging Eq. 4 with respect to c11 and c10, we have a quadratic form. The following lemma provides a geometrical interpretation of the test\nstatistic of \u03c72-test on the (c11, c10)-plane. Lemma 1. Given \u03c4\u03b1 > 0, for any N1 > 0, N0 > 0, and N > 0, \u03c72(c11, c10) = \u03c4\u03b1 forms an ellipse on the (c11, c10)-plane.\nThe proof is presented in Appendix D. Recall that the null hypothesis is rejected at significance level \u03b1 if \u03c72(S) > \u03c4\u03b1. Using this, we can infer the following theorem. Theorem 4. Given Table 1 specified by S and a threshold \u03c4\u03b1 > 0, H0 is rejected if and only if (c11, c10) exists outside of the ellipse \u03c72(c11, c10) = \u03c4\u03b1.\nThe proof, although it might be readily apparent, is omitted here. Figure 1(a) present plots of contingency tables with the ellipse. For the convenience of theoretical analysis, we introduce an affine transformation V , which transforms the ellipse to the unit circle. The formulation of the affine transformation V is shown in Appendix E.\nUsing this transformation, \u03c72 test can be conducted by using ||V ((c11, c10)t)||2 as the test statistic. Theorem 5. Given Table 1 specified by S and a threshold \u03c4\u03b1 > 0, H0 is rejected if and only if ||V ((c11, c10)t)||2 > 1, i.e., V ((c11, c10)t) exists outside of the unit circle.\nThe proof is presented in the Appendix F. Figure. 1(b) presents the plot of contingency tables and the ellipse after transformation."}, {"heading": "5.2. Privacy Analysis of Unit Circle Mechanism", "text": "The input perturbation ensures DP by randomizing c10 and c11 independently by the Laplace or Gaussian mechanism. In the unit circle view, equivalent results are obtainable by randomizing the distance from the origin, ||V ((c11, c10)t)||2, and judging whether the randomized distance is greater than 1 or not. The global sensitivity of ||V ((c11, c10)t)||2 is derived as described below. Lemma 2 (Sensitivity of ||V ((c11, c10)t)||2). Given Table 1 specified by S and threshold \u03c4\u03b1 > 0, the sensitivity of\n||T ((c11, c10)t)||2 is given as\n\u2206V,\u03b1(N0, N1) = 2\n\u221a (N20 +N 2 1 )N + 2\u03c4\u03b1N0N1\n\u03c4\u03b1N0N1N2 . (5)\nThe proof is presented in the Appendix G. This sensitivity analysis immediately derives the following Laplace mechanism:\nd\u0302(S) = ||V\u03c4\u03b1((c11, c10)t)||2 + Lap( \u2206V,\u03b1(N0, N1)\n\u03f5 ). (6)\nThe mechanism releasing d\u0302(S) ensures \u03f5-DP whereas, as we already discussed in Section 3.4, if we use d\u0302(S) as the test statistic, the type-I error cannot be properly controlled. To maintain type-I error as \u03b1 or less, we want d\u0302(S) < 1 to hold with the probability of at least 1 \u2212 \u03b1 if H0 holds. To attain this state, we propose the unit circle mechanism in Algorithm 1 that controls the type-I error by generating the finite sample distribution of d\u0302(S) with Monte-Carlo sampling. At line 2, the randomized test statistics is evaluated. The for-loop starting from line 4 generates the sample distribution of the randomized test statistics when the null hypothesis is true. At line 8, the p-value of S is evaluated with the sample distribution. The null hypothesis is rejected at line 10 if the p-value is less than the significance level. Theorem 6. Algorithm 1 ensures \u03f5-DP.\nIf marginals M0,M1, N0, N1 are public, then computation with Sk does not consume the privacy budget because Sk are samples that are artificially generated using the distribution specified by the public marginals. All operations after line 2 are attributable to post processing and therefore do not consume the privacy budget. Consequently, the privacy budget is consumed at line 2 only. Thus, the proof is immediately obtained by the privacy guarantee of the mechanism based on the global sensitivity(Dwork et al., 2006)."}, {"heading": "5.3. Utility Analysis of Unit Circle Mechanism", "text": "From the discussion in Section 4, the power of test mechanisms can be investigated by analyzing the \u03b3 error and the sensitivity. The \u03b3 error of Algorithm 1 is obtained using the following theorem. Theorem 7. The \u03b3 error of Algorithm 1 is\nE(\u03c4\u0302\u03b1, \u03b3,M\u2206V,\u03b1(N0,N1))\n\u2264 1 2 exp\n( \u03f5N\n2\n( 1\u2212 \u221a 1 +\n4\u03b3M1M0 \u03c4\u0302\u03b1N2\n)\n\u00b7\n\u221a \u03c4\u0302\u03b1N1N0\n(N21 +N 2 0 )N + 2\u03c4\u0302\u03b1N1N0\n) . (7)"}, {"heading": "The proof is shown in Appendix H. Eq. 7 is", "text": "O(exp(\u2212 \u221a N)), and asymptotically vanishing as the sample size increases. Furthermore, the sensitivity of the unit\nAlgorithm 1 Unit Circle Mechanism Require: Sample set S, sig level \u03b1, privacy budget \u03f5\n1: Evaluate contingency table from S 2: d\u0302(S) = ||V ((c11, c10)t)||2 + Lap(\u2206V,\u03b1(N0,N1)\u03f5 ) 3: for k = 1 to m do 4: Sk \u223c mult(N1M1N2 , N0M1 N2 , N1M0 N2 , N0M0 N2 ) 5: Evaluate contingency table from Sk 6: d\u0302(Sk) = ||V ((ck11, ck10)t)||2 + Lap( \u2206V,\u03b1(N k 0 ,N k 1 )\n\u03f5 ) 7: end for 8: p = |{i:d\u0302(S)\nk\u2265d\u0302(S)}| m\n9: if p < \u03b1 then 10: Return rej 11: else 12: Return acc 13: end if\ncircle mechanism is O( 1\u221a N ) as derived from Eq. 5. Thus, from the discussion in Section 4, the upper bound of the type-II error of Algorithm 1 is expected to decrease with a faster rate than existing output perturbation method."}, {"heading": "6. Differentially Private Multiple \u03c72-test", "text": "Presume that we are interested in the independence between random variables X0 and other K random variables, X1, X2, . . . , XK . The objective is investigation of the independence between X0 and Xk for k = 1, . . . ,K. We denote the null hypothesis that X0 and Xk are independent by Hk0 . The test statistic for independence between X0 and Xk is calculated with the set of samples Sk. We suppose N0, N1, and N are the same for all Sk. We can verify the independence of each random variable pair by evaluating Eq. 2 with Sk for k = 1, . . . ,K in turn. In multiple hypothesis testing, we consider to control the familywise error rate (FWER), the probability that the null hypothesis is rejected mistakenly at least once among K tests. If the significance of each test is kept 1- \u03b1, the FWER of the K tests in this setting is given as 1\u2212 (1\u2212 \u03b1)K \u2243 \u03b1K, which increases as K increases. We use Bonferroni correction to correct the significance level so that the FWER for the entire test set is kept less than \u03b1 (Bonferroni, 1936).\nWe can realize DP multiple \u03c72-test using the DP \u03c72 test mechanisms repeatedly. However, the privacy guarantee weakens as the number of hypothesis K increases by Theorem 1. (Fienberg et al., 2011) presented a multiple testing procedure using output perturbation. This method consumes a privacy budget that is proportional to K, which makes it almost impossible to obtain useful results under a meaningful privacy guarantee. (Johnson & Shmatikov, 2013; Yu et al., 2014; Simmons & Berger, 2016) presented a method which outputs the top s1 significant random variable pairs using the exponential mechanism\n(McSherry & Talwar, 2007). This method outputs s1 pairs even if all pairs are not significant. For that reason, naive application of exponential mechanism cannot control FWER.\nIn this section, we provide two differentially private multiple hypothesis testing methods that can conserve the privacy budget even with large K and controls FWER properly. The exponential mechanism based procedure works in the non-interactive setting, in which the set of hypotheses considered needs to be prescribed before starting the testing procedure. The SVT based procedure works in the interactive setting (Lyu et al., 2017), in which the hypothesis to be considered at each round can be interactively chosen after observing the result of the tests in the previous rounds (Webb & Petitjean, 2016)."}, {"heading": "6.1. Unit Circle Mechanism + SVT", "text": "We first show the SVT-based procedure with the unit circle mechanism (UCM+SVT). Recall that the unit circle mechanism verifies the result by checking if ||V ((c11, c10)t)||2 > 1. Also, provided all the marginals are public information and N0 and N1 are the same for all Sk, the sensitivity of ||V ((c11, c10)t)||2 is the same for any contingency table. Thus, the unit circle mechanism can be naturally incorporated into SVT.\nApplication of the unit circle mechanism (i.e., thresholding by Eq. 6) to SVT immediately guarantees differential privacy. However, the type-I error cannot be properly controlled by the naive combination. Recall that SVT adds noise to the threshold to compare in Eq. 1. In order to control the type-I error, the threshold of SVT should be properly adjusted considering the effect of the additive noise. We employ Monte Carlo sampling to determine the threshold that properly controls the type-I error. Also, we use Bonferoni correction to control the FWER.\nThe UCM+SVT takes as input sample sets S1, \u00b7 \u00b7 \u00b7 , SK\uff0c the significance level \u03b1, the privacy budget \u03f5, and stop parameters s1 \u2264 s2. The UCN+SVT is terminated if (1) it rejects at most s1 null hypotheses, or (2) it outputs s2 test results. Here, we remark the stop parameter s2 is not used in the regular SVT. In our setting, we need to apply Bonferroni correction to control the FWER. We thus use s2 to upper bound the maximum number of hypotheses considered. The settings and the algorithm are detailed in Appendix I.\nIn the experimental results of single hypothesis test in Section 7, input perturbation+MC also achieves good performance. However, when input perturbation is used, the sensitivity of the test statistic is not uniform and thus it cannot be used with SVT."}, {"heading": "6.2. Unit Circle Mechanism + EM", "text": "We introduce another DP multiple test procedure using the exponential mechanism (UCM+EM). By simple application of the exponential mechanism, we can get the top s1 significant random variable pairs. However, this method outputs s1 pairs even if all pairs are not significant. For that reason, it cannot control FWER. By adding s1 significant dummy pairs of random variables, we can avoid accepting non-significant random variable pairs. However, this method does not necessarily control FWER properly because we cannot add appropriate dummy pairs to control FWER without knowing the scores related the p-values of non-significant pairs. In order to control FWER properly, we can use the exponential mechanism to select candidate pairs, and then apply the unit circle mechanism to the candidate pairs so that the significance level of each test is properly controlled. The settings and the algorithm is detailed in Appendix J."}, {"heading": "7. Experiment", "text": ""}, {"heading": "7.1. Experiments for Single Testing", "text": "In this section, we evaluate the significance and the power of the respective mechanisms, input perturbation (Gaboardi et al., 2016), output perturbation (Yu et al., 2014), and unit circle mechanism for single hypothesis testing. Both the output perturbation and the unit circle mechanism use N1 and N0 as public information. If these are public, the sensitivity of the input perturbation can be made 1. For controlling the significance of input perturbation, we use MCIndepLap with the Laplace distribution in (Gaboardi et al., 2016). The significance of the unit circle mechanism and output perturbation is controlled by adjusting \u03c4\u03b1 by Monte Carlo sampling. For Monte Carlo sampling, we set the number of sampling as 1000 for MCIndepLap with the laplace distribution, and 10000 for the other methods. For output perturbation, we used the sensitivity derived in Eq.3.\nSignificance. To evaluate the significance, we sample 1000 contingency tables from mult(0.25, 0.25, 0.25, 0.25) so that H0 is true. mult(\u00b7, \u00b7, \u00b7, \u00b7) denotes the multinomial distribution. Then, we assess the proportion that the mechanism outputs acc correctly. We set the privacy parameter as \u03f5 = 0.1 and significance level as \u03b1 = 0.05.\nIn Figure 2, the significance of mechanisms are shown. If Monte Carlo sampling is not used (Figure 2(a)-2(c)), the significance remains poor for small samples. The significance of output perturbation unchanged even when the sample size increases. However, the input perturbation and the unit circle mechanism improve the significance as the sample size increases. The controlled significance version of these mechanisms can properly control the significance\nat 0.95 for any sample size (Figure 2(d)-2(f)).\nPower. Evaluation of the power of the respective mechanisms controlling significance is presented. We sample 1000 contingency tables from mult(0.25 + 0.01, 0.25 \u2212 0.01, 0.25\u2212 0.01, 0.25 + 0.01) so that H1 is true. To evaluate the power, we assess the rate at which the mechanism outputs rej correctly when H1 is true. We set the privacy parameter \u03f5 = 0.1 and significance level \u03b1 = 0.05.\nFigure 3 shows that the unit circle mechanism with Monte Carlo sampling (UCM+MC) has similar power to that of the input perturbation with Monte Carlo sampling (IP+MC). In addition, compared with output perturbation with Monte Carlo sampling (OP+MC), UCM+MC quickly improves the power as the number of samples increases.\nThe \u03b3-error of UCM+MC can be analyzed as discussed in Section 3.4. UCM+MC has a faster rate of the power than OP+MC because the \u03b3-error of the UCM+MC decreases as the sample size increases. Unlike the UCM/OP+MC, the \u03b3error of IP+MC has never been analyzed. The UCM+MC is thus advantageous compared with the IP+MC in that the upper bound of type-II error is analyzed by Theorem 2. We remark that, looking at the results of the power, IP+MC and UCM+MC might have the same the \u03b3-error rate. The analysis of IP+MC remains as future work."}, {"heading": "7.2. Experiments for Multiple Testing", "text": "In this subsection, we experimentally evaluate FWER and utility of UCM+SVT and UCM+EM.\nFWER. FWER can be properly controlled if the significance for a single test is exactly adjusted to \u03b1 by using the Bonferroni correction. In UCM+EM, the significance of each test perfomed by UCM is properly controlled with a sufficiently large number of Monte Carlo samples. We can thus guarantee that FWER is properly controlled by applying Bonferroni correction. Since we can confirme this from Fig. 2, we skip experimental evaluation of the significance of UCM+EM. Similarly, UCM+SVT is expected to properly control FWER with a sufficiently large number of Monte Carlo samples. To confirm this, we evaluate the FWER of UCM+SVT experimentally.\nIn order to evaluate the FWER of UCM+SVT, all samples must be drawn from the null distribution. We artificially generated samples for evaluation in the following manner. We generated 1000 sample sets from mult(0.25, 0.25, 0.25, 0.25) so that H0 is true. Then, we assess the rate at which UCM+SVT outputs acc correctly. We set the privacy parameter as \u03f5 = 0.1 and the significance level as \u03b1 = 0.05. We set the stop parameters as s1 = 1 and s2 = 1, and evaluate the significance 1 \u2212 \u03b1 for a single test instead of FWER. Note that we can control FWER by Bonferroni correction for multiple tests if the\nmechanism can guarantee the significance of a single test. Also, we remark that this does not mean that our mechanism cannot work with multiple sample sets.\nFigure 4 shows the significance level of UCM+SVT when the sample size is changed. As we can see from the figure, UCM+SVT can control the significance at the prescribed level (0.95) for any sample size.\nUtility. Next, we compare the utility of UCM+SVT and UCM+EM with existing methods. We denote the SVT with the output perturbation by OP+SVT, the EM with the input perturbation by IP+EM. We compare the correctness of these algorithms with respect to the sample size.\nFor evaluation, we artificially generated K = 10 sample sets in the following method. We fix the marginals Nk1 = N 2 , N k 0 = N 2 ,M k 1 = N 2 ,M k 0 = N 2 , and then create the sample sets S1, . . . , SK so that the test statistics of the resulting sample sets become \u03c72(Sk) \u2208 {1, 1, 1, 1, 1, 1, 1, 1, 30, 30}. Two of them reject the corresponding null hypotheses at significance level \u03b1 = 0.05 after Bonferroni correction (i.e., \u03c72(Sk) = 30). Regarding the remaining eight sample sets, the corresponding null hypotheses are accepted. We input Sk to the algorithms, and then evaluate the utility. For utility measure, we employ the correctness rr\u2032 , where r is the number that the algorithm outputs rej correctly; r\u2032 is the number of the contingency tables rejected by non-private multiple \u03c72 tests with Bonferroni correction. In our artificially generated sample sets, r\u2032 = 2. For UCM+SVT, we input the sample sets in a random order. We set the privacy parameter as \u03f5 = {0.1, 0.5}, the significance levels as \u03b1 = 0.05, and the stop parameters as s1 = 2, s2 = 10.\nFigure 5 shows the correctness (average of 100 trials) of each algorithm with respect to the sample size. As we see from the figure, the correctness of UCM+SVT approaches to 1 when N increases while the correctness of OP+SVT does not. This is because the sensitivity of the unit circle mechanism decreases faster than that of output perturbation with respect to the sample size. Both UCM+EM and IP+EM have the comparable correctness. We remark that UCM is advantageous compared to IP in the sense that the type-II error of UCM is upper-bounded as we discuss in Section 5, while no theoretical guarantee on the type-II error of input perturbation is provided.\nThe algorithms using EM achieves better correctness than the algorithms using SVT. This difference of the correctness comes from the settings that SVT and EM can handle. As we discussed in Section 6, SVT can deal with the interactive setting whereas EM considers the non-interactive setting only. In this sense, the results of these two procedures are not directly comparable."}, {"heading": "Acknowledgement", "text": "We thank anonymous reviewers for insightful reviews and discussions. We appreciate that one of the reviewers gives an important suggestion regarding the combination of the unit circle mechanism and exponential mechanism. We thank Prof. Hideitsu Hino and Dr. Masayuki Terada for important comments that greatly improved the manuscript. The research is partly supported by JST CREST Grant Number JPMJCR1302 and JSPS Grand-in-Aid for Scientific Research No. 16H02864."}, {"heading": "Barak, Boaz, Chaudhuri, Kamalika, Dwork, Cynthia, Kale,", "text": "Satyen, McSherry, Frank, and Talwar, Kunal. Privacy, accuracy, and consistency too: a holistic solution to contingency table release. In Proceedings of the twenty-sixth ACM SIGMOD-SIGACT-SIGART symposium on Principles of database systems, pp. 273\u2013282, 2007."}, {"heading": "Bishop, Yvonne M.M, Fienberg, Stephen E, and Holland,", "text": "Paul W. Discrete multivariate analysis: Theory and practice. 1975.\nBonferroni, C.E. Teoria statistica delle classi e calcolo delle probabilita\u0300. Pubblicazioni del R. Istituto superiore di scienze economiche e commerciali di Firenze. Libreria internazionale Seeber, 1936.\nCai, Bryan, Daskalakis, Constantinos, and Kamath, Gautam. Priv\u2019it: Private and sample efficient identity testing. In Proceedings of The 34rd International Conference on Machine Learning, pp. to appear, 2017.\nDwork, Cynthia and Roth, Aaron. The algorithmic foundations of differential privacy. Foundations and Trends in Theoretical Computer Science, 9(3-4):211\u2013407, 2014."}, {"heading": "Dwork, Cynthia, McSherry, Frank, Nissim, Kobbi, and", "text": "Smith, Adam. Calibrating noise to sensitivity in private data analysis. In Proceedings of the Third Conference on Theory of Cryptography, pp. 265\u2013284, 2006."}, {"heading": "Fienberg, Stephen E., Slavkovic, Aleksandra, and Uhler,", "text": "Caroline. Privacy preserving gwas data sharing. In Proceedings of the 2011 IEEE 11th International Conference on Data Mining Workshops, pp. 628\u2013635, 2011."}, {"heading": "Gaboardi, Marco, Arias, Emilio Jesu\u0301s Gallego, Hsu, Justin,", "text": "Roth, Aaron, and Wu, Zhiwei Steven. Dual query: Practical private query release for high dimensional data. In Proceedings of The 31rd International Conference on Machine Learning, pp. 1170\u20131178, 2014."}, {"heading": "Gaboardi, Marco, Lim, Hyun, Rogers, Ryan, and Vadhan,", "text": "Salil. Differentially private chi-squared hypothesis test-\ning: Goodness of fit and independence testing. In Proceedings of The 33rd International Conference on Machine Learning, pp. 2111\u20132120, 2016."}, {"heading": "Hardt, Moritz, Ligett, Katrina, and McSherry, Frank. A", "text": "simple and practical algorithm for differentially private data release. In Advances in Neural Information Processing Systems 25, pp. 2339\u20132347, 2012."}, {"heading": "Homer, Nils, Szelinger, Szabolcs, Redman, Margot, Duggan, David, Tembe, Waibhav, Muehling, Jill, Pearson,", "text": "John V, Stephan, Dietrich A, Nelson, Stanley F, and Craig, David W. Resolving individuals contributing trace amounts of dna to highly complex mixtures using highdensity snp genotyping microarrays. PLoS genetics, 4 (8):e1000167, 2008."}, {"heading": "Johnson, Aaron and Shmatikov, Vitaly. Privacy-preserving", "text": "data exploration in genome-wide association studies. In Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 1079\u20131087, 2013."}, {"heading": "Lee, Jaewoo, Wang, Yue, and Kifer, Daniel. Maximum", "text": "likelihood postprocessing for differential privacy under consistency constraints. In Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 635\u2013644, 2015.\nLi, Chao and Miklau, Gerome. An adaptive mechanism for accurate query answering under differential privacy. In Proceedings of the VLDB Endowment, volume 5, pp. 514\u2013525, 2012.\nLi, Chao, Hay, Michael, Rastogi, Vibhor, Miklau, Gerome, and McGregor, Andrew. Optimizing linear counting queries under differential privacy. In Proceedings of the twenty-ninth ACM SIGMOD-SIGACT-SIGART symposium on Principles of database systems, pp. 123\u2013134, 2010."}, {"heading": "Lyu, Min, Su, Dong, and Li, Ninghui. Understanding the", "text": "sparse vector technique for differential privacy. In Proceedings of the VLDB Endowment, volume 10, pp. 637\u2013 648, 2017."}, {"heading": "McSherry, Frank and Talwar, Kunal. Mechanism design via", "text": "differential privacy. In Proceedings of the 48th Annual IEEE Symposium on Foundations of Computer Science, pp. 94\u2013103, 2007.\nSimmons, Sean and Berger, Bonnie. Realizing privacy preserving genome-wide association studies. Bioinformatics, 32(9):1293\u20131300, 2016."}, {"heading": "Uhler, Caroline, Slavkovic\u0301, Aleksandra, and Fienberg,", "text": "Stephen E. Privacy-preserving data sharing for genomewide association studies. The Journal of privacy and confidentiality, 5(1):137, 2013.\nWang, Yue, Lee, Jaewoo, and Kifer, Daniel. Differentially private hypothesis testing, revisited. arXiv preprint arXiv:1511.03376, 2015.\nWebb, Geoffrey I and Petitjean, Franc\u0327ois. A multiple test correction for streams and cascades of statistical hypothesis tests. In Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 1255\u20131264, 2016."}, {"heading": "Yu, Fei, Fienberg, Stephen E, Slavkovic\u0301, Aleksandra B, and", "text": "Uhler, Caroline. Scalable privacy-preserving data sharing methodology for genome-wide association studies. Journal of biomedical informatics, 50:133\u2013141, 2014."}], "year": 2017, "references": [{"title": "Discrete multivariate analysis: Theory and practice", "authors": ["Bishop", "Yvonne M.M", "Fienberg", "Stephen E", "Holland", "Paul W"], "year": 1975}, {"title": "Teoria statistica delle classi e calcolo delle probabilit\u00e0", "authors": ["C.E. Bonferroni"], "venue": "Pubblicazioni del R. Istituto superiore di scienze economiche e commerciali di Firenze. Libreria internazionale Seeber,", "year": 1936}, {"title": "Priv\u2019it: Private and sample efficient identity testing", "authors": ["Cai", "Bryan", "Daskalakis", "Constantinos", "Kamath", "Gautam"], "venue": "In Proceedings of The 34rd International Conference on Machine Learning,", "year": 2017}, {"title": "The algorithmic foundations of differential privacy", "authors": ["Dwork", "Cynthia", "Roth", "Aaron"], "venue": "Foundations and Trends in Theoretical Computer Science,", "year": 2014}, {"title": "Calibrating noise to sensitivity in private data analysis", "authors": ["Dwork", "Cynthia", "McSherry", "Frank", "Nissim", "Kobbi", "Smith", "Adam"], "venue": "In Proceedings of the Third Conference on Theory of Cryptography,", "year": 2006}, {"title": "Privacy preserving gwas data sharing", "authors": ["Fienberg", "Stephen E", "Slavkovic", "Aleksandra", "Uhler", "Caroline"], "venue": "In Proceedings of the 2011 IEEE 11th International Conference on Data Mining Workshops,", "year": 2011}, {"title": "Dual query: Practical private query release for high dimensional data", "authors": ["Gaboardi", "Marco", "Arias", "Emilio Jes\u00fas Gallego", "Hsu", "Justin", "Roth", "Aaron", "Wu", "Zhiwei Steven"], "venue": "In Proceedings of The 31rd International Conference on Machine Learning,", "year": 2014}, {"title": "A simple and practical algorithm for differentially private data release", "authors": ["Hardt", "Moritz", "Ligett", "Katrina", "McSherry", "Frank"], "venue": "In Advances in Neural Information Processing Systems", "year": 2012}, {"title": "Privacy-preserving data exploration in genome-wide association studies", "authors": ["Johnson", "Aaron", "Shmatikov", "Vitaly"], "venue": "In Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining,", "year": 2013}, {"title": "Maximum likelihood postprocessing for differential privacy under consistency constraints", "authors": ["Lee", "Jaewoo", "Wang", "Yue", "Kifer", "Daniel"], "venue": "In Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining,", "year": 2015}, {"title": "An adaptive mechanism for accurate query answering under differential privacy", "authors": ["Li", "Chao", "Miklau", "Gerome"], "venue": "In Proceedings of the VLDB Endowment,", "year": 2012}, {"title": "Understanding the sparse vector technique for differential privacy", "authors": ["Lyu", "Min", "Su", "Dong", "Li", "Ninghui"], "venue": "In Proceedings of the VLDB Endowment,", "year": 2017}, {"title": "Mechanism design via differential privacy", "authors": ["McSherry", "Frank", "Talwar", "Kunal"], "venue": "In Proceedings of the 48th Annual IEEE Symposium on Foundations of Computer Science,", "year": 2007}, {"title": "Realizing privacy preserving genome-wide association", "authors": ["Simmons", "Sean", "Berger", "Bonnie"], "venue": "studies. Bioinformatics,", "year": 2016}, {"title": "Privacy-preserving data sharing for genomewide association studies", "authors": ["Uhler", "Caroline", "Slavkovi\u0107", "Aleksandra", "Fienberg", "Stephen E"], "venue": "The Journal of privacy and confidentiality,", "year": 2013}, {"title": "Differentially private hypothesis testing, revisited", "authors": ["Wang", "Yue", "Lee", "Jaewoo", "Kifer", "Daniel"], "venue": "arXiv preprint arXiv:1511.03376,", "year": 2015}, {"title": "A multiple test correction for streams and cascades of statistical hypothesis tests", "authors": ["Webb", "Geoffrey I", "Petitjean", "Fran\u00e7ois"], "venue": "In Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining,", "year": 2016}, {"title": "Scalable privacy-preserving data sharing methodology for genome-wide association studies", "authors": ["Yu", "Fei", "Fienberg", "Stephen E", "Slavkovi\u0107", "Aleksandra B", "Uhler", "Caroline"], "venue": "Journal of biomedical informatics,", "year": 2014}], "id": "SP:d44ec6a571126e7083de897ecc21820f21f1cf52", "authors": [{"name": "Kazuya Kakizaki", "affiliations": []}, {"name": "Kazuto Fukuchi", "affiliations": []}, {"name": "Jun Sakuma", "affiliations": []}], "abstractText": "This paper develops differentially private mechanisms for \u03c72 test of independence. While existing works put their effort into properly controlling the type-I error, in addition to that, we investigate the type-II error of differentially private mechanisms. Based on the analysis, we present unit circle mechanism: a novel differentially private mechanism based on the geometrical property of the test statistics. Compared to existing output perturbation mechanisms, our mechanism improves the dominated term of the type-II error from O(1) to O(exp(\u2212 \u221a N)) where N is the sample size. Furthermore, we introduce novel procedures for multiple \u03c72 tests by incorporating the unit circle mechanism into the sparse vector technique and the exponential mechanism. These procedures can control the family-wise error rate (FWER) properly, which has never been attained by existing mechanisms.", "title": "Differentially Private Chi-squared Test by Unit Circle Mechanism"}